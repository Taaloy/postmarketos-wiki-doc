<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Packaging/Override configuration files - postmarketOS Wiki</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.0">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="postmarketOS Wiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Wiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Packaging_Override_configuration_files rootpage-Packaging_Override_configuration_files skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	<header class="vector-header mw-header">
		<div class="vector-header-start">
			<nav class="vector-main-menu-landmark" aria-label="Site">
				
<div id="vector-main-menu-dropdown" class="vector-dropdown vector-main-menu-dropdown vector-button-flush-left vector-button-flush-right">
	<input type="checkbox" id="vector-main-menu-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-main-menu-dropdown" class="vector-dropdown-checkbox " aria-label="Main menu">
	<label id="vector-main-menu-dropdown-label" for="vector-main-menu-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-menu mw-ui-icon-wikimedia-menu"></span>

<span class="vector-dropdown-label-text">Main menu</span>
	</label>
	<div class="vector-dropdown-content">


				<div id="vector-main-menu-unpinned-container" class="vector-unpinned-container">
		
<div id="vector-main-menu" class="vector-main-menu vector-pinnable-element">
	<div class="vector-pinnable-header vector-main-menu-pinnable-header vector-pinnable-header-unpinned" data-feature-name="main-menu-pinned" data-pinnable-element-id="vector-main-menu" data-pinned-container-id="vector-main-menu-pinned-container" data-unpinned-container-id="vector-main-menu-unpinned-container">
	<div class="vector-pinnable-header-label">Main menu</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-main-menu.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-main-menu.unpin">hide</button>
</div>

	
<div id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation">
	<div class="vector-menu-heading">
		Navigation
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-mainpage-description" class="mw-list-item"><a href="../en/Main_Page.html" title="Visit the main page [z]" accesskey="z"><span>Main page</span></a></li>
<li id="n-Devices" class="mw-list-item"><a href="../en/Devices.html"><span>Devices</span></a></li>
		</ul>
		
	</div>
</div>

	
	
</div>

				</div>

	</div>
</div>

		</nav>
			
<a href="../en/Main_Page.html" class="mw-logo">
	<img class="mw-logo-icon" src="/logo_50x50.svg" alt="" aria-hidden="true" height="50" width="50">
	<span class="mw-logo-container skin-invert">
		<strong class="mw-logo-wordmark">postmarketOS Wiki</strong>
	</span>
</a>

		</div>
		<div class="vector-header-end">
			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-collapses vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<a href="../Special:Search.html" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only search-toggle" title="Search postmarketOS Wiki [f]" accesskey="f"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
	</a>
	<div class="vector-typeahead-search-container">
		<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail cdx-typeahead-search--auto-expand-width">
			<form action="/index.php" id="searchform" class="cdx-search-input cdx-search-input--has-end-button">
				<div id="simpleSearch" class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
					<div class="cdx-text-input cdx-text-input--has-start-icon">
						<input class="cdx-text-input__input" type="search" name="search" placeholder="Search postmarketOS Wiki" aria-label="Search postmarketOS Wiki" autocapitalize="sentences" title="Search postmarketOS Wiki [f]" accesskey="f" id="searchInput">
						<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
					</div>
					<input type="hidden" name="title" value="Special:Search">
				</div>
				<button class="cdx-button cdx-search-input__end-button">Search</button>
			</form>
		</div>
	</div>
</div>

			<nav class="vector-user-links vector-user-links-wide" aria-label="Personal tools">
	<div class="vector-user-links-main">
	
<div id="p-vector-user-menu-preferences" class="vector-menu mw-portlet emptyPortlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-userpage" class="vector-menu mw-portlet emptyPortlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	<nav class="vector-appearance-landmark" aria-label="Appearance">
		
<div id="vector-appearance-dropdown" class="vector-dropdown " title="Change the appearance of the page's font size, width, and color">
	<input type="checkbox" id="vector-appearance-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-appearance-dropdown" class="vector-dropdown-checkbox " aria-label="Appearance">
	<label id="vector-appearance-dropdown-label" for="vector-appearance-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-appearance mw-ui-icon-wikimedia-appearance"></span>

<span class="vector-dropdown-label-text">Appearance</span>
	</label>
	<div class="vector-dropdown-content">


			<div id="vector-appearance-unpinned-container" class="vector-unpinned-container">
				
			</div>
		
	</div>
</div>

	</nav>
	
<div id="p-vector-user-menu-notifications" class="vector-menu mw-portlet emptyPortlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-overflow" class="vector-menu mw-portlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			<li id="pt-login-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item">
<a data-mw="interface" href="/index.php?title=Special:UserLogin&amp;returnto=Packaging%2FOverride+configuration+files" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o" class=""><span>Log in</span></a>
</li>
<li id="pt-createaccount-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item">
<a data-mw="interface" href="../Special:RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory" class=""><span>Request account</span></a>
</li>

			
		</ul>
		
	</div>
</div>

	</div>
	
<div id="vector-user-links-dropdown" class="vector-dropdown vector-user-menu vector-button-flush-right vector-user-menu-logged-out user-links-collapsible-item" title="More options">
	<input type="checkbox" id="vector-user-links-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-user-links-dropdown" class="vector-dropdown-checkbox " aria-label="Personal tools">
	<label id="vector-user-links-dropdown-label" for="vector-user-links-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-ellipsis mw-ui-icon-wikimedia-ellipsis"></span>

<span class="vector-dropdown-label-text">Personal tools</span>
	</label>
	<div class="vector-dropdown-content">


		
<div id="p-personal" class="vector-menu mw-portlet mw-portlet-personal user-links-collapsible-item" title="User menu">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-login" class="user-links-collapsible-item mw-list-item"><a href="/index.php?title=Special:UserLogin&amp;returnto=Packaging%2FOverride+configuration+files" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span class="vector-icon mw-ui-icon-logIn mw-ui-icon-wikimedia-logIn"></span> <span>Log in</span></a></li>
<li id="pt-createaccount" class="user-links-collapsible-item mw-list-item"><a href="../Special:RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory"><span>Request account</span></a></li>
		</ul>
		
	</div>
</div>

	
	</div>
</div>

</nav>

		</div>
	</header>
</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-History" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#History">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>History</span>
			</div>
		</a>
		
		<ul id="toc-History-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Overriding_configs_properly" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Overriding_configs_properly">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Overriding configs properly</span>
			</div>
		</a>
		
		<ul id="toc-Overriding_configs_properly-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Modernizing_packages" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Modernizing_packages">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Modernizing packages</span>
			</div>
		</a>
		
			<button aria-controls="toc-Modernizing_packages-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Modernizing packages subsection</span>
			</button>
		
		<ul id="toc-Modernizing_packages-sublist" class="vector-toc-list">
			<li id="toc-Add_the_config_as_file" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Add_the_config_as_file">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.1</span>
					<span>Add the config as file</span>
				</div>
			</a>
			
			<ul id="toc-Add_the_config_as_file-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Adjust_post-install_script" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Adjust_post-install_script">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.2</span>
					<span>Adjust post-install script</span>
				</div>
			</a>
			
			<ul id="toc-Adjust_post-install_script-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Adjust_APKBUILD" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Adjust_APKBUILD">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3</span>
					<span>Adjust APKBUILD</span>
				</div>
			</a>
			
			<ul id="toc-Adjust_APKBUILD-sublist" class="vector-toc-list">
				<li id="toc-Main_package" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Main_package">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3.1</span>
					<span>Main package</span>
				</div>
			</a>
			
			<ul id="toc-Main_package-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Subpackage" class="vector-toc-list-item vector-toc-level-3">
			<a class="vector-toc-link" href="#Subpackage">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.3.2</span>
					<span>Subpackage</span>
				</div>
			</a>
			
			<ul id="toc-Subpackage-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
		</li>
		<li id="toc-Create_pre-upgrade_script" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Create_pre-upgrade_script">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">3.4</span>
					<span>Create pre-upgrade script</span>
				</div>
			</a>
			
			<ul id="toc-Create_pre-upgrade_script-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Packaging/Override configuration files</span></h1>
				</header>
				<div class="vector-page-toolbar">
					<div class="vector-page-toolbar-container">
						<div id="left-navigation">
							<nav aria-label="Namespaces">
								
<div id="p-associated-pages" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-associated-pages">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-nstab-main" class="selected vector-tab-noicon mw-list-item"><a href="../en/Packaging_Override_configuration_files.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new vector-tab-noicon mw-list-item"><a href="/index.php?title=Talk:Packaging/Override_configuration_files&amp;action=edit&amp;redlink=1" rel="discussion" class="new" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
		</ul>
		
	</div>
</div>

								
<div id="vector-variants-dropdown" class="vector-dropdown emptyPortlet">
	<input type="checkbox" id="vector-variants-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-variants-dropdown" class="vector-dropdown-checkbox " aria-label="Change language variant">
	<label id="vector-variants-dropdown-label" for="vector-variants-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"><span class="vector-dropdown-label-text">English</span>
	</label>
	<div class="vector-dropdown-content">


					
<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

				
	</div>
</div>

							</nav>
						</div>
						<div id="right-navigation" class="vector-collapsible">
							<nav aria-label="Views">
								
<div id="p-views" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-views">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-view" class="selected vector-tab-noicon mw-list-item"><a href="../en/Packaging_Override_configuration_files.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="vector-tab-noicon mw-list-item"><a href="/index.php?title=Packaging/Override_configuration_files&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="vector-tab-noicon mw-list-item"><a href="/index.php?title=Packaging/Override_configuration_files&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
		</ul>
		
	</div>
</div>

							</nav>
				
							<nav class="vector-page-tools-landmark" aria-label="Page tools">
								
<div id="vector-page-tools-dropdown" class="vector-dropdown vector-page-tools-dropdown">
	<input type="checkbox" id="vector-page-tools-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-tools-dropdown" class="vector-dropdown-checkbox " aria-label="Tools">
	<label id="vector-page-tools-dropdown-label" for="vector-page-tools-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"><span class="vector-dropdown-label-text">Tools</span>
	</label>
	<div class="vector-dropdown-content">


									<div id="vector-page-tools-unpinned-container" class="vector-unpinned-container">
						
<div id="vector-page-tools" class="vector-page-tools vector-pinnable-element">
	<div class="vector-pinnable-header vector-page-tools-pinnable-header vector-pinnable-header-unpinned" data-feature-name="page-tools-pinned" data-pinnable-element-id="vector-page-tools" data-pinned-container-id="vector-page-tools-pinned-container" data-unpinned-container-id="vector-page-tools-unpinned-container">
	<div class="vector-pinnable-header-label">Tools</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-page-tools.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-page-tools.unpin">hide</button>
</div>

	
<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions vector-has-collapsible-items" title="More options">
	<div class="vector-menu-heading">
		Actions
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Packaging_Override_configuration_files.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Packaging/Override_configuration_files&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Packaging/Override_configuration_files&amp;action=history"><span>View history</span></a></li>
<li id="ca-cargo-purge" class="mw-list-item"><a href="/index.php?title=Packaging/Override_configuration_files&amp;action=purge"><span>Purge cache</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-tb" class="vector-menu mw-portlet mw-portlet-tb">
	<div class="vector-menu-heading">
		General
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-whatlinkshere" class="mw-list-item"><a href="../Special:WhatLinksHere_Packaging_Override_configuration_files.html" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li>
<li id="t-recentchangeslinked" class="mw-list-item"><a href="../Special:RecentChangesLinked_Packaging_Override_configuration_files.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li>
<li id="t-specialpages" class="mw-list-item"><a href="../Special:SpecialPages.html" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li>
<li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li>
<li id="t-permalink" class="mw-list-item"><a href="/index.php?title=Packaging/Override_configuration_files&amp;oldid=67433" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li>
<li id="t-info" class="mw-list-item"><a href="/index.php?title=Packaging/Override_configuration_files&amp;action=info" title="More information about this page"><span>Page information</span></a></li>
<li id="t-cargopagevalueslink" class="mw-list-item"><a href="/index.php?title=Packaging/Override_configuration_files&amp;action=pagevalues" rel="cargo-pagevalues"><span>Cargo data</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-The_usual_wiki_links" class="vector-menu mw-portlet mw-portlet-The_usual_wiki_links">
	<div class="vector-menu-heading">
		The usual wiki links
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-Editor's-Guide" class="mw-list-item"><a href="../en/Help:Wiki_editor's_guide.html"><span>Editor's Guide</span></a></li>
<li id="n-recentchanges" class="mw-list-item"><a href="../Special:RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li>
<li id="n-randompage" class="mw-list-item"><a href="../Special:Random.html" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li>
<li id="n-Templates" class="mw-list-item"><a href="../en/PostmarketOS:Templates.html"><span>Templates</span></a></li>
		</ul>
		
	</div>
</div>

</div>

									</div>
				
	</div>
</div>

							</nav>
						</div>
					</div>
				</div>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From postmarketOS Wiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div id="contentSub" style="margin-top: -8px; margin-bottom: 18px;">
<span class="subpages">&lt; <a href="../en/Packaging.html" title="Packaging">Packaging</a></span>â€Ž</div>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center; line-height: 1;"><span style="white-space: nowrap;"><span typeof="mw:File"><span title="Note"><img alt="Note" src="../Reference_icon.svg" decoding="async" width="20" height="20" class="mw-file-element"></span></span></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">Details to roll this out in <a rel="nofollow" class="external text" href="https://gitlab.postmarketos.org/postmarketOS/pmaports/-/issues/865">pmaports#865</a>.</td>
</tr></tbody></table>
<p>Oftentimes, postmarketOS packages need to replace files provided by Alpine packages. One example is <code>/etc/issue</code>, which says "Welcome to postmarketOS" in pmOS.
</p>
<meta property="mw:PageProp/toc">
<h3><span class="mw-headline" id="History">History</span></h3>
<p>For a few years we did this by modifying config files from post-install scripts: after a certain postmarketOS package was installed, it would run a shell script that adjusts the config file as we need it. But this has the downside that the apk package manager now assumes, the user has modified the file. Because it is different from the version supplied by the Alpine package. With this assumption, apk will not update the file anymore. So the config file always remains whatever random version from the Alpine package was installed at that time plus all modifications done in (various versions of) post-install scripts from postmarketOS. It is not deterministic anymore what is in the config file. This is not so bad for <code>/etc/issue</code>, but if you consider important config files, like the sudo configuration, it becomes apparent that this isn't great at all.
</p>
<p>In order to get this right, some simple shell logic was put into <code>postmarketos-mvcfg</code>, which will move the existing files (where we don't know the exact content anymore) to a backup directory. Afterwards, the postmarketOS version of the config file will be installed with the package. (We realized that apk allows policy packages that overwrite config files of other packages, more on that below.) From user's perspective, the migration looks like the following. The hint about moved config files are only shown to the user if they did the upgrade via terminal (not if they did it via GNOME Software or KDE Discover). But in postmarketOS it should be safe to assume that most people did not modify these specific config files, and if they did, they are very likely going to do the upgrades via terminal too. In addition, we wrote about this change in the <a rel="nofollow" class="external text" href="https://postmarketos.org/edge">edge blog</a>.
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$ </span>sudo<span class="w"> </span>apk<span class="w"> </span>upgrade
<span class="gp gp-VirtualEnv">(1/3)</span> <span class="go">Installing postmarketos-mvcfg (1-r0)</span>
<span class="gp gp-VirtualEnv">(2/3)</span> <span class="go">Upgrading postmarketos-base (4-r0 -&gt; 5-r2)</span>
<span class="go">Executing postmarketos-base-5-r2.pre-upgrade</span>
<span class="go">  *</span>
<span class="go">  * These configs were created with legacy packaging methods:</span>
<span class="go">  *   /etc/chrony/chrony.conf</span>
<span class="go">  *   /etc/conf.d/syslog</span>
<span class="go">  *   /etc/conf.d/wpa_supplicant</span>
<span class="go">  *   /etc/fstab</span>
<span class="go">  *   /etc/issue</span>
<span class="go">  *   /etc/motd</span>
<span class="go">  *   /etc/sudoers</span>
<span class="go">  *   /etc/wpa_supplicant/wpa_supplicant.conf</span>
<span class="go">  *</span>
<span class="go">  * In order to replace them with properly packaged configs,</span>
<span class="go">  * the old versions (which you might have adjusted manually)</span>
<span class="go">  * were moved to:</span>
<span class="go">  *   /etc/postmarketos-mvcfg/backup/postmarketos-base</span>
<span class="go">  *</span>
<span class="go">  * If you did not manually adjust these configs, you can ignore</span>
<span class="go">  * this message.</span>
<span class="go">  *</span>
<span class="go">  * More information: https://postmarketos.org/mvcfg</span>
<span class="go">  *</span>
<span class="go">...</span>
</pre></div>
<h3><span class="mw-headline" id="Overriding_configs_properly">Overriding configs properly</span></h3>
<p>Let's say you want to override <code>/etc/conf.d/wpa_supplicant</code> to change the order of the Wi-Fi drivers being used. Use <a rel="nofollow" class="external text" href="https://pkgs.alpinelinux.org/contents?file=wpa_supplicant&amp;path=%2Fetc%2Fconf.d&amp;name=&amp;branch=edge">pkgs.alpinelinux.org</a> to find out that this file is provided by <code>wpa_supplicant-openrc</code>. Add <code>replaces</code> (<a rel="nofollow" class="external text" href="https://wiki.alpinelinux.org/wiki/APKBUILD_Reference#replaces">reference</a>) to the APKBUILD, install your own config file into the same path in <code>package()</code>. That's it.
</p>
<p><code>apk</code> will override the config with your custom config, when both packages are installed. Even when the original package gets upgraded and has a newer version of the config file, apk will still use your version of the file.
</p>
<div class="mw-highlight mw-highlight-lang-shell mw-content-ltr" dir="ltr"><pre><span></span><span class="nv">pkgname</span><span class="o">=</span><span class="s2">"override-test"</span>
<span class="nv">replaces</span><span class="o">=</span><span class="s2">"wpa_supplicant-openrc"</span>
<span class="nv">source</span><span class="o">=</span><span class="s2">"wpa_supplicant.confd"</span>

package<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">	</span>install<span class="w"> </span>-Dm644<span class="w"> </span>wpa_supplicant.confd<span class="w"> </span><span class="s2">"</span><span class="nv">$pkgdir</span><span class="s2">"</span>/etc/conf.d/wpa_supplicant
<span class="o">}</span>
</pre></div>
<h3><span class="mw-headline" id="Modernizing_packages">Modernizing packages</span></h3>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center; line-height: 1;"><span style="white-space: nowrap;"><span typeof="mw:File"><span title="Note"><img alt="Note" src="../Reference_icon.svg" decoding="async" width="20" height="20" class="mw-file-element"></span></span></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">If this is confusing, just read the two short <code>postmarketos-mvcfg</code> shell scripts. They are in <code>main/postmarketos-mvcfg</code>, as of writing at the bottom of <a rel="nofollow" class="external text" href="https://gitlab.postmarketos.org/postmarketOS/pmaports/-/merge_requests/173">pmaports!173</a>.</td>
</tr></tbody></table>
<p>Follow these steps to change a package from using the legacy method to the proper method.
</p>
<p>Consider omitting the <code>postmarketos-mvcfg</code> migration if this package isn't used widely (i.e. any random downstream port that was added last week).
</p>
<h4><span class="mw-headline" id="Add_the_config_as_file">Add the config as file</span></h4>
<ul><li>Find the original config file contents from the Alpine package.</li></ul>
<dl><dd>This can be done by installing just this package and nothing else in a new <code>pmbootstrap chroot</code>, then running <code>cat</code> to read the config file.</dd></dl>
<ul>
<li>Add this config to your overriding package.</li>
<li>Apply modifications to that config.</li>
</ul>
<h4><span class="mw-headline" id="Adjust_post-install_script">Adjust post-install script</span></h4>
<ul>
<li>Remove logic to apply the modifications to the config file from the post-install script.</li>
<li>Consider removing the post-install script altogether, if it is empty now.</li>
</ul>
<h4><span class="mw-headline" id="Adjust_APKBUILD">Adjust APKBUILD</span></h4>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center; line-height: 1;"><span style="white-space: nowrap;"><span typeof="mw:File"><span title="Note"><img alt="Note" src="../Reference_icon.svg" decoding="async" width="20" height="20" class="mw-file-element"></span></span></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">Don't overlook the <code>postmarketos-mvcfg-package</code> line!</td>
</tr></tbody></table>
<h5><span class="mw-headline" id="Main_package">Main package</span></h5>
<div class="mw-highlight mw-highlight-lang-shell mw-content-ltr" dir="ltr"><pre><span></span>...
<span class="nv">install</span><span class="o">=</span><span class="s2">"</span><span class="nv">$pkgname</span><span class="s2">.pre-upgrade"</span>
<span class="nv">replaces</span><span class="o">=</span><span class="s2">"pkg-with-config"</span>
...
package<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">	</span>install<span class="w"> </span>-Dm644<span class="w"> </span>myconfig1<span class="w"> </span><span class="s2">"</span><span class="nv">$pkgdir</span><span class="s2">"</span>/etc/myconfig1
<span class="w">	</span>install<span class="w"> </span>-Dm644<span class="w"> </span>myconfig2<span class="w"> </span><span class="s2">"</span><span class="nv">$pkgdir</span><span class="s2">"</span>/etc/myconfig2

<span class="w">	</span>postmarketos-mvcfg-package<span class="w"> </span><span class="s2">"</span><span class="nv">$pkgdir</span><span class="s2">"</span><span class="w"> </span><span class="s2">"</span><span class="nv">$pkgname</span><span class="s2">"</span>
<span class="o">}</span>
</pre></div>
<h5><span class="mw-headline" id="Subpackage">Subpackage</span></h5>
<div class="mw-highlight mw-highlight-lang-shell mw-content-ltr" dir="ltr"><pre><span></span>mysubpkg<span class="o">()</span><span class="w"> </span><span class="o">{</span>
<span class="w">	</span><span class="nv">install</span><span class="o">=</span><span class="s2">"</span><span class="nv">$subpkgname</span><span class="s2">.pre-upgrade"</span>
<span class="w">	</span><span class="nv">replaces</span><span class="o">=</span><span class="s2">"pkg-with-config"</span>

<span class="w">	</span>install<span class="w"> </span>-Dm644<span class="w"> </span>myconfig1<span class="w"> </span><span class="s2">"</span><span class="nv">$subpkgdir</span><span class="s2">"</span>/etc/myconfig1
<span class="w">	</span>install<span class="w"> </span>-Dm644<span class="w"> </span>myconfig2<span class="w"> </span><span class="s2">"</span><span class="nv">$subpkgdir</span><span class="s2">"</span>/etc/myconfig2

<span class="w">	</span>postmarketos-mvcfg-package<span class="w"> </span><span class="s2">"</span><span class="nv">$subpkgdir</span><span class="s2">"</span><span class="w"> </span><span class="s2">"</span><span class="nv">$subpkgname</span><span class="s2">"</span>
<span class="o">}</span>
</pre></div>
<h4><span class="mw-headline" id="Create_pre-upgrade_script">Create pre-upgrade script</span></h4>
<p>Add a pre-upgrade script with the following content:
</p>
<div class="mw-highlight mw-highlight-lang-shell mw-content-ltr" dir="ltr"><pre><span></span><span class="ch">#!/bin/sh</span>

postmarketos-mvcfg-pre-upgrade<span class="w"> </span><span class="se">\</span>
<span class="w">	</span>my-pkgname<span class="w"> </span><span class="se">\</span>
<span class="w">	</span>/etc/myconfig1<span class="w"> </span><span class="se">\</span>
<span class="w">	</span>/etc/myconfig2
</pre></div>
<p><code>my-pkgname</code> is the <code>backupdir</code>. This should be the package name of the package where you are adding the pre-upgrade script. (Unless you need to do a second migration for some reason, then add another <code>postmarketos-mvcfg-pre-upgrade</code> statement below and add a suffix like <code>-v2</code> to the <code>backupdir</code>.)
</p>
<p><code>/etc/myconfig1</code> this is the first config file. Put each argument in its own line, and order the config filenames alphabetically.
</p>
</div>
</div>
					<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=Packaging/Override_configuration_files&amp;oldid=67433">https://wiki.postmarketos.org/index.php?title=Packaging/Override_configuration_files&amp;oldid=67433</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 17 December 2024, at 06:48.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/About_postmarketOS.html">About postmarketOS Wiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/PostmarketOS:General_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="../poweredby_mediawiki.svg" alt="Powered by MediaWiki" width="88" height="31" loading="lazy"></a></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
