<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>OnePlus 6 (oneplus-enchilada) - postmarketOS</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.34.2">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="postmarketOS (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-OnePlus_6_oneplus-enchilada rootpage-OnePlus_6_oneplus-enchilada skin-vector action-view">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">OnePlus 6 (oneplus-enchilada)</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From postmarketOS</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">OnePlus 6</caption>
<tbody>
<tr class=""><td colspan="2" class="" style="text-align:center;">
<a href="../Op6-neofetch-phosh.jpeg" class="image"><img alt="Running Phosh" src="../Op6-neofetch-phosh.jpeg" decoding="async" width="200" height="300" srcset="../300px-Op6-neofetch-phosh.jpeg 1.5x ../400px-Op6-neofetch-phosh.jpeg 2x"></a><br><span style="">Running Phosh</span>
</td></tr>
<tr class="">
<th scope="row" style="text-align:left;">Manufacturer</th>
    <td class="" style="">
OnePlus</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Name</th>
    <td class="" style="">
6</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Codename</th>
    <td class="" style="">
oneplus-enchilada</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Released</th>
    <td class="" style="">
2018</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Category</th>
    <td class="" style="">
community</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Original software</th>
    <td class="" style="">
Android 8.0 (Up to Android 11) on Linux 4.9</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">postmarketOS kernel</th>
    <td class="" style="">
Mainline</td>
</tr>
<tr><th colspan="2" class="" style="text-align:center;">Hardware</th></tr>
<tr class="">
<th scope="row" style="text-align:left;">Chipset</th>
    <td class="" style="">
Qualcomm SDM845 Snapdragon 845</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">CPU</th>
    <td class="" style="">
Octa-core (4x 2.8 GHz Kryo 385 Gold &amp; 4x 1.7 GHz Kryo 385 Silver)</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPU</th>
    <td class="" style="">
Adreno 630</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Display</th>
    <td class="" style="">
1080 x 2280 AMOLED</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Storage</th>
    <td class="" style="">
64/128/256 GB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Memory</th>
    <td class="" style="">
6/8 GB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Architecture</th>
    <td class="" style="">
aarch64</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Unixbench Whet/Dhry score</th>
    <td class="" style="">
6029.9</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Features</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="After connecting the device with USB to your PC, you can connect to it via telnet (initramfs) or SSH (booted system).">USB Networking</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="It is possible to flash the device with `pmbootstrap flasher`.">Flashing</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Touchscreen</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Display works. Ideally with sleep mode and brightness control.">Display</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">WiFi</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Full disk encryption and unlocking with osk-sdl.">FDE</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Instead of a Linux kernel fork, it is possible to run mainline.">Mainline</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Charging and battery level reporting works">Battery</abbr></th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">3D Acceleration</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Audio playback, microphone, headset and buttons.">Audio</abbr></th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Bluetooth</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Camera</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPS</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Mobile data</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">SMS</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Calls</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">USB OTG</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">NFC</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Sensors</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Auto screen rotation works in desktops e.g. Phosh or Plasma Mobile">Accelerometer</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Magnetometer</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ambient Light</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Proximity</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Used as flip cover sensor, keyboard slide out sensor, etc.">Hall Effect</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Misc</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;">Ir TX</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">TrustZone</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<p><br>
</p>
<p><br>
This page documents the status of mainline Linux on the OnePlus 6!
</p>
<p>The OnePlus 6 is an incredibly powerful and efficient mobile device, well regarded and (bar the notch) an excellent portable work horse, getting mainline Linux working means not only freedom from proprietary software, and security updates at OnePlus' discretion, but also the ability to boot any mobile or desktop distro as long as the required software is packaged.
</p>
<p>The phone is currently capable of booting modern Linux with only a few patches, check the table on the right (or above on mobile) for the hardware support checklist.
</p>
<div id="toc" class="toc">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2>Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#How_to_enter_flash_mode"><span class="tocnumber">1</span> <span class="toctext">How to enter flash mode</span></a></li>
<li class="toclevel-1 tocsection-2">
<a href="#Installing"><span class="tocnumber">2</span> <span class="toctext">Installing</span></a>
<ul>
<li class="toclevel-2 tocsection-3">
<a href="#Prerequisites"><span class="tocnumber">2.1</span> <span class="toctext">Prerequisites</span></a>
<ul>
<li class="toclevel-3 tocsection-4"><a href="#Upgrade"><span class="tocnumber">2.1.1</span> <span class="toctext">Upgrade</span></a></li>
<li class="toclevel-3 tocsection-5"><a href="#Fastboot"><span class="tocnumber">2.1.2</span> <span class="toctext">Fastboot</span></a></li>
<li class="toclevel-3 tocsection-6"><a href="#Unlock_the_bootloader"><span class="tocnumber">2.1.3</span> <span class="toctext">Unlock the bootloader</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-7"><a href="#Prebuilt_images"><span class="tocnumber">2.2</span> <span class="toctext">Prebuilt images</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Manual_build"><span class="tocnumber">2.3</span> <span class="toctext">Manual build</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-9">
<a href="#Dual_booting"><span class="tocnumber">3</span> <span class="toctext">Dual booting</span></a>
<ul>
<li class="toclevel-2 tocsection-10"><a href="#Flashing_to_system"><span class="tocnumber">3.1</span> <span class="toctext">Flashing to system</span></a></li>
<li class="toclevel-2 tocsection-11"><a href="#Sharing_userdata_with_Android"><span class="tocnumber">3.2</span> <span class="toctext">Sharing userdata with Android</span></a></li>
<li class="toclevel-2 tocsection-12"><a href="#Advanced_Partitioning"><span class="tocnumber">3.3</span> <span class="toctext">Advanced Partitioning</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-13"><a href="#Fastboot_bugs"><span class="tocnumber">4</span> <span class="toctext">Fastboot bugs</span></a></li>
<li class="toclevel-1 tocsection-14">
<a href="#Upgrading"><span class="tocnumber">5</span> <span class="toctext">Upgrading</span></a>
<ul>
<li class="toclevel-2 tocsection-15"><a href="#Device_won.27t_boot_properly_after_upgrade"><span class="tocnumber">5.1</span> <span class="toctext">Device won't boot properly after upgrade</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-16"><a href="#Building"><span class="tocnumber">6</span> <span class="toctext">Building</span></a></li>
<li class="toclevel-1 tocsection-17">
<a href="#Info"><span class="tocnumber">7</span> <span class="toctext">Info</span></a>
<ul>
<li class="toclevel-2 tocsection-18"><a href="#Hacking"><span class="tocnumber">7.1</span> <span class="toctext">Hacking</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#Partition_map"><span class="tocnumber">7.2</span> <span class="toctext">Partition map</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-20">
<a href="#The_big_list_of_issues"><span class="tocnumber">8</span> <span class="toctext">The big list of issues</span></a>
<ul>
<li class="toclevel-2 tocsection-21"><a href="#Stuck_in_fastboot_after_rebooting"><span class="tocnumber">8.1</span> <span class="toctext">Stuck in fastboot after rebooting</span></a></li>
<li class="toclevel-2 tocsection-22"><a href="#Charging"><span class="tocnumber">8.2</span> <span class="toctext">Charging</span></a></li>
<li class="toclevel-2 tocsection-23"><a href="#Tri-state_key_support"><span class="tocnumber">8.3</span> <span class="toctext">Tri-state key support</span></a></li>
<li class="toclevel-2 tocsection-24"><a href="#Phosh_clock_hidden_by_notch"><span class="tocnumber">8.4</span> <span class="toctext">Phosh clock hidden by notch</span></a></li>
<li class="toclevel-2 tocsection-25"><a href="#HW_Video_decoding_is_broken"><span class="tocnumber">8.5</span> <span class="toctext">HW Video decoding is broken</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-26"><a href="#3rd_party_displays_.2F_touch_panels_don.27t_work"><span class="tocnumber">9</span> <span class="toctext">3rd party displays / touch panels don't work</span></a></li>
<li class="toclevel-1 tocsection-27"><a href="#GPS"><span class="tocnumber">10</span> <span class="toctext">GPS</span></a></li>
<li class="toclevel-1 tocsection-28"><a href="#Camera"><span class="tocnumber">11</span> <span class="toctext">Camera</span></a></li>
<li class="toclevel-1 tocsection-29"><a href="#Sensors"><span class="tocnumber">12</span> <span class="toctext">Sensors</span></a></li>
<li class="toclevel-1 tocsection-30"><a href="#TrustZone"><span class="tocnumber">13</span> <span class="toctext">TrustZone</span></a></li>
<li class="toclevel-1 tocsection-31"><a href="#Fastboot_flashing_issues"><span class="tocnumber">14</span> <span class="toctext">Fastboot flashing issues</span></a></li>
<li class="toclevel-1 tocsection-32">
<a href="#Modem_bugs"><span class="tocnumber">15</span> <span class="toctext">Modem bugs</span></a>
<ul>
<li class="toclevel-2 tocsection-33"><a href="#Call_audio"><span class="tocnumber">15.1</span> <span class="toctext">Call audio</span></a></li>
<li class="toclevel-2 tocsection-34"><a href="#Dual_Sim"><span class="tocnumber">15.2</span> <span class="toctext">Dual Sim</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-35">
<a href="#Community_Info"><span class="tocnumber">16</span> <span class="toctext">Community Info</span></a>
<ul>
<li class="toclevel-2 tocsection-36"><a href="#postmarketOS_users_that_own_the_device"><span class="tocnumber">16.1</span> <span class="toctext">postmarketOS users that own the device</span></a></li>
<li class="toclevel-2 tocsection-37"><a href="#Maintainers"><span class="tocnumber">16.2</span> <span class="toctext">Maintainers</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-38">
<a href="#See_also"><span class="tocnumber">17</span> <span class="toctext">See also</span></a>
<ul>
<li class="toclevel-2 tocsection-39"><a href="#Internal_pages"><span class="tocnumber">17.1</span> <span class="toctext">Internal pages</span></a></li>
<li class="toclevel-2 tocsection-40"><a href="#External_links"><span class="tocnumber">17.2</span> <span class="toctext">External links</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id="How_to_enter_flash_mode">How to enter flash mode</span></h2>
<p>Unplug from USB, hold <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Power</span> and <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Volume Up</span> until you see "Fastboot Mode" text.
</p>
<p>For the <a href="../en/OnePlus_6T_(oneplus-fajita).html" title="OnePlus 6T (oneplus-fajita)">OnePlus 6T</a>, hold <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Power</span> and both <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Volume Up</span> and <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Volume Down</span> to get in Fastboot Mode.
</p>
<h2><span class="mw-headline" id="Installing">Installing</span></h2>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">For dual booting with Android, see "Dual booting" below.</td>
</tr></tbody></table>
<h3><span class="mw-headline" id="Prerequisites">Prerequisites</span></h3>
<h4><span class="mw-headline" id="Upgrade">Upgrade</span></h4>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">The bootloader is the only firmware that postmarketOS doesn't install itself, all other firmware (devicetree, gpu, modem etc) is supplied by postmarketOS</td>
</tr></tbody></table>
<p>Before installing postmarketOS, it's recommended that you upgrade your device to the latest release of OOS, whilst this is not a hard requirement, there have been issues with fastboot misbehaving on older firmware versions.
</p>
<p>There is no hard requirement that your device is running a specific Android version, as unlike other (Halium based) distributions, postmarketOS doesn't depend on re-using hardware support provided by proprietary userspace blobs.
</p>
<h4><span class="mw-headline" id="Fastboot">Fastboot</span></h4>
<p>Install fastboot on your host, refer to Google for instructions.
</p>
<h4><span class="mw-headline" id="Unlock_the_bootloader">Unlock the bootloader</span></h4>
<p>Before installing postmarketOS you have to unlock your bootloader, for the T-mobile version of the device in the US, refer to Google for guides on obtaining an unlock code. If your device is not carrier locked, the following is all that's needed to unlock the bootloader:
</p>
<p>1. Open setting, go to "About" and tap on the "build number" box ~10 times until you get a message saying you are now a developer.
</p>
<p>2. Go back to the main settings page, go to system and then developer options (it might be hiding behind a drop down). Toggle the switch to "enable OEM unlocking"
</p>
<p>3. Refer to "how to enter flash mode" above to get into fastboot mode, then re-attach your USB cable. Run the following command on your host:
</p>
<pre>fastboot oem unlock
</pre>
<p>4. Read the message displayed on your device screen, once you're happy confirm the unlock. <b>THIS WILL ERASE YOUR DEVICE</b>.
</p>
<p><br>
All done! You can now continue with this guide.
</p>
<h3><span class="mw-headline" id="Prebuilt_images">Prebuilt images</span></h3>
<p>Choose an image for your device from the <a rel="nofollow" class="external text" href="https://postmarketos.org/download/">download</a> page.
</p>
<p>Download the files ending in <code>.img</code>, you may also want to download the hashes for verification. On Windows you can use a tool like 7zip to decompress the files, on Linux use <code>unxz</code>. Then use fastboot to flash with the following:
</p>
<pre>fastboot erase dtbo
fastboot flash boot &lt;date&gt;-&lt;time&gt;-postmarketOS-edge-phosh-6-oneplus-[enchilada|fajita]-boot.img
fastboot flash userdata &lt;date&gt;-&lt;time&gt;-postmarketOS-edge-phosh-6-oneplus-[enchilada|fajita].img
</pre>
<p>For prebuilt images, the default username is <code>user</code> and the default password is <code>147147</code>. It isn't possible to set up full disk encryption with prebuilt images yet.
</p>
<h3><span class="mw-headline" id="Manual_build">Manual build</span></h3>
<p>The vendor is OnePlus, the codename is "enchilada" for the OnePlus 6 and "fajita" for the OnePlus 6T.
</p>
<p>Follow the <a href="../en/Installation_guide.html" title="Installation guide">general installation guide</a>, return here when told to (at the "installation and flashing section").
</p>
<p>Now run the following, pick a password when prompted.
</p>
<pre>pmbootstrap install
</pre>
<p>Reboot back into flash mode (explained above) after each of the following commands (if you encounter weird behaviour like the command getting stuck before the flashing starts).
</p>
<p>By default the rootfs will be flashed to system, this doesn't leave much free space for your applications / data, if you don't mind factory resetting the device you can instead flash to userdata by specifying the partition like below.
</p>
<pre>fastboot erase dtbo
pmbootstrap flasher flash_rootfs --partition userdata
pmbootstrap flasher flash_kernel
</pre>
<p>Reboot and you're good to go!
</p>
<p>If you have flashing or booting issues, try first flashing the latest OxygenOS to the slot you want to install postmarketOS to (ie, flash in TWRP from your other slot). If you still have no luck, try flashing OOS 9 as the bootloader can be more forgiving.
</p>
<h2><span class="mw-headline" id="Dual_booting">Dual booting</span></h2>
<h3><span class="mw-headline" id="Flashing_to_system">Flashing to system</span></h3>
<p>It is possible to dual boot with Android when flashing postmarketOS to the system partition, although this severely limits the space available.
</p>
<p>In fastboot mode run <code>fastboot getvar current-slot</code> to get the currently active slot (where Android is installed). For this example we'll use <code>a</code> as the slot with Android, if your current slot is <code>b</code> then simply switch "a" with "b" and vice versa. To install postmarketOS to the inactive slot, run
</p>
<pre>fastboot set_active b
</pre>
<p>before following the flashing steps above, as well as replacing <code>userdata</code> in the flashing commands with <code>system</code> so as to preserve your Android userdata partition.
</p>
<p>You can now switch back to Android by entering fastboot mode and running
</p>
<pre>fastboot set_active a
</pre>
<p>Note: Substituting system for vendor is also fine. This setup also allows for a recovery pmOS install, since all partitions are accessible on any booted OS, so long as there is root access.
</p>
<h3><span class="mw-headline" id="Sharing_userdata_with_Android">Sharing userdata with Android</span></h3>
<p>It's possible to share the userdata partition with Android, using it as the postmarketOS rootfs as well as the Android data partition at the same time. This may come with unintended side effects but initial testing shows that it works well enough.
</p>
<p>The postmarketOS rootfs image is not actually an ext4 image, it's actually a full disk image containing two partitions, Android obviously doesn't know how to handle this so we have to split it up. You can do this manually with a prebuilt but that is left as an exercise to the reader...
</p>
<p>This method will erase your userdata partition, it is also non-trivial to "uninstall" postmarketOS.
</p>
<p>Before continuing, flash your Android ROM of choice and ensure that it boots. Don't go through setup as these steps will erase userdata.
</p>
<p>Run through pmbootstrap init like explained above, but instead of running <code>pmbootstrap install</code> run
</p>
<pre>pmbootstrap install --split
# And then
pmbootstrap export
</pre>
<p>You can now manually flash the boot and root partitions, note that the "boot" partition here isn't the Android boot partition, it's the postmarketOS boot partition which is used to keep the kernel, initramfs etc. We can place the boot image on vendor on the slot with postmarketOS. Make sure not to run this on your Android slot.
</p>
<pre>fastboot flash userdata /tmp/postmarketOS-export/oneplus-[enchilada|fajita]-root.img
fastboot flash vendor /tmp/postmarketOS-export/oneplus-[enchilada|fajita]-boot.img
</pre>
<p>The postmarketOS initramfs will automatically detect these during boot. You can now flash the boot partition, erase dtbo and boot postmarketOS as usual! You must boot postmarketOS so that it can resize the userdata partition before you boot Android. Once pmos first boot is done you can reboot and use fastboot to switch slots.
</p>
<p>If pmOS does not resize the partition properly, run the following on pmOS
</p>
<pre>sudo resize2fs /dev/sda17
</pre>
<h3><span class="mw-headline" id="Advanced_Partitioning">Advanced Partitioning</span></h3>
<table role="text container" style="color: inherit; background-color: #fee7e6; border: 1px solid #d33; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Icon" src="../Red_warning_icon.svg" decoding="async" title="Icon" width="20" height="20" srcset="../Red_warning_icon.svg 1.5x ../Red_warning_icon.svg 2x"><br><b>Warning!</b></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">This is a dangerous process that may hard-brick your phone, requiring the use of poorly documented EDL-mode recovery tools to fix</td>
</tr></tbody></table>
<p>More information on partitioning userdata available at <a href="../en/OnePlus_6_(oneplus-enchilada)_Custom_Partitioning.html" title="OnePlus 6 (oneplus-enchilada)/Custom Partitioning">OnePlus 6 (oneplus-enchilada)/Custom Partitioning</a>.
</p>
<h2><span class="mw-headline" id="Fastboot_bugs">Fastboot bugs</span></h2>
<p>If you encounter "weird" errors from fastboot, such as "device does not support slots":
</p>
<p>Once the device is in fastboot mode unplug it, run your fastboot / flasher command and wait for the "&lt;waiting for device&gt;" message, now choose "reboot bootloader" on the device and press the power button to select, plug in the device while it reboots.
</p>
<h2><span class="mw-headline" id="Upgrading">Upgrading</span></h2>
<p>Upgrading can be done through Alpines package manager "apk", to upgrade everything simply open a terminal and run <code>sudo apk upgrade -a</code>. This includes kernel upgrades.
</p>
<h3>
<span id="Device_won't_boot_properly_after_upgrade"></span><span class="mw-headline" id="Device_won.27t_boot_properly_after_upgrade">Device won't boot properly after upgrade</span>
</h3>
<p>On postmarketOS edge at least, there have been some issues with the kernel upgrade script, it's possible that the kernel will upgrade but the new one won't be flashed, this leads to having an old kernel but with new kernel modules. This will result in one of the following: Your device gets stuck on the postmarketOS logo, your device gets stuck on a blinking cursor, your device boots properly but wifi, bluetooth, battery and haptics are all broken.
</p>
<p>If you're able to get a shell on your device (either with ssh or locally) you can simply run the following:
</p>
<pre>sudo pmos-update-kernel postmarketos-qcom-sdm845
</pre>
<p>Alternative, you can fix this by manually flashing the upgraded kernel as follows, you will need fastboot installed on your host.
</p>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">These steps won't work if you are dual booting by sharing userdata, the postmarketOS boot partition won't be handled by Jumpdrive</td>
</tr></tbody></table>
<p>1. Download JumpDrive for the OnePlus 6 from here (pick your model): <a rel="nofollow" class="external free" href="https://github.com/dreemurrs-embedded/Jumpdrive/releases">https://github.com/dreemurrs-embedded/Jumpdrive/releases</a>
</p>
<p>2. Run <code>fastboot boot boot-oneplus-[enchilada|fajita].img</code> and wait until you see the graphics on screen.
</p>
<p>3. Open your file explorer, you should see two new drives called <code>pmOS_boot</code> and <code>pmOS_root</code>, open <code>pmOS_boot</code>.
</p>
<p>4. Copy the file <code>boot.img-postmarketos-qcom-sdm845</code> to your computer.
</p>
<p>5. Eject the drives and reboot your device into fastboot again using the button combination (see "How to enter flash mode" above).
</p>
<p>6. Run <code>fastboot flash boot /path/to/the/boot.img/you/copied</code>
</p>
<p>7. Reboot your device with <code>fastboot reboot</code>
</p>
<p>You should now boot into postmarketOS with everything working again!
</p>
<h2><span class="mw-headline" id="Building">Building</span></h2>
<p>Feel like helping? Want to learn kernel development?
</p>
<p>Check out the mainlining guide <a href="../en/SDM845_Mainlining.html" title="SDM845 Mainlining">SDM845 Mainlining</a> for detailed SDM845 specific instructions on initial device porting and building.
</p>
<p>Feel free to contact @caleb (or anyone) in the <a href="../en/Matrix_and_IRC.html" title="Matrix and IRC">#postmarketos-mainline</a> matrix channel if you're stuck.
</p>
<h2><span class="mw-headline" id="Info">Info</span></h2>
<h3><span class="mw-headline" id="Hacking">Hacking</span></h3>
<p>See <a href="../en/OnePlus_6_(oneplus-enchilada)_Hacking.html" title="OnePlus 6 (oneplus-enchilada)/Hacking">Hacking</a> for details.
</p>
<h3><span class="mw-headline" id="Partition_map">Partition map</span></h3>
<div class="toccolours mw-collapsible mw-collapsed" style="width: 1000px; overflow: auto;">
<p><code>oneplus-enchilada:~$ ls -lah /dev/disk/by-partlabel/ </code>
</p>
<div class="mw-collapsible-content">
<pre>total 0      
drwxr-xr-x    2 root     root        2.0K Jan  7  1970 .
drwxr-xr-x    8 root     root         160 Jan  7  1970 ..
lrwxrwxrwx    1 root     root          10 Jan  7  1970 ALIGN_TO_128K_1 -&gt; ../../sdd1
lrwxrwxrwx    1 root     root          10 Jan  7  1970 ALIGN_TO_128K_2 -&gt; ../../sdf1
lrwxrwxrwx    1 root     root          11 Jan  7  1970 ImageFv -&gt; ../../sde72
lrwxrwxrwx    1 root     root          11 Jan  7  1970 LOGO_a -&gt; ../../sde20
lrwxrwxrwx    1 root     root          11 Jan  7  1970 LOGO_b -&gt; ../../sde48
lrwxrwxrwx    1 root     root          10 Jan  7  1970 abl_a -&gt; ../../sde8
lrwxrwxrwx    1 root     root          11 Jan  7  1970 abl_b -&gt; ../../sde36
lrwxrwxrwx    1 root     root          10 Jan  7  1970 aop_a -&gt; ../../sde1
lrwxrwxrwx    1 root     root          11 Jan  7  1970 aop_b -&gt; ../../sde29
lrwxrwxrwx    1 root     root          11 Jan  7  1970 apdp -&gt; ../../sde63
lrwxrwxrwx    1 root     root          10 Jan  7  1970 bluetooth_a -&gt; ../../sde5
lrwxrwxrwx    1 root     root          11 Jan  7  1970 bluetooth_b -&gt; ../../sde33
lrwxrwxrwx    1 root     root          11 Jan  7  1970 boot_a -&gt; ../../sde11
lrwxrwxrwx    1 root     root          11 Jan  7  1970 boot_aging -&gt; ../../sde58
lrwxrwxrwx    1 root     root          11 Jan  7  1970 boot_b -&gt; ../../sde39
lrwxrwxrwx    1 root     root          10 Jan  7  1970 cdt -&gt; ../../sdd2
lrwxrwxrwx    1 root     root          11 Jan  7  1970 cmnlib64_a -&gt; ../../sde13
lrwxrwxrwx    1 root     root          11 Jan  7  1970 cmnlib64_b -&gt; ../../sde41
lrwxrwxrwx    1 root     root          11 Jan  7  1970 cmnlib_a -&gt; ../../sde12
lrwxrwxrwx    1 root     root          11 Jan  7  1970 cmnlib_b -&gt; ../../sde40
lrwxrwxrwx    1 root     root          11 Jan  7  1970 config -&gt; ../../sda12
lrwxrwxrwx    1 root     root          10 Jan  7  1970 ddr -&gt; ../../sdd3
lrwxrwxrwx    1 root     root          11 Jan  7  1970 devcfg_a -&gt; ../../sde14
lrwxrwxrwx    1 root     root          11 Jan  7  1970 devcfg_b -&gt; ../../sde42
lrwxrwxrwx    1 root     root          11 Jan  7  1970 devinfo -&gt; ../../sde61
lrwxrwxrwx    1 root     root          11 Jan  7  1970 dip -&gt; ../../sde62
lrwxrwxrwx    1 root     root          10 Jan  7  1970 dsp_a -&gt; ../../sde9
lrwxrwxrwx    1 root     root          11 Jan  7  1970 dsp_b -&gt; ../../sde37
lrwxrwxrwx    1 root     root          11 Jan  7  1970 dtbo_a -&gt; ../../sde18
lrwxrwxrwx    1 root     root          11 Jan  7  1970 dtbo_b -&gt; ../../sde46
lrwxrwxrwx    1 root     root          10 Jan  7  1970 frp -&gt; ../../sda6
lrwxrwxrwx    1 root     root          10 Jan  7  1970 fsc -&gt; ../../sdf5
lrwxrwxrwx    1 root     root          10 Jan  7  1970 fsg -&gt; ../../sdf4
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_4j1ed_a -&gt; ../../sde21
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_4j1ed_b -&gt; ../../sde49
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_4u1ea_a -&gt; ../../sde22
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_4u1ea_b -&gt; ../../sde50
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs3_a -&gt; ../../sde23
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs3_b -&gt; ../../sde51
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs4_a -&gt; ../../sde24
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs4_b -&gt; ../../sde52
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs5_a -&gt; ../../sde25
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs5_b -&gt; ../../sde53
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs6_a -&gt; ../../sde26
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs6_b -&gt; ../../sde54
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs7_a -&gt; ../../sde27
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs7_b -&gt; ../../sde55
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs8_a -&gt; ../../sde28
lrwxrwxrwx    1 root     root          11 Jan  7  1970 fw_ufs8_b -&gt; ../../sde56
lrwxrwxrwx    1 root     root          10 Jan  7  1970 hyp_a -&gt; ../../sde3
lrwxrwxrwx    1 root     root          11 Jan  7  1970 hyp_b -&gt; ../../sde31
lrwxrwxrwx    1 root     root          11 Jan  7  1970 keymaster_a -&gt; ../../sde10
lrwxrwxrwx    1 root     root          11 Jan  7  1970 keymaster_b -&gt; ../../sde38
lrwxrwxrwx    1 root     root          10 Jan  7  1970 keystore -&gt; ../../sda5
lrwxrwxrwx    1 root     root          11 Jan  7  1970 limits -&gt; ../../sde67
lrwxrwxrwx    1 root     root          11 Jan  7  1970 logdump -&gt; ../../sde71
lrwxrwxrwx    1 root     root          11 Jan  7  1970 logfs -&gt; ../../sde69
lrwxrwxrwx    1 root     root          10 Jan  7  1970 mdtp_a -&gt; ../../sde7
lrwxrwxrwx    1 root     root          11 Jan  7  1970 mdtp_b -&gt; ../../sde35
lrwxrwxrwx    1 root     root          10 Jan  7  1970 mdtpsecapp_a -&gt; ../../sde6
lrwxrwxrwx    1 root     root          11 Jan  7  1970 mdtpsecapp_b -&gt; ../../sde34
lrwxrwxrwx    1 root     root          11 Jan  7  1970 minidump -&gt; ../../sde57
lrwxrwxrwx    1 root     root          10 Jan  7  1970 misc -&gt; ../../sda3
lrwxrwxrwx    1 root     root          10 Jan  7  1970 modem_a -&gt; ../../sde4
lrwxrwxrwx    1 root     root          11 Jan  7  1970 modem_b -&gt; ../../sde32
lrwxrwxrwx    1 root     root          10 Jan  7  1970 modemst1 -&gt; ../../sdf2
lrwxrwxrwx    1 root     root          10 Jan  7  1970 modemst2 -&gt; ../../sdf3
lrwxrwxrwx    1 root     root          11 Jan  7  1970 msadp -&gt; ../../sde64
lrwxrwxrwx    1 root     root          11 Jan  7  1970 odm_a -&gt; ../../sda15
lrwxrwxrwx    1 root     root          11 Jan  7  1970 odm_b -&gt; ../../sda16
lrwxrwxrwx    1 root     root          10 Jan  7  1970 oem_dycnvbk -&gt; ../../sda8
lrwxrwxrwx    1 root     root          10 Jan  7  1970 oem_stanvbk -&gt; ../../sda9
lrwxrwxrwx    1 root     root          11 Jan  7  1970 op1 -&gt; ../../sde59
lrwxrwxrwx    1 root     root          10 Jan  7  1970 op2 -&gt; ../../sda7
lrwxrwxrwx    1 root     root          10 Jan  7  1970 param -&gt; ../../sda4
lrwxrwxrwx    1 root     root          10 Jan  7  1970 persist -&gt; ../../sda2
lrwxrwxrwx    1 root     root          11 Jan  7  1970 qupfw_a -&gt; ../../sde15
lrwxrwxrwx    1 root     root          11 Jan  7  1970 qupfw_b -&gt; ../../sde43
lrwxrwxrwx    1 root     root          11 Jan  7  1970 reserve1 -&gt; ../../sda10
lrwxrwxrwx    1 root     root          11 Jan  7  1970 reserve2 -&gt; ../../sda11
lrwxrwxrwx    1 root     root          11 Jan  7  1970 sec -&gt; ../../sde60
lrwxrwxrwx    1 root     root          11 Jan  7  1970 splash -&gt; ../../sde66
lrwxrwxrwx    1 root     root          11 Jan  7  1970 spunvm -&gt; ../../sde65
lrwxrwxrwx    1 root     root          10 Jan  7  1970 ssd -&gt; ../../sda1
lrwxrwxrwx    1 root     root          11 Jan  7  1970 sti -&gt; ../../sde70
lrwxrwxrwx    1 root     root          11 Jan  7  1970 storsec_a -&gt; ../../sde19
lrwxrwxrwx    1 root     root          11 Jan  7  1970 storsec_b -&gt; ../../sde47
lrwxrwxrwx    1 root     root          11 Jan  7  1970 system_a -&gt; ../../sda13
lrwxrwxrwx    1 root     root          11 Jan  7  1970 system_b -&gt; ../../sda14
lrwxrwxrwx    1 root     root          11 Jan  7  1970 toolsfv -&gt; ../../sde68
lrwxrwxrwx    1 root     root          10 Jan  7  1970 tz_a -&gt; ../../sde2
lrwxrwxrwx    1 root     root          11 Jan  7  1970 tz_b -&gt; ../../sde30
lrwxrwxrwx    1 root     root          11 Jan  7  1970 userdata -&gt; ../../sda17
lrwxrwxrwx    1 root     root          11 Jan  7  1970 vbmeta_a -&gt; ../../sde17
lrwxrwxrwx    1 root     root          11 Jan  7  1970 vbmeta_b -&gt; ../../sde45
lrwxrwxrwx    1 root     root          11 Jan  7  1970 vendor_a -&gt; ../../sde16
lrwxrwxrwx    1 root     root          11 Jan  7  1970 vendor_b -&gt; ../../sde44
lrwxrwxrwx    1 root     root          10 Jan  7  1970 xbl_a -&gt; ../../sdb1
lrwxrwxrwx    1 root     root          10 Jan  7  1970 xbl_b -&gt; ../../sdc1
lrwxrwxrwx    1 root     root          10 Jan  7  1970 xbl_config_a -&gt; ../../sdb2
lrwxrwxrwx    1 root     root          10 Jan  7  1970 xbl_config_b -&gt; ../../sdc2
</pre>
</div>
</div>
<h2><span class="mw-headline" id="The_big_list_of_issues">The big list of issues</span></h2>
<p>In no particular order...
</p>
<h3><span class="mw-headline" id="Stuck_in_fastboot_after_rebooting">Stuck in fastboot after rebooting</span></h3>
<p>This happens because of Android/qcom A/B slot switching, fix it with the following:
</p>
<p>Get the current slot
</p>
<pre>fastboot getvar current-slot
</pre>
<p>Switch to the inactive slot and back again to reset to slot retry count:
</p>
<pre># Assuming the current slot is "a"
fastboot set_active b set_active a
# If the current slot is b
fastboot set_active a set_active b
</pre>
<p>In short, when you do an upgrade in Android, it installs to the other slot, and then switches to that slot, to handle the case where the upgrade is bad and doesn't boot anymore A/B implements a kind of dead mans switch, after booting Android is meant to set a flag to "mark boot successful", if that flag isn't set then it's meant to boot into recovery instead, after ~7 reboots the bootloader gives up and refuses to boot, leaving you in fastboot. Because postmarketOS doesn't implement a "recovery" it just boots normally.
</p>
<p>So after ~7 boots you'll end up in this state and have to run the above.
</p>
<p>The research done in <a rel="nofollow" class="external free" href="https://gitlab.com/sdm845-mainline/qbootctl">https://gitlab.com/sdm845-mainline/qbootctl</a> and <a rel="nofollow" class="external free" href="https://gitlab.com/sdm845-mainline/abootctl">https://gitlab.com/sdm845-mainline/abootctl</a> will eventually resolve this by implementing the bootctrl features in mainline.
</p>
<h3><span class="mw-headline" id="Charging">Charging</span></h3>
<p>Charging is for some reason extremely slow on the OnePlus 6, I haven't yet figured out quite why. If your device is refusing to charge properly, turn it off and plug it into the charger whilst holding volume up. This will put the device into EDL mode which uses the minimum amount of power and will charge it properly. A full charge will take around 2-3 hours.
</p>
<p>This will be fixed by proper smb2 / charger driver support in the kernel.
</p>
<h3><span class="mw-headline" id="Tri-state_key_support">Tri-state key support</span></h3>
<p>Being worked on! Might also end up with a kernel driver at some point to simplify the daemon. Hopefully it gets merged soon.
</p>
<p><a rel="nofollow" class="external free" href="https://github.com/michele-perrone/postmarketos-oneplus6-tristatekey">https://github.com/michele-perrone/postmarketos-oneplus6-tristatekey</a>
</p>
<p>A kernel device driver for the tri-state key could use the EV_MSC event codes : <a rel="nofollow" class="external free" href="https://www.kernel.org/doc/Documentation/input/event-codes.txt">https://www.kernel.org/doc/Documentation/input/event-codes.txt</a>, these are used for misc devices to report some arbitrary input event, this can then be handled by the user daemon!
</p>
<h3><span class="mw-headline" id="Phosh_clock_hidden_by_notch">Phosh clock hidden by notch</span></h3>
<p>One can get around this quirk by tweaking the file <code>~/.config/gtk-3.0/gtk.css</code> with something such as:
</p>
<pre>.phosh-topbar-clock {
  padding-left: 130px;
}
</pre>
<p>to move the clock slightly to the right of the notch.
</p>
<p>The rounded corners on the 6T can be annoying as well.
</p>
<h3><span class="mw-headline" id="HW_Video_decoding_is_broken">HW Video decoding is broken</span></h3>
<p>Venus works, gstreamer has support for it but the colours are all wrong. Firefox doesn't seem to support it properly.
</p>
<h2>
<span id="3rd_party_displays_/_touch_panels_don't_work"></span><span class="mw-headline" id="3rd_party_displays_.2F_touch_panels_don.27t_work">3rd party displays / touch panels don't work</span>
</h2>
<p>Some manufacturer realised they could cheap out on touch controllers, so 3rd party touch panels don't actually implement the synaptics rmi4 spec properly. The rmi4 driver will need some hacks to deal with this.
</p>
<p>My regular 6 with a display replacement also seems to fail to init the display after its been reset.
</p>
<p>RMI4 attempting to probe on a fake touch IC will look something like the following:
</p>
<pre>[    3.502580] rmi4_i2c 12-0020: registering I2C-connected sensor
[    6.081770] rmi4_f01 rmi4-00.fn01: found RMI device, manufacturer: unknown, product: , fw id: 0
[    6.094861] rmi4_f12 rmi4-00.fn12: Behavior of F12 without register descriptors is undefined.
</pre>
<h2><span class="mw-headline" id="GPS">GPS</span></h2>
<p>GPSd should work, mostly untested. Requires <a rel="nofollow" class="external text" href="https://gitlab.com/gpsd/gpsd/-/merge_requests/139">a patch</a> to add QMI support which won't be merged due to missing docs. I will try and produce some documentation to allow this to be merged.
</p>
<h2><span class="mw-headline" id="Camera">Camera</span></h2>
<p>Have to dump sensor init sequence from downstream and pray, need more time for tweaking this but it should be possible to make it work
</p>
<h2><span class="mw-headline" id="Sensors">Sensors</span></h2>
<p>The SLPI is partially documented, yet to successfully talk to it on mainline. DTS and driver compatibles are missing too (need to submit support). <a rel="nofollow" class="external free" href="https://github.com/calebccff/sensordaemon-re">https://github.com/calebccff/sensordaemon-re</a>
</p>
<h2><span class="mw-headline" id="TrustZone">TrustZone</span></h2>
<p>Drivers to communicate with the QSEE (Qualcomm Secure Execution Environment) are not on mainline and you can't flash OP-TEE because XBL_SEC checks the signature. Those drivers are called QSEECOM in the CAF kernel but there is the need to standardize them using the generic interface defined in <code>include/uapi/linux/tee.h</code>. You can use the OP-TEE implementation as an example. More documentation here <a rel="nofollow" class="external free" href="https://www.kernel.org/doc/html/latest/staging/tee.html">https://www.kernel.org/doc/html/latest/staging/tee.html</a>.
</p>
<p>Having a TrustZone is useful to do a lot of things related to security, but mainly fingerprint management, secure encryption involved in NFC, useful to emulate contactless smart cards, and Widevine L1 to watch premium streaming services with the best resolution!
</p>
<p>Regarding DRMs and userland, on Waydroid or Android mainline you need to develop <code>oemcrypto.so</code> with the support of the standard API for the TEE; manufacturers implement it with their custom interfaces. Look at this <a rel="nofollow" class="external free" href="https://source.android.com/devices/drm#drm-plugins">https://source.android.com/devices/drm#drm-plugins</a>.
</p>
<p>On GNU/Linux, you need to implement/enable Widevine L1 on players. For example on Firefox, if you want to watch Netflix or other in-browser streaming services, but you might also want to use an extension like <a rel="nofollow" class="external free" href="https://github.com/lkmvip/netflix-4K-DDplus">https://github.com/lkmvip/netflix-4K-DDplus</a> to spoof the device and so make Netflix give you the encrypted stream.
Another good implementation opportunity is on FFMPEG/VLC, it would be cool to make VLC able to stream Netflix and also having the possibility to save decrypted streams.
</p>
<p>I really like this project, but first I want to devote myself to whatever is needed to make this device usable.
Have fun!
</p>
<h2><span class="mw-headline" id="Fastboot_flashing_issues">Fastboot flashing issues</span></h2>
<p>The fastboot implementation leaves some to be desired... If you encounter issues flashing with fastboot getting stuck or displaying weird errors like <code>device does not support slots</code>, prepare the fastboot flash command in your terminal, on the device choose the "reboot bootloader" option from fastboot, press the power button to confirm and then run the command while the device reboots.
</p>
<p>You'll see a "waiting for device" message in your terminal, the flashing should start as soon as the device gets back into fastboot mode.
</p>
<h2><span class="mw-headline" id="Modem_bugs">Modem bugs</span></h2>
<p>The recent enablement of ModemManager enables SMS and mobile data to work on supported SDM845 devices including the OnePlus 6 and 6T. It isn't possible to test these extensively due to the number of region specific and carrier specific issues that could arise.
</p>
<p>If you're encountering modem issues, perform the following steps to collect logs and submit them so that I or someone else can review:
</p>
<p>On your device with SIM card inserted:
</p>
<pre>sudo service modemmanager stop
sudo service msm-modem-uim-selection restart
sudo ModemManager --debug | tee mm.log
</pre>
<p>If your device requires SIM unlocking, perform that in Phosh settings, wait for a few seconds and then stop modemmanager again.
</p>
<p>Create a new issue <a rel="nofollow" class="external text" href="https://gitlab.freedesktop.org/mobile-broadband/ModemManager">in ModemManager here</a> to explain your issue, include a link to a pastebin containing the logs you captured (they're in mm.log in your home directory on device). At the bottom of your issue add <code>Cc: @calebccff</code> so that I'll be notified.
</p>
<p>Please also include the output of <code>uname -a</code> and <code>sudo qmicli -d qrtr://0 --uim-get-card-status</code> in your issue.
</p>
<h3><span class="mw-headline" id="Call_audio">Call audio</span></h3>
<p>Call audio is missing because the q6voice driver hasn't yet been ported from downstream. It is required to handle routing audio to the earpiece speaker during calls. [<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues/1338">relevant pmaports issue</a>]
</p>
<h3><span class="mw-headline" id="Dual_Sim">Dual Sim</span></h3>
<p>Some users have reported issues with dual SIM causing modemmanager issues, whilst modemmanager should automatically select the first SIM, it lacks proper dual SIM support and sometimes can get confused. Currently the best workaround is to make sure you only have one SIM card inserted.
</p>
<h2><span class="mw-headline" id="Community_Info">Community Info</span></h2>
<h3><span class="mw-headline" id="postmarketOS_users_that_own_the_device">postmarketOS users that own the device</span></h3>
<div style="-webkit-column-count: 2; -moz-column-count: 2; column-count: 2;"><ul style="margin-top: 0;">
<li>
<a href="../User:Aleksander.html" title="User:Aleksander">Aleksander</a> (<span class="cargoFieldName">Notes:</span> WWAN stack tinkering)</li>
<li><a href="../User:Antonok.html" title="User:Antonok">Antonok</a></li>
<li><a href="../User:Blacklight.html" title="User:Blacklight">Blacklight</a></li>
<li>
<a href="../User:DrGit.html" title="User:DrGit">DrGit</a> (<span class="cargoFieldName">Notes:</span> 128GB)</li>
<li>
<a href="../User:DrGit.html" title="User:DrGit">DrGit</a> (<span class="cargoFieldName">Notes:</span> 256GB)</li>
<li>
<a href="../User:DylanVanAssche.html" title="User:DylanVanAssche">DylanVanAssche</a> (<span class="cargoFieldName">Notes:</span> LineageOS)</li>
<li>
<a href="../User:Frankwalter.html" title="User:Frankwalter">Frankwalter</a> (<span class="cargoFieldName">Notes:</span> [6GB/128GB] I bought it to experiment with Linux mobile, so I can help mainlining it and learn about drivers development in the process! (fajita))</li>
<li>
<a href="../User:Hacker420.html" title="User:Hacker420">Hacker420</a> (<span class="cargoFieldName">Notes:</span> Daily driver, dualbooted with Android and pmOS on the other slot.)</li>
<li><a href="../User:Jrg.html" title="User:Jrg">Jrg</a></li>
<li>
<a href="../User:Kalube.html" title="User:Kalube">Kalube</a> (<span class="cargoFieldName">Notes:</span> 256GB postmarketOS daily driver)</li>
<li>
<a href="../User:Kalube.html" title="User:Kalube">Kalube</a> (<span class="cargoFieldName">Notes:</span> 3rd party touch screen to be fixed)</li>
<li>
<a href="../User:Kalube.html" title="User:Kalube">Kalube</a> (<span class="cargoFieldName">Notes:</span> lab rat)</li>
<li>
<a href="../User:Ksqeib.html" title="User:Ksqeib">Ksqeib</a> (<span class="cargoFieldName">Notes:</span> Using as Minecraft Server)</li>
<li>
<a href="../User:No112.html" title="User:No112">No112</a> (<span class="cargoFieldName">Notes:</span> Looking into assisting with mainline efforts and various fixes)</li>
<li>
<a href="../User:Okias.html" title="User:Okias">Okias</a> (<span class="cargoFieldName">Notes:</span> 8G/128G (fajita))</li>
<li><a href="../User:PanzerSajt.html" title="User:PanzerSajt">PanzerSajt</a></li>
<li>
<a href="../User:SevralT.html" title="User:SevralT">SevralT</a> (<span class="cargoFieldName">Notes:</span> My second phone for Linux ;p)</li>
<li>
<a href="../User:Syboxez.html" title="User:Syboxez">Syboxez</a> (<span class="cargoFieldName">Notes:</span> (128G/8G) Daily driver on Slot B, tinker phone on Slot A)</li>
</ul></div>
<p><br>
</p>
<h3><span class="mw-headline" id="Maintainers">Maintainers</span></h3>
<ul><li><a href="../User:Kalube.html" title="User:Kalube">Caleb</a></li></ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<h3><span class="mw-headline" id="Internal_pages">Internal pages</span></h3>
<ul class="mw-prefixindex-list">
<li><a href="../en/OnePlus_6_(oneplus-enchilada)_Custom_Partitioning.html" title="OnePlus 6 (oneplus-enchilada)/Custom Partitioning">OnePlus 6 (oneplus-enchilada)/Custom Partitioning</a></li>
<li><a href="../en/OnePlus_6_(oneplus-enchilada)_Hacking.html" title="OnePlus 6 (oneplus-enchilada)/Hacking">OnePlus 6 (oneplus-enchilada)/Hacking</a></li>
</ul>
<ul><li><a href="../en/OnePlus_6T_(oneplus-fajita).html" title="OnePlus 6T (oneplus-fajita)">OnePlus 6T (oneplus-fajita)</a></li></ul>
<h3><span class="mw-headline" id="External_links">External links</span></h3>
<ul>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/sdm845-mainline/linux">Kernel sources</a></li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/1221">pmaports!1221</a> Initial merge request.</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/1271">pmaports!1271</a> Updates to add panel mode and WiFi support.</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/2088">pmaports!2088</a> Move the OnePlus 6 to "community" devices category</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/1967">pmaports!1967</a> Switch to common linux-postmarketos-qcom-sdm845 kernel instead of device specific kernel</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/2206">pmaports!2206</a> Update to 5.12.8 and add support for the speaker / headphone jack on the OnePlus 6</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/2215">pmaports!2215</a> Support automatic kernel updates for Android devices (including A/B!)</li>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/tree/master/device/community/device-oneplus-enchilada">Enchilada device package</a></li>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/tree/master/device/community/device-oneplus-fajita">Fajita device package</a></li>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/tree/master/main/linux-postmarketos-qcom-sdm845">Kernel package</a></li>
<li><a rel="nofollow" class="external text" href="https://cast.postmarketos.org/episode/08-Interview-Caleb-Connolly-SDM-845-Mainlining/">postmarketOS podcast interview with Caleb about mainlining the OnePlus 6</a></li>
</ul>
<p><br>
</p>
</div></div>
		
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Devices.html" title="Category:Devices">Devices</a></li></ul>
</div></div>
		<div class="visualClear"></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=OnePlus_6_(oneplus-enchilada)&amp;oldid=27716">https://wiki.postmarketos.org/index.php?title=OnePlus_6_(oneplus-enchilada)&amp;oldid=27716</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 15 May 2022, at 16:55.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../en/About_postmarketOS.html" class="mw-redirect" title="PostmarketOS:About">About postmarketOS</a></li>
								<li id="footer-places-disclaimer"><a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-mobileview"><a href="https://wiki.postmarketos.org/index.php?title=OnePlus_6_(oneplus-enchilada)&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="../poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="" width="88" height="31"></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

</body>
</html>
