<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Xiaomi Redmi Note 7 (xiaomi-lavender) - postmarketOS</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.34.2">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="postmarketOS (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Xiaomi_Redmi_Note_7_xiaomi-lavender rootpage-Xiaomi_Redmi_Note_7_xiaomi-lavender skin-vector action-view">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">Xiaomi Redmi Note 7 (xiaomi-lavender)</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From postmarketOS</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Xiaomi Redmi Note 7</caption>
<tbody>
<tr class=""><td colspan="2" class="" style="text-align:center;">
<a href="../Lavender_downstream_weston.jpg" class="image"><img alt="Redmi Note 7" src="../Lavender_downstream_weston.jpg" decoding="async" width="200" height="409" srcset="../Lavender_downstream_weston.jpg 1.5x ../Lavender_downstream_weston.jpg 2x"></a><br><span style="">Redmi Note 7</span>
</td></tr>
<tr class="">
<th scope="row" style="text-align:left;">Manufacturer</th>
    <td class="" style="">
Xiaomi</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Name</th>
    <td class="" style="">
Redmi Note 7</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Codename</th>
    <td class="" style="">
xiaomi-lavender</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Released</th>
    <td class="" style="">
2019</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Category</th>
    <td class="" style="">
testing</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Original software</th>
    <td class="" style="">
Android 9, MIUI 10</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">postmarketOS kernel</th>
    <td class="" style="">
5.17.0</td>
</tr>
<tr><th colspan="2" class="" style="text-align:center;">Hardware</th></tr>
<tr class="">
<th scope="row" style="text-align:left;">Chipset</th>
    <td class="" style="">
Qualcomm SDM660 Snapdragon 660</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">CPU</th>
    <td class="" style="">
8-core (4x 2.2 GHz Kryo 260 &amp; 4x 1.8 GHz Kryo 260)</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPU</th>
    <td class="" style="">
Adreno 512</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Display</th>
    <td class="" style="">
1080 x 2340</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Storage</th>
    <td class="" style="">
32/64/128 GB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Memory</th>
    <td class="" style="">
3/4/6 GB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Architecture</th>
    <td class="" style="">
aarch64</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Features</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="After connecting the device with USB to your PC, you can connect to it via telnet (initramfs) or SSH (booted system).">USB Networking</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="It is possible to flash the device with `pmbootstrap flasher`.">Flashing</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Touchscreen</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Display works. Ideally with sleep mode and brightness control.">Display</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">WiFi</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Full disk encryption and unlocking with osk-sdl.">FDE</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Instead of a Linux kernel fork, it is possible to run mainline.">Mainline</abbr></th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Charging and battery level reporting works">Battery</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">3D Acceleration</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Audio playback, microphone, headset and buttons.">Audio</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Bluetooth</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Camera</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPS</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Mobile data</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">SMS</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Calls</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">USB OTG</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">NFC</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Sensors</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Auto screen rotation works in desktops e.g. Phosh or Plasma Mobile">Accelerometer</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Magnetometer</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ambient Light</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Proximity</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Used as flip cover sensor, keyboard slide out sensor, etc.">Hall Effect</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Misc</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;">Ir TX</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">TrustZone</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<p><br>
</p>
<p><br>
</p>
<table class="infobox" style="float: right; width: 22em; color: inherit; background-color: #f7fff7; border: 3px solid #8a8;"><tbody><tr><td>
<b>This device is based on <a href="../en/Qualcomm_Snapdragon_660_(SDM660).html" title="Qualcomm Snapdragon 660 (SDM660)">Snapdragon 660</a>.</b><br>See the SoC page for common tips, guides and troubleshooting steps</td></tr></tbody></table>
<h2><span class="mw-headline" id="Contributors">Contributors</span></h2>
<ul><li><i><a href="../User:Alexeymin.html" title="User:Alexeymin">Alexey Min</a></i></li></ul>
<h2>
<span id="Maintainer(s)"></span><span class="mw-headline" id="Maintainer.28s.29">Maintainer(s)</span>
</h2>
<ul><li><i><a href="../User:Alexeymin.html" title="User:Alexeymin">Alexey Min</a></i></li></ul>
<h2><span class="mw-headline" id="Users_owning_this_device">Users owning this device</span></h2>
<div style="-webkit-column-count: 2; -moz-column-count: 2; column-count: 2;"><ul style="margin-top: 0;">
<li>
<a href="../User:Alexeymin.html" title="User:Alexeymin">Alexeymin</a> (<span class="cargoFieldName">Notes:</span> possible future test subject)</li>
<li><a href="../User:Alikates.html" title="User:Alikates">Alikates</a></li>
<li><a href="../User:Danct12.html" title="User:Danct12">Danct12</a></li>
<li>
<a href="../User:Jcgruenhage.html" title="User:Jcgruenhage">Jcgruenhage</a> (<span class="cargoFieldName">Notes:</span> Temporarily on LineageOS)</li>
<li>
<a href="../User:Kalwardin.html" title="User:Kalwardin">Kalwardin</a> (<span class="cargoFieldName">Notes:</span> Main device, Lineage OS)</li>
<li><a href="../User:Perigoso.html" title="User:Perigoso">Perigoso</a></li>
<li>
<a href="../User:Vimsky.html" title="User:Vimsky">Vimsky</a> (<span class="cargoFieldName">Notes:</span> Main device, UBports)</li>
</ul></div>
<p><br>
</p>
<h2><span class="mw-headline" id="How_to_enter_flash_mode">How to enter flash mode</span></h2>
<h3><span class="mw-headline" id="Bootloader_Unlocking">Bootloader Unlocking</span></h3>
<p>Like other Xiaomi devices, the user will have to acquire the bootloader unlock key: <a rel="nofollow" class="external free" href="https://en.miui.com/unlock">https://en.miui.com/unlock</a>
</p>
<p>The device will not unlock if the device isn't 7 days old (from the time when your device connects to internet and powered on, and linked with Mi Account)
</p>
<h3><span class="mw-headline" id="Recovery_mode">Recovery mode</span></h3>
<ul>
<li>Turn the device off (or restart also works)</li>
<li>Hold <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Volume Up</span> and <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Power</span> button</li>
<li>Once you feel vibration and phone turns on, release <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Power</span> button</li>
<li>Keep holding <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Volume Up</span> until you get to recovery.</li>
</ul>
<h3>
<span id="Flashing_(Download,_Fastboot)_mode"></span><span class="mw-headline" id="Flashing_.28Download.2C_Fastboot.29_mode">Flashing (Download, Fastboot) mode</span>
</h3>
<ul><li>Same as recovery, but this time hold the <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Volume Down</span> and <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Power</span> keys.</li></ul>
<h3><span class="mw-headline" id="Fastboot_boot">Fastboot boot</span></h3>
<p>In theory <code>pmbootstrap flasher boot</code> allows to directly boot kernel through USB without flashing it, but does not currently work. Bootloader does not like something about kernel compression:
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="width: 620px; overflow: auto;">
<p>Bootloader UART logs during "pmbootstrap flasher boot":
</p>
<div class="mw-collapsible-content">
<pre> Handling Cmd: boot
Booting Into Mission Mode
avb_slot_verify.c:432: DEBUG: Loading vbmeta struct from partition 'vbmeta'.
Partition found: vbmeta
avb_slot_verify.c:627: ERROR: vbmeta: Public key used to sign data rejected.
avb_slot_verify.c:704: DEBUG: vbmeta: VERIFICATION_DISABLED bit is set.
avb_slot_verify.c:317: DEBUG: dtbo: Loading entire partition.
Partition found: dtbo
State: Unlocked, AvbSlotVerify returned ERROR_PUBLIC_KEY_REJECTED, continue boot
VB2: Authenticate complete! boot state is: orange
VB2: boot state: orange(1)
Display menu is not enabled!
Device is unlocked, Skipping boot verification
VB2: BootState = 1
ReadKeyInternal: gEfiSimpleTextInputExProtocolGuid handles = 3
ReadKeyInternal: Read KEY = 0x0
 bootstate = 4
Cannot find GraphicsHandles.
ImageWidth=1080,ImageHeight=1920,LogoPosX=0,LogoPosY=0
Avoid flicking for 2160x1080 images 
Cannot find GraphicsHandles.
Render Splash  [3360687]
VB2: RenderSplashScreen end , BootState = 4 
No Ffbm cookie found, ignore: Not Found
Memory Base Address: 0x40000000
Decompressing kernel image start: 3360690 ms
Error in decompression: Something went wrong while decompression
Decompressing kernel image failed!!!
</pre>
</div>
</div>
<p>But it was reported to work for some people. Try it, might work for you
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<ul>
<li>
<a href="../en/Installing_pmbootstrap.html" title="Installing pmbootstrap">Install pmbootstrap</a> first on your PC</li>
<li>make sure you have TWRP installed on the phone, it will help you to make backups:</li>
<li>backup <code>boot</code>, <code>dtbo</code> and <code>system</code> partitions first from TWRP, something like this, for example, to SD card:</li>
</ul>
<pre>adb shell
dd if=/dev/block/bootdevice/by-name/boot of=/external_sd/backups/orig_boot.img
dd if=/dev/block/bootdevice/by-name/dtbo of=/external_sd/backups/orig_dtbo.img
dd if=/dev/block/bootdevice/by-name/system of=/external_sd/backups/orig_system.img
</pre>
<ul>
<li>zap &amp; reinit pmbootstrap (<code>pmbootstrap -y zap ; pmbootstrap init</code>), choose <code>xiaomi-lavender</code> as a device</li>
<li>proceed with installation as usual: reboot device to fastboot mode, then:</li>
</ul>
<pre>pmbootstrap install
pmbootstrap flasher flash_kernel
pmbootstrap flasher flash_rootfs
pmbootstrap flasher flash_vbmeta
</pre>
<p>For mainline kernel only (where nothing works except UART):
</p>
<pre>fastboot erase dtbo
</pre>
<p>And then
</p>
<pre>fastboot reboot
</pre>
<h2><span class="mw-headline" id="Tested_UIs">Tested UIs</span></h2>
<ul>
<li>weston</li>
<li>xfce4</li>
<li>plasma-mobile</li>
</ul>
<h3><span class="mw-headline" id="Running_Plasma_Mobile_UI_on_framebuffer_backend">Running Plasma Mobile UI on framebuffer backend</span></h3>
<p>See <a href="../en/Plasma_Mobile.html#Software_rendering" title="Plasma Mobile">Plasma_Mobile#Software_rendering</a>
</p>
<h2><span class="mw-headline" id="Photos">Photos</span></h2>
<ul class="gallery mw-gallery-traditional">
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="../Lavender_downstream_weston.jpg" class="image"><img alt="" src="../Lavender_downstream_weston.jpg" decoding="async" width="58" height="120" srcset="../Lavender_downstream_weston.jpg 1.5x ../Lavender_downstream_weston.jpg 2x"></a></div></div>
			<div class="gallerytext">
<p>Weston on downstream kernel
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="../Lavender_boot_log_sm.jpg" class="image"><img alt="" src="../Lavender_boot_log_sm.jpg" decoding="async" width="58" height="120" srcset="../Lavender_boot_log_sm.jpg 1.5x ../Lavender_boot_log_sm.jpg 2x"></a></div></div>
			<div class="gallerytext">
<p>Lavender booting mainline
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="../Lavender_plamo_ds_01.jpg" class="image"><img alt="" src="../Lavender_plamo_ds_01.jpg" decoding="async" width="65" height="120" srcset="../Lavender_plamo_ds_01.jpg 1.5x ../Lavender_plamo_ds_01.jpg 2x"></a></div></div>
			<div class="gallerytext">
<p>PlaMo on fbdev 1
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="../Lavender_plamo_ds_02.jpg" class="image"><img alt="" src="../Lavender_plamo_ds_02.jpg" decoding="async" width="57" height="120" srcset="../Lavender_plamo_ds_02.jpg 1.5x ../Lavender_plamo_ds_02.jpg 2x"></a></div></div>
			<div class="gallerytext">
<p>PlaMo on fbdev 2
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:15px auto;"><a href="../RMN7_XFCE.png" class="image"><img alt="" src="../RMN7_XFCE.png" decoding="async" width="67" height="120" srcset="../RMN7_XFCE.png 1.5x ../RMN7_XFCE.png 2x"></a></div></div>
			<div class="gallerytext">
<p>X11 (Xfce) on fbdev
</p>
			</div>
		</div></li>
		<li class="gallerybox" style="width: 155px"><div style="width: 155px">
			<div class="thumb" style="width: 150px;"><div style="margin:25px auto;"><a href="../Lavender_plasma_desktop_framebuffer.jpg" class="image"><img alt="" src="../Lavender_plasma_desktop_framebuffer.jpg" decoding="async" width="120" height="100" srcset="../Lavender_plasma_desktop_framebuffer.jpg 1.5x ../Lavender_plasma_desktop_framebuffer.jpg 2x"></a></div></div>
			<div class="gallerytext">
<p>Plasma Desktop on fbdev
</p>
			</div>
		</div></li>
</ul>
<h2><span class="mw-headline" id="Additional_info">Additional info</span></h2>
<h3><span class="mw-headline" id="Partition_list">Partition list</span></h3>
<div class="toccolours mw-collapsible mw-collapsed" style="width: 620px; overflow: auto;">
<p>Partition list
</p>
<div class="mw-collapsible-content">
<table class="wikitable">

<tbody>
<tr>
<th>Device</th>
<th>Label</th>
<th>Size in blocks</th>
<th>Size in bytes</th>
<th>Stock FS
</th>
</tr>
<tr>
<td>mmcblk0p1</td>
<td>switch</td>
<td>8</td>
<td>8192</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p2</td>
<td>dpo</td>
<td>8</td>
<td>8192</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p3</td>
<td>fsc</td>
<td>8</td>
<td>8192</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p4</td>
<td>limits</td>
<td>32</td>
<td>32768</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p5</td>
<td>ssd</td>
<td>32</td>
<td>32768</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p6</td>
<td>sec</td>
<td>20</td>
<td>20480</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p7</td>
<td>vbmeta</td>
<td>64</td>
<td>65536</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p8</td>
<td>vbmetabak</td>
<td>64</td>
<td>65536</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p9</td>
<td>storsec</td>
<td>128</td>
<td>128K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p10</td>
<td>storsecbak</td>
<td>128</td>
<td>128K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p11</td>
<td>apdp</td>
<td>256</td>
<td>256K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p12</td>
<td>msadp</td>
<td>256</td>
<td>256K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p13</td>
<td>keystore</td>
<td>512</td>
<td>512K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p14</td>
<td>frp</td>
<td>512</td>
<td>512K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p15</td>
<td>rpm</td>
<td>512</td>
<td>512K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p16</td>
<td>rpmbak</td>
<td>512</td>
<td>512K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p17</td>
<td>hyp</td>
<td>512</td>
<td>512K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p18</td>
<td>hypbak</td>
<td>512</td>
<td>512K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p19</td>
<td>pmic</td>
<td>512</td>
<td>512K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p20</td>
<td>pmicbak</td>
<td>512</td>
<td>512K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p21</td>
<td>cmnlib</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p22</td>
<td>cmnlibbak</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p23</td>
<td>cmnlib64</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p24</td>
<td>cmnlib64bak</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p25</td>
<td>abl</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p26</td>
<td>ablbak</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p27</td>
<td>dip</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p28</td>
<td>ddr</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p29</td>
<td>toolsfv</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p30</td>
<td>devcfgbak</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p31</td>
<td>devcfg</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p32</td>
<td>tz</td>
<td>4096</td>
<td>4096K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p33</td>
<td>tzbak</td>
<td>4096</td>
<td>4096K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p34</td>
<td>mdtpsecapp</td>
<td>4096</td>
<td>4096K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p35</td>
<td>mdtpsecappbak</td>
<td>4096</td>
<td>4096K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p36</td>
<td>keymaster</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p37</td>
<td>keymasterbak</td>
<td>1024</td>
<td>1024K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p38</td>
<td>bluetooth</td>
<td>1024</td>
<td>1024K</td>
<td>vfat
</td>
</tr>
<tr>
<td>mmcblk0p39</td>
<td>lsti</td>
<td>2048</td>
<td>2048K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p40</td>
<td>xbl</td>
<td>3584</td>
<td>3584K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p41</td>
<td>xblbak</td>
<td>3584</td>
<td>3584K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p42</td>
<td>misc</td>
<td>4096</td>
<td>4096K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p43</td>
<td>devinfo</td>
<td>8192</td>
<td>8192K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p44</td>
<td>logfs</td>
<td>8192</td>
<td>8192K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p45</td>
<td>fsg</td>
<td>8192</td>
<td>8192K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p46</td>
<td>modemst1</td>
<td>8192</td>
<td>8192K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p47</td>
<td>modemst2</td>
<td>8192</td>
<td>8192K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p48</td>
<td>dsp</td>
<td>16384</td>
<td>16.0M</td>
<td>vfat
</td>
</tr>
<tr>
<td>mmcblk0p49</td>
<td>bk1</td>
<td>24576</td>
<td>24.0M</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p50</td>
<td>mdtp</td>
<td>32768</td>
<td>32.0M</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p51</td>
<td>bk2</td>
<td>16384</td>
<td>16.0M</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p52</td>
<td>dtbo</td>
<td>8192</td>
<td>8192K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p53</td>
<td>dtbobak</td>
<td>8192</td>
<td>8192K</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p54</td>
<td>splash</td>
<td>65536</td>
<td>64.0M</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p55</td>
<td>persist</td>
<td>32768</td>
<td>32.0M</td>
<td>ext4
</td>
</tr>
<tr>
<td>mmcblk0p56</td>
<td>persistbak</td>
<td>32768</td>
<td>32.0M</td>
<td>ext4
</td>
</tr>
<tr>
<td>mmcblk0p57</td>
<td>logdump</td>
<td>65536</td>
<td>64.0M</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p58</td>
<td>modem</td>
<td>196608</td>
<td>192M</td>
<td>vfat
</td>
</tr>
<tr>
<td>mmcblk0p59</td>
<td>rawdump</td>
<td>131072</td>
<td>128M</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p60</td>
<td>boot</td>
<td>65536</td>
<td>64.0M</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p61</td>
<td>recovery</td>
<td>65536</td>
<td>64.0M</td>
<td>
</td>
</tr>
<tr>
<td>mmcblk0p62</td>
<td>cache</td>
<td>262144</td>
<td>256M</td>
<td>ext4
</td>
</tr>
<tr>
<td>mmcblk0p63</td>
<td>system</td>
<td>3670016</td>
<td>3584M</td>
<td>ext4
</td>
</tr>
<tr>
<td>mmcblk0p64</td>
<td>vendor</td>
<td>2097152</td>
<td>2048M</td>
<td>ext4
</td>
</tr>
<tr>
<td>mmcblk0p65</td>
<td>cust</td>
<td>851968</td>
<td>832M</td>
<td>ext4
</td>
</tr>
<tr>
<td>mmcblk0p66</td>
<td>userdata</td>
<td>22802415</td>
<td>21.7G</td>
<td>encrypted (dm-0)
</td>
</tr>
<tr>
<td>mmcblk0rpmb</td>
<td></td>
<td>4096</td>
<td>
</td>
</tr>
</tbody>
</table>
</div>
</div>
<h3>
<span id="Android_Verified_Boot_(vbmeta)"></span><span class="mw-headline" id="Android_Verified_Boot_.28vbmeta.29">Android Verified Boot (vbmeta)</span>
</h3>
<p>This device is using <a href="../en/Android_Verified_Boot_(AVB).html" title="Android Verified Boot (AVB)">Android_Verified_Boot_(AVB)</a> so, if you did not flash any custom Android ROM, you may need to flash <code>vbmeta</code> partition with <code>vbmeta.img</code> with verification disabled flag. pmbootstrap now can generate such empty vbmeta image and flash it with one command:
</p>
<pre>$ pmbootstrap flasher flash_vbmeta
</pre>
<h3><span class="mw-headline" id="DTBO_partition">DTBO partition</span></h3>
<p>This device is using a dedicated partition to store the <a href="../en/Device_Tree_(dtb).html" title="Device Tree (dtb)">Device Tree Blob</a> Overlay. Read more at <a rel="nofollow" class="external free" href="https://source.android.com/devices/architecture/dto/partitions">https://source.android.com/devices/architecture/dto/partitions</a> . 
</p>
<p>Update: looks like <b>dtbo</b> partition is not used during boot by LineageOS's kernel, because it is using appended DTB (<code>CONFIG_BUILD_ARM64_APPENDED_DTB_IMAGE=y</code>)
</p>
<p>Update2: device tree from dtbo partition is used by bootloader to apply some fixups on top of appended dtb. Bootloader tries to apply overlay dtb from dtbo partition over a dtb found appended to kernel, and if it fails to do so, it falls back into fastboot mode. Example bootloader debug UART output in that case:
</p>
<pre>Memory Base Address: 0x40000000
Decompressing kernel image start: 2700 ms
Decompressing kernel image done: 2852 ms
ufdt apply overlay failed
Launching fastboot
</pre>
<p>See also Zhuowei's notes on creating custom dtbo partition: <a rel="nofollow" class="external free" href="https://gitlab.com/zhuowei/dtbo-google-crosshatch-mainline">https://gitlab.com/zhuowei/dtbo-google-crosshatch-mainline</a>
</p>
<p>For mainline kernel just <code>fastboot erase dtbo</code> works. Bootloader ignores missing dtbo, example output when dtbo partition is erased:
</p>
<pre>Memory Base Address: 0x40000000
Decompressing kernel image start: 2641 ms
Decompressing kernel image done: 2793 ms
Dtbo hdr magic mismatch 0, with D7B7AB1E
Best match DTB tags 317/00020008/0x00000000/0/1001B/102001A/0/0/(offset)0x97128304/(size)0x00000653
Using pmic info 0x1001B/0x102001A/0x0/0x0 for device 0x2001B/0x102001A/0x0/0x0
Memory Base Address: 0x40000000
smem protocol = 9C2FA0A0
board_id1 is 1
 board_id2 is 1
 board_id3 is 0
board_id is 1
get_boardid_from_smem,SUCCESS ,board_id=0x102,cpu_id=0x39148C8C,hwdefined=0
 PON Reason is 17 cold_boot:1 charger path: 1
...(proceeding to normal boot procedure)...
</pre>
<p>For downstream kernel, leave stock dtbo partition untouched.
</p>
<h3><span class="mw-headline" id="Bootloader_cmdline">Bootloader cmdline</span></h3>
<p>Stock bootloader is doing nasty things with kernel command line: it passes a lot of arguments that make booting custom OS (like postmarketOS) impossible
</p>
<div class="toccolours mw-collapsible mw-collapsed" style="width: 620px; overflow: auto;">
<p>Full list of stock command line parameters:
</p>
<div class="mw-collapsible-content">
<pre>ramoops_memreserve=4M

rcupdate.rcu_expedited=1
console=ttyMSM0,115200,n8
androidboot.console=ttyMSM0
earlycon=msm_serial_dm,0xc170000
androidboot.hardware=qcom
user_debug=31
msm_rtb.filter=0x37
ehci-hcd.park=3
lpm_levels.sleep_disabled=1
sched_enable_hmp=1
sched_enable_power_aware=1
service_locator.enable=1
swiotlb=1
firmware_class.path=/vendor/firmware_mnt/image
loop.max_part=7
androidboot.selinux=permissive
buildvariant=eng

androidboot.verifiedbootstate=orange
androidboot.keymaster=1
root=PARTUUID=2a7f6d6d-1c23-febe-7efb-9ccfa1432ace
androidboot.bootdevice=c0c4000.sdhci
androidboot.serialno=ac1dde4e
androidboot.cpuid=0x39148c8c
androidboot.dp=0x0
androidboot.baseband=sdm
mdss_mdp.panel=1:dsi:0:qcom,mdss_dsi_nt36672a_tianma_fhdplus_video:config0:1:none:cfg:single_dsi
skip_initramfs
rootwait
ro
init=/init
androidboot.dtbo_idx=0
androidboot.fpsensor=fpc
androidboot.secureboot=1
androidboot.hwc=Global
androidboot.hwversion=1.29.0
androidboot.hwlevel=MP
androidboot.hwdevice=lavender
</pre>
</div>
</div>
<p><code>ramoops_memreserve=4M</code> comes from defconfig, next from boot.img, others (starting with first <code>androidboot.</code> and below) come from bootloader directly.
</p>
<h4><span class="mw-headline" id="Harmful_kernel_command_line_params_from_bootloader">Harmful kernel command line params from bootloader</span></h4>
<p>Options like <code>root=</code>, <code>skip_initramfs</code> make kernel look for a specific partition to mount at /, skipping initramfs, which is incompatible with default booting methods of postmarketOS. That's why some tricky patches are needed like by opendata26: <a rel="nofollow" class="external text" href="https://gitlab.com/opendata26/linux/commit/40095e9a8b1eb32ad7ccd705c8990792e692ba1d">init: ignore bootloader cmdline params for mounts</a>
</p>
<p>Some info on <code>skip_initramfs</code> kernel cmdline parameter: <a rel="nofollow" class="external free" href="https://forum.xda-developers.com/apps/magisk/pixel-2-pixel-2-xl-support-t3697427/post74361728#post74361728">https://forum.xda-developers.com/apps/magisk/pixel-2-pixel-2-xl-support-t3697427/post74361728#post74361728</a>
</p>
<h3><span class="mw-headline" id="Way_to_get_boot_log">Way to get boot log</span></h3>
<p>This device known to ship with the <code>oem getlog</code> fastboot command.
</p>
<p>This is not a trivial command to use, but it is extremely useful as it allows side-stepping the need to boot in a known working system to use the ramoops
console. The output of the command is a jumble, but is still usable for figuring out early boot issues. It is much better than having to rely on a booted system to
get the information, but still not as good as having a dedicated serial access.
</p>
<p>Example usage follows.
</p>
<p><br>
</p>
<pre>$ fastboot oem getlog 2&gt;&amp;1
(bootloader) [    0.000000] Booting Linux on physical CPU 0x0
[    0.000
(bootloader) 000] Initializing cgroup subsys cpuset
[    0.000000] Initi
(bootloader) alizing cgroup subsys cpu
[    0.000000] Initializing cgrou
(bootloader) p subsys cpuacct
[    0.000000] Initializing cgroup subsys
(bootloader) schedtune
[    0.000000] Linux version 4.4.153 (nixbld@loca
(bootloader) lhost) (gcc version 4.9.4 (GCC) ) #2 SMP PREEMPT Sat Nov 23
(bootloader)  20:31:33 UTC 2019
[    0.000000] Boot CPU: AArch64 Process
(bootloader) or [51af8014]
[...]
</pre>
<p><br>
As the output of the command is on stderr, here's how to output to a file.
</p>
<p><br>
</p>
<pre>$ fastboot oem getlog &gt; log.txt 2&gt;&amp;1
</pre>
<p><br>
It is unknown if there are ways to make the output better. (Apply some kind error correction algorithm?)
</p>
<p>EDIT: seems to not work for me, whatever you do, the output is:
</p>
<pre>$ fastboot oem getlog
                                                  (bootloader) [Macle]Maybe no last kmsg
OKAY [  0.000s]
Finished. Total time: 0.000s
</pre>
<p>Probably needs a crash? But I can read pstore-console (dmesg) logs from booted TWRP recovery fine..
</p>
<div class="thumb tright"><div class="thumbinner" style="width:202px;">
<a href="../Xiaomi-lavender-uart-pins.jpg" class="image"><img alt="" src="../Xiaomi-lavender-uart-pins.jpg" decoding="async" width="200" height="118" class="thumbimage" srcset="../300px-Xiaomi-lavender-uart-pins.jpg 1.5x ../400px-Xiaomi-lavender-uart-pins.jpg 2x"></a>  <div class="thumbcaption">
<div class="magnify"><a href="../Xiaomi-lavender-uart-pins.jpg" class="internal" title="Enlarge"></a></div>Xiaomi Redmi Note 7 (lavender) UART test pins schematic</div>
</div></div>
<div class="thumb tright"><div class="thumbinner" style="width:202px;">
<a href="../Xiaomi-lavender-uart-pins-real-photo.jpg" class="image"><img alt="" src="../Xiaomi-lavender-uart-pins-real-photo.jpg" decoding="async" width="200" height="203" class="thumbimage" srcset="../300px-Xiaomi-lavender-uart-pins-real-photo.jpg 1.5x ../400px-Xiaomi-lavender-uart-pins-real-photo.jpg 2x"></a>  <div class="thumbcaption">
<div class="magnify"><a href="../Xiaomi-lavender-uart-pins-real-photo.jpg" class="internal" title="Enlarge"></a></div>Xiaomi Redmi Note 7 (lavender) UART test pins photo</div>
</div></div>
<h3><span class="mw-headline" id="Getting_logs_through_debug_UART">Getting logs through debug UART</span></h3>
<p>You have to disassemble the phone (just removing back cover is enough). You'll have to heat up edges of the back cover (as shown in disassembling video, see <b>Links</b> below) before trying to remove it. Be careful! It is made of glass! Also be careful about fingerprint sensor connector, it is connected to a back cover you are trying to remove. Don't rip it.
</p>
<p>In the center you will see 4 test points that are available. (See the picture) Two bigger ones (0.8mm) are <b>EDL</b> (FORCE_USB_BOOT) pins. UART test points are two smaller ones on the left (0.5mm). TP11 is <b>UART TX</b> (gpio 4), TP10 is <b>UART RX</b> (gpio 5). GND is that whole metal shielding, that covers the center of the board. So, to get debug logs from UART it is enough to connect UART TX from the board to RX pin on the converter, and connect GND between phone and GND pin on the converter.
</p>
<h2><span class="mw-headline" id="Links">Links</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/1095">pmaports!1095</a> Initial merge request</li>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/tree/master/device/testing/device-xiaomi-lavender">Device package</a></li>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/tree/master/device/testing/linux-xiaomi-lavender">Kernel package</a></li>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/tree/master/main/linux-postmarketos-qcom-sdm660">Mainline kernel package</a></li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues/494">pmaports#494</a> How to make Wi-Fi work?</li>
<li><a rel="nofollow" class="external text" href="https://github.com/sdm660-mainline/linux/tree/sdm660-next-stable">Current mainline kernel development branch</a></li>
<li><a href="../en/Xiaomi_Redmi_Note_7_(xiaomi-lavender)_Mainline_development.html" title="Xiaomi Redmi Note 7 (xiaomi-lavender)/Mainline development">Mainline development BLOG</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/NixOS/mobile-nixos/pull/28">NixOS-mobile lavender MR</a></li>
<li>
<a rel="nofollow" class="external free" href="https://www.youtube.com/watch?v=6GqXqW2Nygc">https://www.youtube.com/watch?v=6GqXqW2Nygc</a> Disassembling video (Rus)</li>
<li><a rel="nofollow" class="external free" href="https://www.anandtech.com/show/11338/qualcomm-announces-snapdragon-660-630-mobile-platforms">https://www.anandtech.com/show/11338/qualcomm-announces-snapdragon-660-630-mobile-platforms</a></li>
<li>List of mobile phones on SDM660 SoC: <a rel="nofollow" class="external text" href="https://www.kimovil.com/en/list-smartphones-by-processor/qualcomm-snapdragon-660-msm8976-plus">1</a>, <a rel="nofollow" class="external text" href="https://www.gsmarena.com/results.php3?nRamMin=2000&amp;sFreeText=sdm660">2</a>
</li>
</ul>
</div></div>
		
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Devices.html" title="Category:Devices">Devices</a></li>
<li><a href="../en/Category:Devices_with_known_UART_pinout.html" title="Category:Devices with known UART pinout">Devices with known UART pinout</a></li>
</ul>
</div></div>
		<div class="visualClear"></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=Xiaomi_Redmi_Note_7_(xiaomi-lavender)&amp;oldid=27579">https://wiki.postmarketos.org/index.php?title=Xiaomi_Redmi_Note_7_(xiaomi-lavender)&amp;oldid=27579</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 7 May 2022, at 20:03.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../en/About_postmarketOS.html" class="mw-redirect" title="PostmarketOS:About">About postmarketOS</a></li>
								<li id="footer-places-disclaimer"><a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-mobileview"><a href="https://wiki.postmarketos.org/index.php?title=Xiaomi_Redmi_Note_7_(xiaomi-lavender)&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="../poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="" width="88" height="31"></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

</body>
</html>
