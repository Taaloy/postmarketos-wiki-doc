<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Submitting Patches - postmarketOS</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.34.2">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="postmarketOS (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Submitting_Patches rootpage-Submitting_Patches skin-vector action-view">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">Submitting Patches</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From postmarketOS</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div id="toc" class="toc">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2>Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1">
<a href="#Submitting_Patches_.28to_various_upstream_projects.29"><span class="tocnumber">1</span> <span class="toctext">Submitting Patches (to various upstream projects)</span></a>
<ul>
<li class="toclevel-2 tocsection-2">
<a href="#Linux"><span class="tocnumber">1.1</span> <span class="toctext">Linux</span></a>
<ul>
<li class="toclevel-3 tocsection-3"><a href="#Configuring_git_send-email"><span class="tocnumber">1.1.1</span> <span class="toctext">Configuring git send-email</span></a></li>
<li class="toclevel-3 tocsection-4"><a href="#Sending_patches"><span class="tocnumber">1.1.2</span> <span class="toctext">Sending patches</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-5"><a href="#See_also"><span class="tocnumber">1.2</span> <span class="toctext">See also</span></a></li>
</ul>
</li>
</ul>
</div>

<h1>
<span id="Submitting_Patches_(to_various_upstream_projects)"></span><span class="mw-headline" id="Submitting_Patches_.28to_various_upstream_projects.29">Submitting Patches (to various upstream projects)</span>
</h1>
<h2><span class="mw-headline" id="Linux">Linux</span></h2>
<p>The Linux kernel traditionally uses the "git send-email" workflow for patch submission, once you have some commits you want included, you email them as git "patches" to the mailing list and any relevant maintainers.
This can be a bit of a daunting task, there are many guides out there explaining how to do this, but they usually miss bits out or do a poor job of explaining how <code>git send-email</code> actually works.
</p>
<h3><span class="mw-headline" id="Configuring_git_send-email">Configuring git send-email</span></h3>
<p>This is pretty well documented elsewhere, notably <a rel="nofollow" class="external text" href="https://www.freedesktop.org/wiki/Software/PulseAudio/HowToUseGitSendEmail/">in the freedesktop pulseaudio docs</a> and here: <a rel="nofollow" class="external free" href="https://burzalodowa.wordpress.com/2013/10/05/how-to-send-patches-with-git-send-email/">https://burzalodowa.wordpress.com/2013/10/05/how-to-send-patches-with-git-send-email/</a>
</p>
<h3><span class="mw-headline" id="Sending_patches">Sending patches</span></h3>
<p>This is the process I <a href="../User:Kalube.html" title="User:Kalube">Caleb</a> use, it's by no means perfect, I'd suggest you take it and modify it to suite your needs.
</p>
<p>Once you have your commit(s) ready, format them as patches so we can run them through checkpatch and get_maintainer:
</p>
<pre>$ git log --oneline # note down the hash of the first commit in your series, e.g:

9f0cfbc330a2 arm64: dts: qcom: sdm845-oneplus-common: add nodes for q6voice apr service
aa209f22271d arm64: dts: xiaomi-beryllium-common: Add nodes for q6voice apr service
0fe8a293245b arm64: dts: qcom: sdm845: Add q6voice APR service device nodes # &lt;-- this is the first commit
</pre>
<p>Now generate a bunch of .patch files using <code>git format-patches</code>
</p>
<pre>$ git format-patch 0fe8a293245b^ # &lt;-- the caret '^' tells git to include the referenced commit, without it only the top 2 commits would be used
0001-arm64-dts-qcom-sdm845-Add-q6voice-APR-service-device.patch
0002-arm64-dts-xiaomi-beryllium-common-Add-nodes-for-q6vo.patch
0003-arm64-dts-qcom-sdm845-oneplus-common-add-nodes-for-q.patch
</pre>
<p>You can also use relative commit reference instead of full commit SHA, like <code>git format-patch HEAD~3</code> to generate patches for 3 last commits. This way you don't need to know the exact hashes of commits.
</p>
<p>We can now run checkpatch to make sure our patches pass the checks, if you forget this maintainers will point it out and have you re-do it.
</p>
<pre>$ ./scripts/checkpatch.pl *.patch
</pre>
<p>If you have errors, fix them, create a fixup commit for whichever patch(es) you had to fix (e.g. <code>git commit --fixup aa209f22271d</code>) and then squash the series again with <code>git rebase -i 0fe8a293245b^</code>, and start again from the top of this section.
</p>
<p>Once checkpatch is happy, you can use get_maintainer.pl to find a list of emails to send your patch to, I have a handy bash function for this which formats the output so it can be directly appended to <code>git send-email</code>, you might want to add it to your .bashrc or wherever else...
</p>
<pre>gencclist () {
	echo "$(./scripts/get_maintainer.pl --nogit --nogit-fallback --norolestats --r "$@" | xargs -I {} echo --to=\"{}\" | tr '\n' ' ')"
}
</pre>
<p>Now we can simply run:
</p>
<pre>$ gencclist *.patch
--to="Some Maintainer &lt;someone@kernel.org&gt;" --to="linux-arm-msm@vger.kernel.org" --to="devicetree@vger.kernel.org" --to="linux-kernel@vger.kernel.org"
</pre>
<p>Finally, we're ready to send our patches, it's worth noting that the .patch files we generated are not used for this, instead git send-email produces the patches directly, it will format them properly for the kernel, including the patch version if necessary.
</p>
<pre>$ git send-email 0fe8a293245b^ --to="Some Maintainer &lt;someone@kernel.org&gt;" --to="linux-arm-msm@vger.kernel.org" --to="devicetree@vger.kernel.org" --to="linux-kernel@vger.kernel.org"
/tmp/EvaxiVuPLX/0001-arm64-dts-qcom-sdm845-Add-q6voice-APR-service-device.patch
/tmp/EvaxiVuPLX/0002-arm64-dts-xiaomi-beryllium-common-Add-nodes-for-q6vo.patch
/tmp/EvaxiVuPLX/0003-arm64-dts-qcom-sdm845-oneplus-common-add-nodes-for-q.patch
</pre>
<p>Or <code>git send-email &lt;...params...&gt; *.patch</code>
</p>
<p>You can also use <code>git send-email --to-cmd=./scripts/get_maintainer.pl ..</code> to automatically use its results in <code>--to</code> arguments.
</p>
<p>If you're sending a series and would like to include a cover letter, add the <code>--annotate --cover-letter</code> arguments to git send-email. This will automatically generate a shortlog and a diffstat for the series. I'd recommend writing your cover letter separately and pasting it in to avoid potentially losing data.
</p>
<p>Dont forget to add <code>--cc="~postmarketos/upstreaming@lists.sr.ht"</code> and <code>--cc="phone-devel@vger.kernel.org"</code> for phone related patches.
</p>
<p>To send a new version of your patches (e.g. a version 2), add <code>-v2</code>, this works for all versions, e.g. <code>-v5</code>.
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a rel="nofollow" class="external free" href="https://www.kernel.org/doc/Documentation/devicetree/bindings/submitting-patches.txt">https://www.kernel.org/doc/Documentation/devicetree/bindings/submitting-patches.txt</a></li></ul>
</div></div>
		
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
		<div class="visualClear"></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=Submitting_Patches&amp;oldid=28162">https://wiki.postmarketos.org/index.php?title=Submitting_Patches&amp;oldid=28162</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 2 June 2022, at 16:56.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../en/About_postmarketOS.html" class="mw-redirect" title="PostmarketOS:About">About postmarketOS</a></li>
								<li id="footer-places-disclaimer"><a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-mobileview"><a href="https://wiki.postmarketos.org/index.php?title=Submitting_Patches&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="../poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="" width="88" height="31"></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

</body>
</html>
