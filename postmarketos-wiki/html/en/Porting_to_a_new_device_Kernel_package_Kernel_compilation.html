<!DOCTYPE html>
<html class="client-nojs vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-sticky-header-disabled vector-feature-page-tools-pinned-disabled vector-feature-toc-pinned-clientpref-1 vector-feature-main-menu-pinned-disabled vector-feature-limited-width-clientpref-1 vector-feature-limited-width-content-enabled vector-feature-custom-font-size-clientpref-0 vector-feature-appearance-pinned-clientpref-1 vector-feature-night-mode-disabled skin-theme-clientpref-day vector-toc-available" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Porting to a new device/Kernel package/Kernel compilation - postmarketOS Wiki</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.43.1">
<meta name="robots" content="max-image-preview:standard">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="search" type="application/opensearchdescription+xml" href="/rest.php/v1/search" title="postmarketOS Wiki (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Wiki Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin--responsive skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Porting_to_a_new_device_Kernel_package_Kernel_compilation rootpage-Porting_to_a_new_device_Kernel_package_Kernel_compilation skin-vector-2022 action-view">
<a class="mw-jump-link" href="#bodyContent">Jump to content</a>
<div class="vector-header-container">
	<header class="vector-header mw-header">
		<div class="vector-header-start">
			<nav class="vector-main-menu-landmark" aria-label="Site">
				
<div id="vector-main-menu-dropdown" class="vector-dropdown vector-main-menu-dropdown vector-button-flush-left vector-button-flush-right">
	<input type="checkbox" id="vector-main-menu-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-main-menu-dropdown" class="vector-dropdown-checkbox " aria-label="Main menu">
	<label id="vector-main-menu-dropdown-label" for="vector-main-menu-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-menu mw-ui-icon-wikimedia-menu"></span>

<span class="vector-dropdown-label-text">Main menu</span>
	</label>
	<div class="vector-dropdown-content">


				<div id="vector-main-menu-unpinned-container" class="vector-unpinned-container">
		
<div id="vector-main-menu" class="vector-main-menu vector-pinnable-element">
	<div class="vector-pinnable-header vector-main-menu-pinnable-header vector-pinnable-header-unpinned" data-feature-name="main-menu-pinned" data-pinnable-element-id="vector-main-menu" data-pinned-container-id="vector-main-menu-pinned-container" data-unpinned-container-id="vector-main-menu-unpinned-container">
	<div class="vector-pinnable-header-label">Main menu</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-main-menu.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-main-menu.unpin">hide</button>
</div>

	
<div id="p-navigation" class="vector-menu mw-portlet mw-portlet-navigation">
	<div class="vector-menu-heading">
		Navigation
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-mainpage-description" class="mw-list-item"><a href="../en/Main_Page.html" title="Visit the main page [z]" accesskey="z"><span>Main page</span></a></li>
<li id="n-Devices" class="mw-list-item"><a href="../en/Devices.html"><span>Devices</span></a></li>
		</ul>
		
	</div>
</div>

	
	
</div>

				</div>

	</div>
</div>

		</nav>
			
<a href="../en/Main_Page.html" class="mw-logo">
	<img class="mw-logo-icon" src="/logo_50x50.svg" alt="" aria-hidden="true" height="50" width="50">
	<span class="mw-logo-container skin-invert">
		<strong class="mw-logo-wordmark">postmarketOS Wiki</strong>
	</span>
</a>

		</div>
		<div class="vector-header-end">
			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-collapses vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<a href="../Special:Search.html" class="cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only search-toggle" title="Search postmarketOS Wiki [f]" accesskey="f"><span class="vector-icon mw-ui-icon-search mw-ui-icon-wikimedia-search"></span>

<span>Search</span>
	</a>
	<div class="vector-typeahead-search-container">
		<div class="cdx-typeahead-search cdx-typeahead-search--show-thumbnail cdx-typeahead-search--auto-expand-width">
			<form action="/index.php" id="searchform" class="cdx-search-input cdx-search-input--has-end-button">
				<div id="simpleSearch" class="cdx-search-input__input-wrapper" data-search-loc="header-moved">
					<div class="cdx-text-input cdx-text-input--has-start-icon">
						<input class="cdx-text-input__input" type="search" name="search" placeholder="Search postmarketOS Wiki" aria-label="Search postmarketOS Wiki" autocapitalize="sentences" title="Search postmarketOS Wiki [f]" accesskey="f" id="searchInput">
						<span class="cdx-text-input__icon cdx-text-input__start-icon"></span>
					</div>
					<input type="hidden" name="title" value="Special:Search">
				</div>
				<button class="cdx-button cdx-search-input__end-button">Search</button>
			</form>
		</div>
	</div>
</div>

			<nav class="vector-user-links vector-user-links-wide" aria-label="Personal tools">
	<div class="vector-user-links-main">
	
<div id="p-vector-user-menu-preferences" class="vector-menu mw-portlet emptyPortlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-userpage" class="vector-menu mw-portlet emptyPortlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	<nav class="vector-appearance-landmark" aria-label="Appearance">
		
<div id="vector-appearance-dropdown" class="vector-dropdown " title="Change the appearance of the page's font size, width, and color">
	<input type="checkbox" id="vector-appearance-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-appearance-dropdown" class="vector-dropdown-checkbox " aria-label="Appearance">
	<label id="vector-appearance-dropdown-label" for="vector-appearance-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-appearance mw-ui-icon-wikimedia-appearance"></span>

<span class="vector-dropdown-label-text">Appearance</span>
	</label>
	<div class="vector-dropdown-content">


			<div id="vector-appearance-unpinned-container" class="vector-unpinned-container">
				
			</div>
		
	</div>
</div>

	</nav>
	
<div id="p-vector-user-menu-notifications" class="vector-menu mw-portlet emptyPortlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

	
<div id="p-vector-user-menu-overflow" class="vector-menu mw-portlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			<li id="pt-login-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item">
<a data-mw="interface" href="/index.php?title=Special:UserLogin&amp;returnto=Porting+to+a+new+device%2FKernel+package%2FKernel+compilation" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o" class=""><span>Log in</span></a>
</li>
<li id="pt-createaccount-2" class="user-links-collapsible-item mw-list-item user-links-collapsible-item">
<a data-mw="interface" href="../Special:RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory" class=""><span>Request account</span></a>
</li>

			
		</ul>
		
	</div>
</div>

	</div>
	
<div id="vector-user-links-dropdown" class="vector-dropdown vector-user-menu vector-button-flush-right vector-user-menu-logged-out user-links-collapsible-item" title="More options">
	<input type="checkbox" id="vector-user-links-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-user-links-dropdown" class="vector-dropdown-checkbox " aria-label="Personal tools">
	<label id="vector-user-links-dropdown-label" for="vector-user-links-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-ellipsis mw-ui-icon-wikimedia-ellipsis"></span>

<span class="vector-dropdown-label-text">Personal tools</span>
	</label>
	<div class="vector-dropdown-content">


		
<div id="p-personal" class="vector-menu mw-portlet mw-portlet-personal user-links-collapsible-item" title="User menu">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="pt-login" class="user-links-collapsible-item mw-list-item"><a href="/index.php?title=Special:UserLogin&amp;returnto=Porting+to+a+new+device%2FKernel+package%2FKernel+compilation" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span class="vector-icon mw-ui-icon-logIn mw-ui-icon-wikimedia-logIn"></span> <span>Log in</span></a></li>
<li id="pt-createaccount" class="user-links-collapsible-item mw-list-item"><a href="../Special:RequestAccount.html" title="You are encouraged to create an account and log in; however, it is not mandatory"><span>Request account</span></a></li>
		</ul>
		
	</div>
</div>

	
	</div>
</div>

</nav>

		</div>
	</header>
</div>
<div class="mw-page-container">
	<div class="mw-page-container-inner">
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<div class="vector-column-start">
			<div class="vector-main-menu-container">
		</div>
	<div class="vector-sticky-pinned-container">
				<nav id="mw-panel-toc" aria-label="Contents" data-event-name="ui.sidebar-toc" class="mw-table-of-contents-container vector-toc-landmark">
					<div id="vector-toc-pinned-container" class="vector-pinned-container">
					<div id="vector-toc" class="vector-toc vector-pinnable-element">
	<div class="vector-pinnable-header vector-toc-pinnable-header vector-pinnable-header-pinned" data-feature-name="toc-pinned" data-pinnable-element-id="vector-toc">
	<h2 class="vector-pinnable-header-label">Contents</h2>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-toc.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-toc.unpin">hide</button>
</div>


	<ul class="vector-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="vector-toc-list-item vector-toc-level-1">
			<a href="#" class="vector-toc-link">
				<div class="vector-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-Find_the_error_message" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Find_the_error_message">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">1</span>
				<span>Find the error message</span>
			</div>
		</a>
		
		<ul id="toc-Find_the_error_message-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Get_a_patch" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Get_a_patch">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">2</span>
				<span>Get a patch</span>
			</div>
		</a>
		
			<button aria-controls="toc-Get_a_patch-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Get a patch subsection</span>
			</button>
		
		<ul id="toc-Get_a_patch-sublist" class="vector-toc-list">
			<li id="toc-From_postmarketOS_aports" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#From_postmarketOS_aports">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.1</span>
					<span>From postmarketOS aports</span>
				</div>
			</a>
			
			<ul id="toc-From_postmarketOS_aports-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-From_elsewhere" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#From_elsewhere">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">2.2</span>
					<span>From elsewhere</span>
				</div>
			</a>
			
			<ul id="toc-From_elsewhere-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
	<li id="toc-Removing_python2_dependency" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Removing_python2_dependency">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">3</span>
				<span>Removing python2 dependency</span>
			</div>
		</a>
		
		<ul id="toc-Removing_python2_dependency-sublist" class="vector-toc-list">
		</ul>
	</li>
	<li id="toc-Changing_compiler" class="vector-toc-list-item vector-toc-level-1 vector-toc-list-item-expanded">
		<a class="vector-toc-link" href="#Changing_compiler">
			<div class="vector-toc-text">
				<span class="vector-toc-numb">4</span>
				<span>Changing compiler</span>
			</div>
		</a>
		
			<button aria-controls="toc-Changing_compiler-sublist" class="cdx-button cdx-button--weight-quiet cdx-button--icon-only vector-toc-toggle">
				<span class="vector-icon mw-ui-icon-wikimedia-expand"></span>
				<span>Toggle Changing compiler subsection</span>
			</button>
		
		<ul id="toc-Changing_compiler-sublist" class="vector-toc-list">
			<li id="toc-Using_GCC6" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_GCC6">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.1</span>
					<span>Using GCC6</span>
				</div>
			</a>
			
			<ul id="toc-Using_GCC6-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Using_GCC4" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_GCC4">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.2</span>
					<span>Using GCC4</span>
				</div>
			</a>
			
			<ul id="toc-Using_GCC4-sublist" class="vector-toc-list">
			</ul>
		</li>
		<li id="toc-Using_Clang" class="vector-toc-list-item vector-toc-level-2">
			<a class="vector-toc-link" href="#Using_Clang">
				<div class="vector-toc-text">
					<span class="vector-toc-numb">4.3</span>
					<span>Using Clang</span>
				</div>
			</a>
			
			<ul id="toc-Using_Clang-sublist" class="vector-toc-list">
			</ul>
		</li>
	</ul>
	</li>
</ul>
</div>

					</div>
		</nav>
			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" style="margin: 0">
				<header class="mw-body-header vector-page-titlebar">
					<nav aria-label="Contents" class="vector-toc-landmark">
						
<div id="vector-page-titlebar-toc" class="vector-dropdown vector-page-titlebar-toc vector-button-flush-left">
	<input type="checkbox" id="vector-page-titlebar-toc-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-titlebar-toc" class="vector-dropdown-checkbox " aria-label="Toggle the table of contents">
	<label id="vector-page-titlebar-toc-label" for="vector-page-titlebar-toc-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet cdx-button--icon-only " aria-hidden="true"><span class="vector-icon mw-ui-icon-listBullet mw-ui-icon-wikimedia-listBullet"></span>

<span class="vector-dropdown-label-text">Toggle the table of contents</span>
	</label>
	<div class="vector-dropdown-content">


							<div id="vector-page-titlebar-toc-unpinned-container" class="vector-unpinned-container">
			</div>
		
	</div>
</div>

					</nav>
					<h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Porting to a new device/Kernel package/Kernel compilation</span></h1>
				</header>
				<div class="vector-page-toolbar">
					<div class="vector-page-toolbar-container">
						<div id="left-navigation">
							<nav aria-label="Namespaces">
								
<div id="p-associated-pages" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-associated-pages">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-nstab-main" class="selected vector-tab-noicon mw-list-item"><a href="../en/Porting_to_a_new_device_Kernel_package_Kernel_compilation.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new vector-tab-noicon mw-list-item"><a href="/index.php?title=Talk:Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;action=edit&amp;redlink=1" rel="discussion" class="new" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
		</ul>
		
	</div>
</div>

								
<div id="vector-variants-dropdown" class="vector-dropdown emptyPortlet">
	<input type="checkbox" id="vector-variants-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-variants-dropdown" class="vector-dropdown-checkbox " aria-label="Change language variant">
	<label id="vector-variants-dropdown-label" for="vector-variants-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"><span class="vector-dropdown-label-text">English</span>
	</label>
	<div class="vector-dropdown-content">


					
<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			
		</ul>
		
	</div>
</div>

				
	</div>
</div>

							</nav>
						</div>
						<div id="right-navigation" class="vector-collapsible">
							<nav aria-label="Views">
								
<div id="p-views" class="vector-menu vector-menu-tabs mw-portlet mw-portlet-views">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-view" class="selected vector-tab-noicon mw-list-item"><a href="../en/Porting_to_a_new_device_Kernel_package_Kernel_compilation.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="vector-tab-noicon mw-list-item"><a href="/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="vector-tab-noicon mw-list-item"><a href="/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
		</ul>
		
	</div>
</div>

							</nav>
				
							<nav class="vector-page-tools-landmark" aria-label="Page tools">
								
<div id="vector-page-tools-dropdown" class="vector-dropdown vector-page-tools-dropdown">
	<input type="checkbox" id="vector-page-tools-dropdown-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-vector-page-tools-dropdown" class="vector-dropdown-checkbox " aria-label="Tools">
	<label id="vector-page-tools-dropdown-label" for="vector-page-tools-dropdown-checkbox" class="vector-dropdown-label cdx-button cdx-button--fake-button cdx-button--fake-button--enabled cdx-button--weight-quiet" aria-hidden="true"><span class="vector-dropdown-label-text">Tools</span>
	</label>
	<div class="vector-dropdown-content">


									<div id="vector-page-tools-unpinned-container" class="vector-unpinned-container">
						
<div id="vector-page-tools" class="vector-page-tools vector-pinnable-element">
	<div class="vector-pinnable-header vector-page-tools-pinnable-header vector-pinnable-header-unpinned" data-feature-name="page-tools-pinned" data-pinnable-element-id="vector-page-tools" data-pinned-container-id="vector-page-tools-pinned-container" data-unpinned-container-id="vector-page-tools-unpinned-container">
	<div class="vector-pinnable-header-label">Tools</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-page-tools.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-page-tools.unpin">hide</button>
</div>

	
<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions vector-has-collapsible-items" title="More options">
	<div class="vector-menu-heading">
		Actions
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Porting_to_a_new_device_Kernel_package_Kernel_compilation.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;action=history"><span>View history</span></a></li>
<li id="ca-cargo-purge" class="mw-list-item"><a href="/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;action=purge"><span>Purge cache</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-tb" class="vector-menu mw-portlet mw-portlet-tb">
	<div class="vector-menu-heading">
		General
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="t-whatlinkshere" class="mw-list-item"><a href="../Special:WhatLinksHere_Porting_to_a_new_device_Kernel_package_Kernel_compilation.html" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li>
<li id="t-recentchangeslinked" class="mw-list-item"><a href="../Special:RecentChangesLinked_Porting_to_a_new_device_Kernel_package_Kernel_compilation.html" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li>
<li id="t-specialpages" class="mw-list-item"><a href="../Special:SpecialPages.html" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li>
<li id="t-print" class="mw-list-item"><a href="javascript:print();" rel="alternate" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li>
<li id="t-permalink" class="mw-list-item"><a href="/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;oldid=74929" title="Permanent link to this revision of this page"><span>Permanent link</span></a></li>
<li id="t-info" class="mw-list-item"><a href="/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;action=info" title="More information about this page"><span>Page information</span></a></li>
<li id="t-cargopagevalueslink" class="mw-list-item"><a href="/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;action=pagevalues" rel="cargo-pagevalues"><span>Cargo data</span></a></li>
		</ul>
		
	</div>
</div>

<div id="p-The_usual_wiki_links" class="vector-menu mw-portlet mw-portlet-The_usual_wiki_links">
	<div class="vector-menu-heading">
		The usual wiki links
	</div>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
			
			<li id="n-Editor's-Guide" class="mw-list-item"><a href="../en/Help:Wiki_editor's_guide.html"><span>Editor's Guide</span></a></li>
<li id="n-recentchanges" class="mw-list-item"><a href="../Special:RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li>
<li id="n-randompage" class="mw-list-item"><a href="../Special:Random.html" title="Load a random page [x]" accesskey="x"><span>Random page</span></a></li>
<li id="n-Templates" class="mw-list-item"><a href="../en/PostmarketOS:Templates.html"><span>Templates</span></a></li>
		</ul>
		
	</div>
</div>

</div>

									</div>
				
	</div>
</div>

							</nav>
						</div>
					</div>
				</div>
				<div class="vector-column-end">
					<div class="vector-sticky-pinned-container">
						<nav class="vector-page-tools-landmark" aria-label="Page tools">
							<div id="vector-page-tools-pinned-container" class="vector-pinned-container">
				
							</div>
		</nav>
						<nav class="vector-appearance-landmark" aria-label="Appearance">
							<div id="vector-appearance-pinned-container" class="vector-pinned-container">
				<div id="vector-appearance" class="vector-appearance vector-pinnable-element">
	<div class="vector-pinnable-header vector-appearance-pinnable-header vector-pinnable-header-pinned" data-feature-name="appearance-pinned" data-pinnable-element-id="vector-appearance" data-pinned-container-id="vector-appearance-pinned-container" data-unpinned-container-id="vector-appearance-unpinned-container">
	<div class="vector-pinnable-header-label">Appearance</div>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-pin-button" data-event-name="pinnable-header.vector-appearance.pin">move to sidebar</button>
	<button class="vector-pinnable-header-toggle-button vector-pinnable-header-unpin-button" data-event-name="pinnable-header.vector-appearance.unpin">hide</button>
</div>


</div>

							</div>
		</nav>
					</div>
				</div>
				<div id="bodyContent" class="vector-body" aria-labelledby="firstHeading" data-mw-ve-target-container>
					<div class="vector-body-before-content">
							<div class="mw-indicators">
		</div>

						<div id="siteSub" class="noprint">From postmarketOS Wiki</div>
					</div>
					<div id="contentSub"><div id="mw-content-subtitle"></div></div>
					
					
					<div id="mw-content-text" class="mw-body-content">
<div class="mw-content-ltr mw-parser-output" lang="en" dir="ltr">
<div class="navigation" style="text-align:center;">
<span typeof="mw:File"><a href="../en/Porting_to_a_new_device_Kernel_package.html" title="Porting to a new device/Kernel package"><img src="../Icon-numix-light-media-playback-start-rtl-symbolic.svg" decoding="async" width="25" height="25" class="mw-file-element"></a></span> <a href="../en/Porting_to_a_new_device_Kernel_package.html" title="Porting to a new device/Kernel package">Kernel package</a>
  | <a href="../en/Porting_to_a_new_device_Device_specific_package.html" title="Porting to a new device/Device specific package">Device specific package</a> <span typeof="mw:File"><a href="../en/Porting_to_a_new_device_Device_specific_package.html" title="Porting to a new device/Device specific package"><img src="../Icon-numix-light-media-playback-start-symbolic.svg" decoding="async" width="25" height="25" class="mw-file-element"></a></span>
</div>
<div class="navigation" style="text-align:center;">
<span typeof="mw:File"><a href="../en/Porting_to_a_new_device_Kernel_package_Kernel_configuration.html" title="Porting to a new device/Kernel package/Kernel configuration"><img src="../Icon-numix-light-media-playback-start-rtl-symbolic.svg" decoding="async" width="25" height="25" class="mw-file-element"></a></span> <a href="../en/Porting_to_a_new_device_Kernel_package_Kernel_configuration.html" title="Porting to a new device/Kernel package/Kernel configuration">Kernel configuration</a>
</div>
<p>Next up is the kernel compilation, which will fail a few times before you get it working. Run it once to see where it fails.
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$ </span>pmbootstrap<span class="w"> </span>build<span class="w"> </span>linux-wiki-example
</pre></div>
<p>We most likely use a more modern version of GCC compared to what your device kernel was intended to be compiled with (which is good, we don't want outdated software). However, this means that you will probably need to patch your kernel before it compiles successfully. Don't be scared, we'll talk you through it. But in the unlikely case that everything runs through smoothly, continue reading <a href="#Device_specific_package">here</a>.
</p>
<meta property="mw:PageProp/toc">
<h2><span class="mw-headline" id="Find_the_error_message">Find the error message</span></h2>
<table role="text container" class="box-note" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center; line-height: 1;"><span style="white-space: nowrap;"><span typeof="mw:File"><span title="Note"><img alt="Note" src="../Reference_icon.svg" decoding="async" width="20" height="20" class="mw-file-element"></span></span></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">Tip: you can use <code>pmbootstrap log</code> to check the log quickly.</td>
</tr></tbody></table>
<p>To find the error message, you should open a log file in your favorite text editor, like
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$ </span>nano<span class="w"> </span><span class="k">$(</span>pmbootstrap<span class="w"> </span>config<span class="w"> </span>work<span class="k">)</span>/log.txt
</pre></div>
<p>and use search to find error messages for the last build run (they contain <code>error:</code> or <code>Error</code> word). 
</p>
<p>Examples of errors:
</p>
<pre>In file included from arch/arm/mach-msm/perf_trace_counters.h:127:0,
                 from arch/arm/mach-msm/perf_trace_counters.c:14:
include/trace/define_trace.h:79:43: fatal error: ./perf_trace_counters.h: No such file or directory
</pre>
<pre>drivers/built-in.o: In function `.LANCHOR1':
msm_iommu_sec.c:(.data+0x9298): undefined reference to `kgsl_iommu_sync_lock'
msm_iommu_sec.c:(.data+0x929c): undefined reference to `kgsl_iommu_sync_unlock'
Makefile:877: recipe for target '.tmp_vmlinux1' failed
make: *** [.tmp_vmlinux1] Error 1
</pre>
<p>It is possible to clear the log file right before compilation when you press <span class="nowrap button-tmpl" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">ctrl</span> + <span class="nowrap button-tmpl" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">c</span> in the log window and use <code>log -c</code>:
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp gp-VirtualEnv">(old log output here)</span>
<span class="go">^C</span>
<span class="gp">$ </span>pmbootstrap<span class="w"> </span>log<span class="w"> </span>-c
</pre></div>
<p>Another trick to find the error message real quick is to open <code>log.txt</code> with <code>less</code> and use the follow mode (press <span class="nowrap button-tmpl" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">F</span> while in <code>less</code> or open less with the <code>+F</code> option: <code>less +F log.txt</code>). This causes <code>less</code> to behave like <code>tail -f</code>. When an error occurs, you can exit the follow mode by pressing <span class="nowrap button-tmpl" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">ctrl</span> + <span class="nowrap button-tmpl" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">c</span> and use <span class="nowrap button-tmpl" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">?</span> to reverse search the output (for example: <code>?error</code>). Press <span class="nowrap button-tmpl" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">F</span> to re-enable follow mode.
</p>
<h2><span class="mw-headline" id="Get_a_patch">Get a patch</span></h2>
<h3><span class="mw-headline" id="From_postmarketOS_aports">From postmarketOS aports</span></h3>
<p>It is highly likely that we already ran into the same issue with another kernel. Take (parts of) the offending file name and search for it inside <code>pmaports/device</code>.
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$ </span>grep<span class="w"> </span>-r<span class="w"> </span><span class="s1">'perf_trace_counters\.c'</span><span class="w"> </span>pmaports/device/
<span class="go">pmaports/device/testing/linux-lg-mako/01_msm-fix-perf_trace_counters.patch:In-tree compilation for arch/arm/mach-msm/perf_trace_counters.c was</span>
<span class="go">pmaports/device/testing/linux-lg-mako/01_msm-fix-perf_trace_counters.patch:                     from arch/arm/mach-msm/perf_trace_counters.c:14</span>
<span class="gp">$ </span>grep<span class="w"> </span>-r<span class="w"> </span><span class="s1">'msm_iommu_sec'</span><span class="w"> </span>pmaports/device/
<span class="go">pmaports/device/testing/linux-lg-mako/02_gpu-msm-fix-gcc5-compile.patch:msm_iommu_sec.c:(.data+0x9298): undefined reference to `kgsl_iommu_sync_lock'</span>
<span class="go">pmaports/device/testing/linux-lg-mako/02_gpu-msm-fix-gcc5-compile.patch:msm_iommu_sec.c:(.data+0x929c): undefined reference to `kgsl_iommu_sync_unlock'</span>
</pre></div>
<p>When there is a result, copy the patch file you found to your new kernel package, add it to the <code>source</code> variable in the <code>APKBUILD</code> and try building again.
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$ </span>cp<span class="w"> </span>pmaports/device/testing/linux-lg-mako/01_msm-fix-perf_trace_counters.patch<span class="w"> </span>pmaports/device/testing/linux-wiki-example/
<span class="gp">$ </span>nano<span class="w"> </span>pmaports/device/testing/linux-wiki-example/APKBUILD<span class="w"> </span><span class="c1"># add it to source</span>
<span class="gp">$ </span>pmbootstrap<span class="w"> </span>checksum<span class="w"> </span>linux-wiki-example
<span class="gp">$ </span>pmbootstrap<span class="w"> </span>build<span class="w"> </span>linux-wiki-example
</pre></div>
<h3><span class="mw-headline" id="From_elsewhere">From elsewhere</span></h3>
<p>Fire up your favorite search engine and look at all results for the error message and variations of it. The <code>""</code> feature of most search engines is useful, so it searches for an exact string and not single words. Example queries for the error messages above:
</p>
<ul>
<li><code>include/trace/define_trace.h: fatal error: ./perf_trace_counters.h: "No such file or directory"</code></li>
<li><code>linux "./perf_trace_counters.h: No such file or directory"</code></li>
<li><code>android "undefined reference to `kgsl_iommu_sync_unlock'"</code></li>
</ul>
<p>In most cases, this will yield a patch that you can apply to your kernel. Save what you have found as a patch file right next to the <code>APKBUILD</code> of your new kernel package. Mailing list posts are usually in the format of a patch file and can be used directly, while commits or pull requests (PRs) on GitHub can be downloaded as patch when you append <code>.patch</code> to the URL (e.g. <a rel="nofollow" class="external text" href="https://github.com/ShinySide/HispAsian_Lollipop_G6/commit/b7756b6fc4bb728722b14d2dfdbaf1dc843812e9">commit</a>, <a rel="nofollow" class="external text" href="https://github.com/ShinySide/HispAsian_Lollipop_G6/commit/b7756b6fc4bb728722b14d2dfdbaf1dc843812e9.patch">patch</a>).
</p>
<p>If what you found on the web can't be used as patch file directly (e.g. sometimes the files are in other folders), but you understood how you would need to patch the source (from the search results or simply because you already knew), please follow <a href="../en/Patching.html" class="mw-redirect" title="How to create a patch when packaging software">this guide</a>.
</p>
<p>Patch files can contain arbitrary text before the first line with <code>---</code> in the file. Please use this space to link to the source where you found a patch (in case it is from the Internet) and to paste the error message, that your patch fixes (so it is easier to find for other people).
</p>
<p>After creating the patch file and adding the source URL and error message, put the file name into <code>source</code> in your <code>APKBUILD</code> and give it another shot.
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$ </span>nano<span class="w"> </span>pmaports/device/testing/linux-wiki-example/03_description-here.patch
<span class="gp">$ </span>nano<span class="w"> </span>pmaports/device/testing/linux-wiki-example/APKBUILD
<span class="gp">$ </span>pmbootstrap<span class="w"> </span>checksum<span class="w"> </span>linux-wiki-example
<span class="gp">$ </span>pmbootstrap<span class="w"> </span>build<span class="w"> </span>linux-wiki-example
</pre></div>
<p>We can't promise anything, but you shouldn't need to do this more than 2 times or so before the kernel build finally goes through.
</p>
<h2><span class="mw-headline" id="Removing_python2_dependency">Removing python2 dependency</span></h2>
<p>In some downstream kernels, weird python scripts are running as part of the build process. This is especially problematic for python2 scripts, as python2 has been removed in Alpine 3.16 (postmarketOS v22.06). So if your kernel build fails with an error message mentioning that "python2" was not found, here are some tips to get rid of the dependency:
</p>
<ul>
<li>If the python2 program is mediatek's drvgen: this is for generating a "cust.dtsi" file. Just include the the "cust.dtsi" file it would generate and don't call drvgen during the build. You can obtain the file by checking out the v21.12 branch of pmaports.git, adding your kernel package there, adding python2 to makedepends temporarily in the APKBUILD and starting the build. Once it got past the part where it would stop with the python2 error, the cust.dtsi file should be available. Create a patch that adds it and disables drvgen, search pmaports.git master for drvgen to find similar patches.</li>
<li>If the python2 program is mkdtimg (or mkdtboimg), you should be able to use the python3 version -add it to makedepends- we have packaged in android-tools "android-mkdtboimg previously" instead. Use "git grep" to find similar patches, e.g. <code>device/unmaintained/linux-xiaomi-cepheus-downstream/0005-Use-real-mkdtimg-don-t-use-python2-one.patch</code>.</li>
</ul>
<h2><span class="mw-headline" id="Changing_compiler">Changing compiler</span></h2>
<h3><span class="mw-headline" id="Using_GCC6">Using GCC6</span></h3>
<p>If you can't make your kernel compile or boot with the latest GCC from Alpine, you can also try to <a href="../en/Downstream_kernel_specific_package.html#Use_GCC_6" class="mw-redirect" title="Vendor kernel specific package">use GCC6 instead</a>.
</p>
<h3><span class="mw-headline" id="Using_GCC4">Using GCC4</span></h3>
<p>As GCC4 was recently introduced in postmarketOS repos, you can follow the procedure for GCC6 above and replace all gcc6 occurrences with gcc4 and add gcc4 gcc4-(armv7/armhf/...) to your list of dependencies.
</p>
<h3><span class="mw-headline" id="Using_Clang">Using Clang</span></h3>
<p>To use Clang as compiler you have to do the following in kernel package's APKBUILD:
</p>
<ul>
<li>Add <code>clang</code> to <code>makedepends</code>
</li>
<li>Add these lines:</li>
</ul>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">CC</span><span class="o">=</span><span class="s2">"clang"</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">HOSTCC</span><span class="o">=</span><span class="s2">"clang"</span>
</pre></div>
<p><a rel="nofollow" class="external text" href="https://gitlab.postmarketos.org/postmarketOS/pmaports/-/blob/master/device/testing/linux-motorola-def/APKBUILD?ref_type=heads#L19">Example</a>
</p>
<p>If older version of Clang is needed, check if it is available in Alpine Linux package repositories: <a rel="nofollow" class="external free" href="https://pkgs.alpinelinux.org/packages?name=clang%3F%3F&amp;branch=edge&amp;arch=">https://pkgs.alpinelinux.org/packages?name=clang%3F%3F&amp;branch=edge&amp;arch=</a>
</p>
<p>E.g. to use <code>clang20</code>, add it to <code>makedepends</code> and set <code>CC</code> and <code>HOSTCC</code>:
</p>
<div class="mw-highlight mw-highlight-lang-bash mw-content-ltr" dir="ltr"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">CC</span><span class="o">=</span><span class="s2">"clang-20"</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">HOSTCC</span><span class="o">=</span><span class="s2">"clang-20"</span>
</pre></div>
<div class="navigation" style="text-align:center;">
<span typeof="mw:File"><a href="../en/Porting_to_a_new_device_Kernel_package.html" title="Porting to a new device/Kernel package"><img src="../Icon-numix-light-media-playback-start-rtl-symbolic.svg" decoding="async" width="25" height="25" class="mw-file-element"></a></span> <a href="../en/Porting_to_a_new_device_Kernel_package.html" title="Porting to a new device/Kernel package">Kernel package</a>
  | <a href="../en/Porting_to_a_new_device_Device_specific_package.html" title="Porting to a new device/Device specific package">Device specific package</a> <span typeof="mw:File"><a href="../en/Porting_to_a_new_device_Device_specific_package.html" title="Porting to a new device/Device specific package"><img src="../Icon-numix-light-media-playback-start-symbolic.svg" decoding="async" width="25" height="25" class="mw-file-element"></a></span>
</div>
<div class="navigation" style="text-align:center;">
<span typeof="mw:File"><a href="../en/Porting_to_a_new_device_Kernel_package_Kernel_configuration.html" title="Porting to a new device/Kernel package/Kernel configuration"><img src="../Icon-numix-light-media-playback-start-rtl-symbolic.svg" decoding="async" width="25" height="25" class="mw-file-element"></a></span> <a href="../en/Porting_to_a_new_device_Kernel_package_Kernel_configuration.html" title="Porting to a new device/Kernel package/Kernel configuration">Kernel configuration</a>
</div>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Guide.html" title="Category:Guide">Guide</a></li></ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;oldid=74929">https://wiki.postmarketos.org/index.php?title=Porting_to_a_new_device/Kernel_package/Kernel_compilation&amp;oldid=74929</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 5 May 2025, at 21:25.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/About_postmarketOS.html">About postmarketOS Wiki</a></li>
	<li id="footer-places-disclaimers"><a href="../en/PostmarketOS:General_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://creativecommons.org/licenses/by-sa/4.0/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/" class="cdx-button cdx-button--fake-button cdx-button--size-large cdx-button--fake-button--enabled"><img src="../poweredby_mediawiki.svg" alt="Powered by MediaWiki" width="88" height="31" loading="lazy"></a></li>
</ul>

</footer>

		</div>
	</div> 
</div> 
<div class="vector-settings" id="p-dock-bottom">
	<ul></ul>
</div>
</body>
</html>
