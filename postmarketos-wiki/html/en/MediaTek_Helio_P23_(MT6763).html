<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>MediaTek Helio P23 (MT6763) - postmarketOS</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.34.2">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="postmarketOS (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-MediaTek_Helio_P23_MT6763 rootpage-MediaTek_Helio_P23_MT6763 skin-vector action-view">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">MediaTek Helio P23 (MT6763)</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From postmarketOS</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">MediaTek Helio P23</caption>
<tbody>
<tr class=""><td colspan="2" class="" style="text-align:center;">
<a href="../MediaTek-Helio-P23.png" class="image"><img alt="" src="../MediaTek-Helio-P23.png" decoding="async" width="200" height="200" srcset="../300px-MediaTek-Helio-P23.png 1.5x ../400px-MediaTek-Helio-P23.png 2x"></a>
</td></tr>
<tr class="">
<th scope="row" style="text-align:left;">Manufacturer</th>
    <td class="" style="">
MediaTek</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Name</th>
    <td class="" style="">
Helio P23</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Codenames</th>
    <td class="" style="">
mt6763/mt6763t/mt6763v</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Architecture</th>
    <td class="" style="">
aarch64</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">CPU</th>
    <td class="" style="">
8x 2.0 GHz Cortex-A53</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPU</th>
    <td class="" style="">
ARM Mali-G71 MP2 (Bifrost) @ 770 MHz</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Year</th>
    <td class="" style="">
2017</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Process</th>
    <td class="" style="">
16nm</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Mainline</th>
    <td class="" style="">
no</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="A link to a git{hub,lab} organisation/repo where development happens">Community Page</abbr></th>
    <td class="" style="">
<a rel="nofollow" class="external free" href="https://gitlab.com/mtk-mainline/mt6763/linux">https://gitlab.com/mtk-mainline/mt6763/linux</a>
</td>
</tr>
<tr><th colspan="2" class="" style="text-align:center;">Components</th></tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="SMP (bring up secondary CPU cores), CPU frequency scaling, CPUidle">CPU</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">UART</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="eMMC, SD cards, UFS, ...">Storage</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">USB</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Display</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPU</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Pinctrl</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">IÂ²C</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Serial Peripheral Interface">SPI</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Audio</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Hardware-accelerated video de/encoding">Video</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Thermal</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">WiFi</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Bluetooth</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Calls, SMS, Internet">Modem</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPS</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Camera</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Suspend</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<p><br>
</p>
<p><a rel="nofollow" class="external text" href="https://www.mediatek.com/products/smartphones-2/mediatek-helio-p23">MT6763</a> (or Helio P23) is a mid-range ARMv8.0-A (64-bit) MediaTek SoC released in 2017.
</p>
<h2><span class="mw-headline" id="Devices">Devices</span></h2>
<h3>
<span id="Helio_P23_(MT6763V)"></span><span class="mw-headline" id="Helio_P23_.28MT6763V.29">Helio P23 (MT6763V)</span>
</h3>
<table class="cargoTable noMerge sortable">
<thead><tr>
<th class="field_Device">Device</th>
<th class="field_Codename">Codename</th>
<th class="field_Mainline">Mainline</th>
</tr></thead>
<tbody>
<tr>
<td class="field_Device"><a href="../en/Volla_Phone_(volla-yggdrasil).html" title="Volla Phone (volla-yggdrasil)">Volla Phone</a></td>
<td class="field_Codename">volla-yggdrasil</td>
<td class="field_Mainline">Y</td>
</tr>
</tbody>
</table>
<h2><span class="mw-headline" id="Mainline_fork">Mainline fork</span></h2>
<p>There is a <a rel="nofollow" class="external text" href="https://gitlab.com/mtk-mainline/mt6763/linux">mainline kernel fork on GitLab @ mtk-mainline/mt6763/linux</a> where development is currently (2022-11-14 / <a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/log/?h=v6.1-rc5"><code>v6.1-rc5</code></a>) active.
</p>
<h2><span class="mw-headline" id="Booting">Booting</span></h2>
<p>Currently this SoC can only boot with <code>maxcpus=1</code> present in kernel cmdline; enabling SMP causes kernel panic and a huge amount of log spam.
</p>
<h2><span class="mw-headline" id="Early_bringup">Early bringup</span></h2>
<p>At the very start of MediaTek SoC mainline bringup to minimize variables you should boot with a <a href="../en/MediaTek_Helio_P23_(MT6763).html#Minimal_.config" title="MediaTek Helio P23 (MT6763)">minimal .config</a> with either <a href="../en/MediaTek_Helio_P23_(MT6763).html#UART" title="MediaTek Helio P23 (MT6763)">UART</a> or <a href="../en/MediaTek_Helio_P23_(MT6763).html#simplefb_earlycon" title="MediaTek Helio P23 (MT6763)">simplefb earlycon</a> setup and use a downstream DTB + DTBO combo, and yes you heard me right. This way we can find exactly what nodes the bootloader looks for (or needs to display things / have working buttons for fastboot etc. navigation before kernel loads) by the process of elimination by chunks of device tree nodes at a time from the known working downstream DTBs.
</p>
<table role="text container" style="color: inherit; background-color: #fdd1d1; border: 1px solid #b60000; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Icon" src="../Red_warning_icon.svg" decoding="async" title="Icon" width="20" height="20" srcset="../Red_warning_icon.svg 1.5x ../Red_warning_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">
<b>TODO:</b> Document this process more thoroughly, it mostly consists of running <code>make dtbs</code> in downstream source, using the DTB with mainline, tweaking and repeating</td>
</tr></tbody></table>
<h2><span class="mw-headline" id="DTBO">DTBO</span></h2>
<p>If your device has a <code>dtbo</code> partition like <a href="../en/Volla_Phone_(volla-yggdrasil).html#Partition_layout" title="Volla Phone (volla-yggdrasil)">the Volla Phone (volla-yggdrasil)</a> you'll have to figure out the bare minimum DTBO contents required to boot mainline with minimal DTS changes which typically consists of grabbing at least the <code>gpio_init_default</code> from the decompiled downstream <code>/sys/firmware/fdt</code> flattened DTB and making <a href="../en/Volla_Phone_(volla-yggdrasil)_Hacking.html#Minimal_mainline_DTBO" title="Volla Phone (volla-yggdrasil)/Hacking">a minimal DTBO for usage with mainline</a>.
</p>
<p>To figure out the bare minimum DTBO contents follow a similar process to <a href="../en/MediaTek_Helio_P23_(MT6763).html#Early_bringup" title="MediaTek Helio P23 (MT6763)">the early bringup steps</a> but instead with the DTB that eventually gets used for <code>mkdtboimg</code> to create the flashable <code>dtbo.img</code>.
</p>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">
<b>NOTE:</b> You should take a backup of the <code>dtbo</code> partition contents with e.g. <a rel="nofollow" class="external text" href="https://github.com/bkerler/mtkclient">mtkclient</a> so you can flash it back quickly when wanting to boot downstream <code>boot.img</code>s again!</td>
</tr></tbody></table>
<h2><span class="mw-headline" id="Reserved_memory">Reserved memory</span></h2>
<p>All <code>mblock-*</code> entries in downstream FDT <code>/reserved-memory</code> are automagically added by the bootloader and <b>SHOULD NOT</b> be reserved again in mainline DTS to avoid conflicting with the bootloader adding them.
</p>
<p>As an example <code>mblock-6-framebuffer</code> @ <code>0x7dca0000</code> is ready to use for <a href="../en/MediaTek_Helio_P23_(MT6763).html#simplefb_earlycon" title="MediaTek Helio P23 (MT6763)">simplefb earlycon</a> already!
</p>
<h2><span class="mw-headline" id="UART">UART</span></h2>
<p>UART output from the kernel can be enabled by setting <a rel="nofollow" class="external text" href="https://cateee.net/lkddb/web-lkddb/SERIAL_8250_MT6577.html">CONFIG_SERIAL_8250_MT6577=y</a> in your config and including <code>earlycon=mtk8250,0x11002000 console=ttyS0,921600n1</code> on the cmdline.
</p>
<h2><span class="mw-headline" id="Minimal_.config">Minimal .config</span></h2>
<p>A minimal kernel config you should get <i>some</i> output over UART with starts with a <code>make allnoconfig</code> and setting the following (via e.g. <code>make menuconfig</code>):
</p>
<pre>CONFIG_ARCH_MEDIATEK=y
CONFIG_SERIAL_8250=y
CONFIG_SERIAL_8250_CONSOLE=y
CONFIG_SERIAL_8250_MT6577=y
CONFIG_SERIAL_OF_PLATFORM=y
</pre>
<h2><span class="mw-headline" id="simplefb_earlycon">simplefb earlycon</span></h2>
<p>No UART? No problem (probably)! With <a rel="nofollow" class="external text" href="https://github.com/Kiciuk/linux/commit/40db7f372fb46fb207b66e77e34b8e2fb177f00f">a currently (2022-07-24) out-of-tree driver</a> from <a href="../User:Nergzd723.html" title="User:Nergzd723">Nergzd723</a> you can get very early logging from the kernel directly on the display framebuffer!
</p>
<p>One change to the driver is required however, that patch sets the <code>color_white</code> alpha to 0 essentially making the text invisible:
</p>
<pre>--- a/drivers/video/fbdev/earlycon.c
+++ b/drivers/video/fbdev/earlycon.c
@@ -107,7 +107,7 @@ static void simplefb_earlycon_scroll_up(void)
 static void simplefb_earlycon_write_char(u32 *dst, unsigned char c, unsigned int h)
 {
 	const u32 color_black = 0x00000000;
-	const u32 color_white = 0x00ffffff; // a8r8g8b8
+	const u32 color_white = 0xffffffff; // a8r8g8b8
 	const u8 *src;
 	int m, n, bytes;
 	u8 x;
</pre>
<p>Next simply enable the driver in your .config (along with the ones from <a href="../en/MediaTek_Helio_P23_(MT6763).html#Minimal_.config" title="MediaTek Helio P23 (MT6763)">MediaTek_Helio_P23_(MT6763)#Minimal .config</a> section just above):
</p>
<pre>CONFIG_FB_EARLY=y
</pre>
<p>Then just add <code>earlycon=simplefb,0x7dca0000,&lt;width&gt;,&lt;height&gt; console=simplefb</code> to your cmdline where <code>&lt;width&gt;</code> and <code>&lt;height&gt;</code> match your display resolution width and height respectively.
</p>
<p>In case of Volla Phone (with display resolution of 1080x2340) this still resulted in garbled output on the display, try adding or subtracting from the width if this happens. The final <code>earlycon</code> value that worked was <code>simplefb,0x7dca0000,1088,2340</code>, so simply adding 8 to the width made it work as expected.
</p>
<h2><span class="mw-headline" id="Minimal_DTS">Minimal DTS</span></h2>
<p>Minimal "booting" devicetree (excluding potential DTBO requirements) should look something like this:
</p>
<pre>/dts-v1/;

/ {
	/* NOTE: if /model is defined the bootloader replaces it with "MT6763*" forcefully */

	chosen {
		/* /chosen/bootargs has to exist even if unused or bootloader will be unhappy */
		bootargs = "";
	};

	/* /reserved-memory has to exist even if practically empty or bootloader will be unhappy */
	reserved-memory {
		#address-cells = &lt;2&gt;;
		#size-cells = &lt;2&gt;;
		ranges;
	};
};
</pre>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">
<b>NOTE:</b> Some downstream nodes such as <code>kp@10010000</code> (along with select properties) might have to be added as well for the bootloader mode selection menu for example to work as expected!</td>
</tr></tbody></table>
<h2><span class="mw-headline" id="Mainline_workflow">Mainline workflow</span></h2>
<p>With UART hooked up simply plugging in USB as well powers on the device automatically. By pairing this with <a rel="nofollow" class="external text" href="https://github.com/bkerler/mtkclient">flashing using mtkclient</a> you easily at any point after flashing power off the device by just unplugging the USB cable, and reboot it by plugging it in again.
</p>
<p>To power off without flashing anything you can run e.g. <code>mtk printgpt</code> and unplug the device after successful execution of the command.
</p>
<p>Letting the ATF (ARM Trusted Firmware) watchdog still strategically reboot the device automatically ~10 seconds after booting can also be helpful with the quick flash, test and repeat cycle while getting all the logs you'd want over UART; you can add <code>initcall_blacklist=mtk_wdt_driver_init</code> (<code>CONFIG_MEDIATEK_WATCHDOG=y</code>) or <code>modprobe.blacklist=mtk_wdt</code> (<code>CONFIG_MEDIATEK_WATCHDOG=m</code>) to cmdline to prevent loading the watchdog driver.
</p>
<h2><span class="mw-headline" id="Pending_patches">Pending patches</span></h2>
<ol>
<li>MediaTek Helio P23 (MT6763) SoC uses the MT6370 PMIC which there is a <a rel="nofollow" class="external text" href="https://patchwork.kernel.org/project/linux-mediatek/list/?series=662193">pending patch series for on the linux-mediatek mailing list</a> that seems to include plenty of great functionality (yet to be tested on MT6763), <code>CONFIG_MFD_MT6370</code> available in v6.1-rc1</li>
<li>
<a rel="nofollow" class="external text" href="https://git.kernel.org/pub/scm/linux/kernel/git/next/linux-next.git/commit/?id=327e93cf9a59b0d04eb3a31a7fdbf0f11cf13ecb">CPUXGPT timer patch, now in linux-next</a> (might not actually be relevant? needs further confirmation)</li>
</ol>
<h2><span class="mw-headline" id="Relevant_downstream_sources">Relevant downstream sources</span></h2>
<p><a rel="nofollow" class="external text" href="https://github.com/JamiKettunen/android_kernel_volla_mt6763/blob/android-9.0/arch/arm64/boot/dts/mediatek/mt6356.dtsi">MT6356 PMIC dtsi for regulators</a>
</p>
<p><a rel="nofollow" class="external text" href="https://github.com/JamiKettunen/android_kernel_volla_mt6763/blob/android-9.0/drivers/misc/mediatek/pmic/mt6356/v1/mt6356_gauge.c">MT6356 PMIC battery fuel gauge driver</a>
</p>
<h2>
<span id="Who's_working_on_it"></span><span class="mw-headline" id="Who.27s_working_on_it">Who's working on it</span>
</h2>
<ul>
<li><a href="../User:Deathmist.html" title="User:Deathmist">User:Deathmist</a></li>
<li><a href="../User:Cvbnm90i.html" title="User:Cvbnm90i">User:Cvbnm90i</a></li>
<li><a href="../User:Eriki73.html" title="User:Eriki73">User:eriki73</a></li>
</ul>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li><a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/tree/master/device/testing/linux-postmarketos-mediatek-mt6763">Kernel package</a></li></ul>
</div></div>
		
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Socs.html" title="Category:Socs">Socs</a></li>
<li><a href="../en/Category:Todo_Items.html" title="Category:Todo Items">Todo Items</a></li>
</ul>
</div></div>
		<div class="visualClear"></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=MediaTek_Helio_P23_(MT6763)&amp;oldid=40374">https://wiki.postmarketos.org/index.php?title=MediaTek_Helio_P23_(MT6763)&amp;oldid=40374</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 23 April 2023, at 10:10.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../en/About_postmarketOS.html" class="mw-redirect" title="PostmarketOS:About">About postmarketOS</a></li>
								<li id="footer-places-disclaimer"><a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-mobileview"><a href="https://wiki.postmarketos.org/index.php?title=MediaTek_Helio_P23_(MT6763)&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="../poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="" width="88" height="31"></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

</body>
</html>
