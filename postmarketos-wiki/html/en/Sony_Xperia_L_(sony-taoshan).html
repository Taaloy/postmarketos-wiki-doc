<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Sony Xperia L (sony-taoshan) - postmarketOS</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.34.2">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="postmarketOS (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Sony_Xperia_L_sony-taoshan rootpage-Sony_Xperia_L_sony-taoshan skin-vector action-view">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">Sony Xperia L (sony-taoshan)</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From postmarketOS</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">This device is still running on armhf, although the processor supports armv7. If you own it, change it and test it <a rel="nofollow" class="external text" href="https://wiki.postmarketos.org/wiki/Tips_and_tricks#Update_the_architecture_of_your_device">that</a> way.</td>
</tr></tbody></table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Sony Xperia L</caption>
<tbody>
<tr class=""><td colspan="2" class="" style="text-align:center;">
<a href="../Sony-Taoshan.jpg" class="image"><img alt="Replacement image" src="../Sony-Taoshan.jpg" decoding="async" width="200" height="104" srcset="../300px-Sony-Taoshan.jpg 1.5x ../400px-Sony-Taoshan.jpg 2x"></a><br><span style="">Replacement image</span>
</td></tr>
<tr class="">
<th scope="row" style="text-align:left;">Manufacturer</th>
    <td class="" style="">
Sony</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Name</th>
    <td class="" style="">
Xperia L</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Codename</th>
    <td class="" style="">
sony-taoshan</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Released</th>
    <td class="" style="">
2013</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Category</th>
    <td class="" style="">
testing</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Original software</th>
    <td class="" style="">
4.1.2/4.2.2</td>
</tr>
<tr><th colspan="2" class="" style="text-align:center;">Hardware</th></tr>
<tr class="">
<th scope="row" style="text-align:left;">Chipset</th>
    <td class="" style="">
Qualcomm MSM8230 Snapdragon S4 Plus</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">CPU</th>
    <td class="" style="">
1 GHz Dual-Core Krait</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPU</th>
    <td class="" style="">
Adreno 305</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Display</th>
    <td class="" style="">
480x854</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Storage</th>
    <td class="" style="">
8 GiB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Memory</th>
    <td class="" style="">
1 GiB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Architecture</th>
    <td class="" style="">
armv7</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Features</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="After connecting the device with USB to your PC, you can connect to it via telnet (initramfs) or SSH (booted system).">USB Networking</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="It is possible to flash the device with `pmbootstrap flasher`.">Flashing</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Touchscreen</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Display works. Ideally with sleep mode and brightness control.">Display</abbr></th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">WiFi</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Full disk encryption and unlocking with osk-sdl.">FDE</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Instead of a Linux kernel fork, it is possible to run mainline.">Mainline</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Charging and battery level reporting works">Battery</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">3D Acceleration</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Audio playback, microphone, headset and buttons.">Audio</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Bluetooth</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Camera</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPS</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Mobile data</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">SMS</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Calls</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">USB OTG</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">NFC</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Sensors</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Auto screen rotation works in desktops e.g. Phosh or Plasma Mobile">Accelerometer</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Magnetometer</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ambient Light</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Proximity</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Used as flip cover sensor, keyboard slide out sensor, etc.">Hall Effect</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Misc</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;">Ir TX</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">TrustZone</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<p><br>
</p>
<p><br>
</p>
<h2><span class="mw-headline" id="Contributors">Contributors</span></h2>
<ul>
<li><a href="../User:Halamix2.html" title="User:Halamix2">Halamix2</a></li>
<li><a href="../User:Powimod.html" title="User:Powimod">Powimod</a></li>
</ul>
<h2>
<span id="Maintainer(s)"></span><span class="mw-headline" id="Maintainer.28s.29">Maintainer(s)</span>
</h2>
<ul>
<li><a href="../User:Halamix2.html" title="User:Halamix2">Halamix2</a></li>
<li><a href="../User:Powimod.html" title="User:Powimod">Powimod</a></li>
</ul>
<h2><span class="mw-headline" id="Users_owning_this_device">Users owning this device</span></h2>
<div style="-webkit-column-count: 2; -moz-column-count: 2; column-count: 2;"><ul style="margin-top: 0;">
<li>
<a href="../User:Halamix2.html" title="User:Halamix2">Halamix2</a> (<span class="cargoFieldName">Notes:</span> broken screen, I'm not working on that device anymore, could offer some help)</li>
<li><a href="../User:Powimod.html" title="User:Powimod">Powimod</a></li>
</ul></div>
<p><br>
</p>
<h2><span class="mw-headline" id="What_works">What works</span></h2>
<ul>
<li>Device boots</li>
<li>Weston works</li>
<li>SSH connections are possible.</li>
</ul>
<h2><span class="mw-headline" id="How_to_enter_flash_mode">How to enter flash mode</span></h2>
<p>From LineageOS wiki: With the device powered off, hold Volume Up and connect the USB cable. The notification light should turn blue.
</p>
<h2><span class="mw-headline" id="Current_work">Current work</span></h2>
<h3><span class="mw-headline" id="Kernel_compilation">Kernel compilation</span></h3>
<p>The kernel used comes from Lineage OS. The kernel version is <b>3.4.0</b>.
</p>
<p>The <i>android_device_sony_taoshan</i> github repository contains a file named <i>lineage.dependencies</i> witch indicates the name of the kernel used : <i>android_kernel_sony_msm8930</i>.
</p>
<ul>
<li><a rel="nofollow" class="external text" href="https://github.com/LineageOS/android_device_sony_taoshan">XPeria L Github repository</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/LineageOS/android_kernel_sony_msm8930">kernel Github repository</a></li>
<li><a rel="nofollow" class="external text" href="https://raw.githubusercontent.com/LineageOS/android_kernel_sony_msm8930/cm-14.1/arch/arm/configs/taoshan_defconfig">Taoshan kernel configuration file on msm8930 Github repository</a></li>
</ul>
<p>To satisfy pmbootstrap kernel config checking : 
</p>
<ul>
<li>disable <i>CONFIG_ANDROID_PARANOID_NETWORK</i> option</li>
<li>enable <i>CONFIG_DEVTMPFS</i> option</li>
<li>enable <i>CONFIG_SYSVIPC</i> option</li>
</ul>
<p>The patch [<a rel="nofollow" class="external text" href="https://github.com/postmarketOS/pmbootstrap/blob/master/aports/device/linux-lg-mako/02_gpu-msm-fix-gcc5-compile.patch">gpu-msm-fix-gcc5-compile.patch</a>] is necessary to fix the following error : <i>undefined reference to kgsl_iommu_sync_lock</i>.
</p>
<p>The screen resolution must be updated in the <code>device-sony-taoshan/deviceinfo</code> file : 
</p>
<pre>deviceinfo_screen_width="854"
deviceinfo_screen_height="480"
</pre>
<h4><span class="mw-headline" id="XZ_compression_error">XZ compression error</span></h4>
<p>By default, the kernel compilation (<code>pmbootstrap build linux-sony-taoshan</code>) fails with the following error in the log : 
</p>
<pre>  AS      arch/arm/boot/compressed/ashldi3.o
/home/pmos/build/src/android_kernel_sony_msm8930-df6292bc628cece5925d0f67fbc8c8a2cab2d524/scripts/xz_wrap.sh: exec: line 23: xz: not found
make[2]: *** [/home/pmos/build/src/android_kernel_sony_msm8930-df6292bc628cece5925d0f67fbc8c8a2cab2d524/arch/arm/boot/compressed/Makefile:190: arch/arm/boot/compressed/piggy.xzkern] Error 1
make[2]: *** Waiting for unfinished jobs....
make[1]: *** [/home/pmos/build/src/android_kernel_sony_msm8930-df6292bc628cece5925d0f67fbc8c8a2cab2d524/arch/arm/boot/Makefile:52: arch/arm/boot/compressed/vmlinux] Error 2
make: *** [/home/pmos/build/src/android_kernel_sony_msm8930-df6292bc628cece5925d0f67fbc8c8a2cab2d524/arch/arm/Makefile:292: zImage] Error 2
&gt;&gt;&gt; ERROR: linux-sony-taoshan: build failed
</pre>
<p><b>Explanation :</b> The kernel compilation needs the <b>xz</b> utility to build the kernel because the original taoshan kernel configuration file (from Lineage OS) has the <code>CONFIG_KERNEL_XZ</code> option enabled and <i>pmbootstrap</i> did not install this utility when installing the Alpine OS base.
</p>
<p>The first solution is to add <i>xz</i> in the <code>makedepends</code> directive of the <code>linux-sony-taoshan/APKBUILD</code> file  : 
</p>
<pre>  makedepends="perl sed installkernel bash gmp-dev bc linux-headers elfutils-dev devicepkg-dev xz" 
</pre>
<p>Then you must clear all caches with <code>pmboostrap zap</code> and restart a new compilation.
</p>
<p>The second solution is to choose another compression mode. To do that, run <code>pmbootstrap kconfig edit sony-taoshan</code>, go in the menu "<b>General setup</b>" and select <i>GZIP</i> for the "<b>Kernel compression mode</b>" option.
</p>
<p>With this two methods, the kernel compilation is successfull, but the phone does not boot...
</p>
<h4><span class="mw-headline" id="ARM_UNWIND_support">ARM_UNWIND support</span></h4>
<p>To avoid "<b>ftrace.h:51: multiple definition of `return_address'</b>" errors, it's necessary to disable the stack unwinding support :
</p>
<p>To do that, run <code>pmbootstrap kconfig edit sony-taoshan</code>, go in the menu "<b>Kernel hacking</b>" and uncheck the "<b>Enable stack unwinding support </b>" option.
</p>
<h3><span class="mw-headline" id="Unpacking_boot.img_and_non-standard_warning">Unpacking boot.img and non-standard warning</span></h3>
<p>The Juisma's unmkbootimg utility prints a warning message indicating that the <b>OFF_RAMDISK_ADDR</b> is non-standard :
</p>
<pre>Boot = boot.img
unmkbootimg version 1.2 - Mikael Q Kuisma &lt;kuisma@ping.se&gt;
Kernel size 5847800
Kernel address 0x80208000
Ramdisk size 7421021
Ramdisk address 0x82200000
Secondary size 0
Secondary address 0x81100000
Kernel tags address 0x80200100
Flash page size 2048
Board name is ""
Command line "console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug"

*** WARNING ****
This image is built using NON-standard mkbootimg!
OFF_RAMDISK_ADDR is 0x02000000
Please modify mkbootimg.c using the above values to build your image.
****************

Extracting kernel to file zImage ...
Extracting root filesystem to file initramfs.cpio.gz ...
All done.
---------------source
To recompile this image, use:
  mkbootimg --kernel zImage --ramdisk initramfs.cpio.gz --base 0x80200000 --cmdline 'console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug' -o new_boot.img
---------------
24525 blocks
</pre>
<p>The <a rel="nofollow" class="external text" href="http://whiteboard.ping.se/Android/Unmkbootimg">Kuisma's unmkbootimg utility home page</a> was not modified since 2015-12-07 : it seems to be out of date... And there is no way to download the source code to investigate...
</p>
<p><br>
As this warning is shown for both files (pmboostrap and Lineage), I think it can be ignored safely : 
</p>
<p>Lineage :
</p>
<pre>$ unzip  ~/postmarket/taoshan/lineage-14.1-20180909-nightly-taoshan-signed.zip boot.img
$ mv boot.img boot.img.lineage
$ ./unmkbootimg  boot.img.pmbootstrap | grep NON
This image is built using NON-standard mkbootimg!
</pre>
<p>PmBootStrap :
</p>
<pre>$ cp /home/dom/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/boot.img-sony-taoshan boot.img.pmbootstrap
$ ./unmkbootimg  boot.img.lineage | grep NON
This image is built using NON-standard mkbootimg!
</pre>
<h2><span class="mw-headline" id="Motherboard">Motherboard</span></h2>
<div class="thumb tleft"><div class="thumbinner" style="width:302px;">
<a href="../Taoshan_motherboard_sa77GA341.JPG" class="image"><img alt="" src="../Taoshan_motherboard_sa77GA341.JPG" decoding="async" width="300" height="245" class="thumbimage" srcset="../Taoshan_motherboard_sa77GA341.JPG 1.5x ../Taoshan_motherboard_sa77GA341.JPG 2x"></a>  <div class="thumbcaption">
<div class="magnify"><a href="../Taoshan_motherboard_sa77GA341.JPG" class="internal" title="Enlarge"></a></div>SA77_GA-341 motherboard</div>
</div></div>
<p>The reference of the motherboard is '<b>sa77_GA-341'</b>
</p>
<h4><span class="mw-headline" id="Serial_connector">Serial connector</span></h4>
<div class="thumb tright"><div class="thumbinner" style="width:302px;">
<a href="../Taoshan_motherboard_pinout.png" class="image"><img alt="" src="../Taoshan_motherboard_pinout.png" decoding="async" width="300" height="229" class="thumbimage" srcset="../Taoshan_motherboard_pinout.png 1.5x ../Taoshan_motherboard_pinout.png 2x"></a>  <div class="thumbcaption">
<div class="magnify"><a href="../Taoshan_motherboard_pinout.png" class="internal" title="Enlarge"></a></div>SA77_GA-341 pinout</div>
</div></div>
<p>Presently, we have no idea where the UART pins (TX, RX and ground) are located. Maybe at the top left, under the 'D' letter...
</p>
<p>Light blue is voltage when the phone is powered on.
</p>
<p>Measured voltage on pin marked "strange" is weird:
</p>
<ul>
<li>when voltmeter test leads touch this pad and ground (shield in my case) it shows varying 1.6V - 1.7V</li>
<li>when measuring after boot OR taking voltmeter leads from the pad and touching it again it shows 0.0V</li>
</ul>
<p>Small pad on bottom between ground and BATT_MID is 1.8V: after connecting it to TX and right after inserting the battery it sends similar string:
</p>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">Occasional 9 may be caused by transmission error, I was holding wires in hand</td>
</tr></tbody></table>
<pre>(8888888988998898888888888888888888888988898898888898888888888898888888889888889888988888888888888988988889888888888888988988888889888888988888988888989888888898888888989888988888988898888888888888888B 
(8888888888988889888888898988888988888888888898888888889888888888898899888888889888888888888888988888888889898889888889888888988889988889889888888888898898988888888888888889889888988888888988888888988B
(8988989888988888888888888898888898888888889988888988898888888888888889989888888988888998888898889889898988988888888898888888889888898888888888888988888888888888888888888888888888988888888888888889888B
</pre>
<p><br>
</p>
<h3><span class="mw-headline" id="Trying_to_use_the_Lineage_OS_prebuilt_kernel">Trying to use the Lineage OS prebuilt kernel</span></h3>
<p>Reference : <a href="../en/Using_prebuilt_kernels.html" title="Using prebuilt kernels">Using prebuilt kernels</a>
</p>
<p>Download the <b>unpackbootimg</b> utility :
</p>
<pre>$ wget https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/android-serialport-api/android_bootimg_tools.tar.gz
$ tar xf android_bootimg_tools.tar.gz 
</pre>
<p>Xperia L is running Lineage OS and is connected to the computer with an USB cable.
</p>
<p>Use <b>adb</b> to connect as root :
</p>
<pre>$ sudo adb root
* daemon not running. starting it now on port 5037 *
* daemon started successfully *
restarting adbd as root

$ adb shell
taoshan:/ # whoami
root
</pre>
<p>Find the boot partition (/dev/block/mmcblk0p24) :
</p>
<pre>taoshan:/ # ls -l /dev/block/platform/*/by-name/* | grep -i  "\/boot"                                                                                                                                             
lrwxrwxrwx 1 root root 21 2018-10-26 16:56 /dev/block/platform/msm_sdcc.1/by-name/boot -&gt; /dev/block/mmcblk0p24
</pre>
<p>Get the boot partition content : 
</p>
<pre>taoshan:/ # cat /dev/block/mmcblk0p24 &gt; /sdcard/boot_img_lineage_os.img
taoshan:/ # chmod 666 /sdcard/boot_img_lineage_os.img
taoshan:/ # exit
</pre>
<p>Download and extract to LineageOS boot partition :
</p>
<pre>$ adb pull /sdcard/boot_img_lineage_os.img .
[100%] /sdcard/boot_img_lineage_os.img

$ mkdir boot_img_lineage_os
$ ./unpackbootimg -i boot_img_lineage_os.img -o boot_img_lineage_os

dom@shangrao:~/postmarket/taoshan/temp$ ls boot_img_lineage_os | cat
boot_img_lineage_os.img-base
boot_img_lineage_os.img-cmdline
boot_img_lineage_os.img-pagesize
boot_img_lineage_os.img-ramdisk.gz
boot_img_lineage_os.img-zImage
</pre>
<p>Build LineageOS : 
</p>
<pre>$ pmbootstrap install
</pre>
<p>Restart smartphone in fastboot mode : 
</p>
<ul>
<li>turn the device off</li>
<li>unplug the USB cable</li>
<li>while pressing the volume up button, plug the USB cable</li>
<li>check the led is blue</li>
</ul>
<p>With the <b>fastboott boot</b> command, load LineageOS kernel and Postmarket ramdisk in the device memory : 
</p>
<pre>$ sudo fastboot boot ./boot_img_lineage_os/boot_img_lineage_os.img-zImage ~/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/initramfs-sony-taoshan
creating boot image...
creating boot image - 7084032 bytes
downloading 'boot.img'...
OKAY [  0.220s]
booting...
OKAY [  0.032s]
finished. total time: 0.253s
</pre>
<p>After writing, the device tries to boot (message <i>booting...</i>), but nothing happens : the screen remains black and the led remains blue. 
A <b>fastboot devices</b> command shows no device connected : the device is frozzen. 
</p>
<p>After removing and replacing the battery, you can boot normally.
</p>
<p><br>
</p>
<h3><span class="mw-headline" id="boot_addresses">boot addresses</span></h3>
<p>The official chipset of Xperia L is MSM8230 Snapdragon 400.
</p>
<p>In the Lineage Github repository of the taoshan device, the <a rel="nofollow" class="external text" href="https://github.com/LineageOS/android_device_sony_taoshan/blob/cm-14.1/PlatformConfig.mk">PlatformConfig.mk</a> indicates that the platform is <b>msm8960</b> : 
</p>
<pre>TARGET_BOARD_PLATFORM := msm8960
</pre>
<p>and the <a rel="nofollow" class="external text" href="https://github.com/LineageOS/android_device_sony_taoshan/blob/cm-14.1/lineage.dependencies">lineage.dependencies</a> file indicates that the kernel github repository is <b>android_kernel_sony_msm8930</b> :
</p>
<pre>	"repository": "android_kernel_sony_msm8930",
	"target_path": "kernel/sony/msm8930
</pre>
<p>In the <a rel="nofollow" class="external text" href="https://github.com/LineageOS/android_kernel_sony_msm8930">LineageOS msm8930 repository</a>, the <a rel="nofollow" class="external text" href="https://github.com/LineageOS/android_kernel_sony_msm8930/blob/cm-14.1/arch/arm/mach-msm/Makefile.boot">Makefile.boot</a> file of the <b>msm</b> architecture indicates the same value (<i></i>
0x80208000<i>) for the </i>MSM8960<i> and the </i>MSM8930<i> architectures : </i>
</p>
<pre>zreladdr-$(CONFIG_ARCH_MSM8960)	:= 0x80208000
zreladdr-$(CONFIG_ARCH_MSM8930)	:= 0x80208000
</pre>
<p>Using the <b>abootimg</b> utility with the original Lineage OS boot.img file confirms this value :
</p>
<pre>$ abootimg -i ~/postmarket/taoshan/boot_img_lineage_os.img 
Android Boot Image Info:
* file name = /home/dom/postmarket/taoshan/boot_img_lineage_os.img 
* image size = 19922944 bytes (19.00 MB)
  page size  = 2048 bytes
* Boot Name = ""
* kernel size       = 5847840 bytes (5.58 MB)
  ramdisk size      = 7420948 bytes (7.08 MB)
* load addresses:
  kernel:       0x80208000
  ramdisk:      0x82200000
  tags:         0x80200100
* cmdline = console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug
* id = 0x38f1134f 0xc038d148 0xe9283af8 0x00e68f16 0x910e8cf0 0x00000000 0x00000000 0x00000000 
</pre>
<h3><span class="mw-headline" id="fastboot_boot_issue">fastboot boot issue</span></h3>
<p>After serveral tests with the <b>fastboot boot</b> command and different kernels, I was surprised to see the Samsung logo even with a Postmarket kernel. So I suspected the device to always reboots with the LineageOS kernel written on disk and not with the kernel I loaded in memory...
</p>
<p>To check this, I erased the /boot partition (with <b>fastboot erase boot</b>) and I checked that the device could not start : effectively, screen stayed black and the red led was blinking every 5 seconds.
</p>
<p>My next step was to use <b>fastboot boot</b> command to boot with original Lineage kernel and ramdisk. My best result was to send :
</p>
<ul>
<li>--base 0x80200000</li>
<li>--kernel-offset 0x00008000</li>
<li>--ramdisk-offset 0x02000000</li>
</ul>
<pre>$ sudo fastboot boot --base 0x80200000 --kernel-offset 0x00008000 --ramdisk-offset 0x02000000 -c "console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug" boot_img_lineage_os.img-zImage boot_img_lineage_os.img-ramdisk.gz
creating boot image...
creating boot image - 13273088 bytes
downloading 'boot.img'...
OKAY [  0.411s]
booting...
OKAY [  0.032s]
finished. total time: 0.443s
</pre>
<p>Device restarted, but screen remained black and the red led was blinking every 5 seconds...*
</p>
<p><br>
</p>
<h3><span class="mw-headline" id="Lineage_OS_boot.img_recompression">Lineage OS boot.img recompression</span></h3>
<p>Unpackaging and repackaging the LineageOS boot.img file creates a new file which is smaller (6Mo). This image can be booted normally.
</p>
<p>LineageOS's boot.img extraction :
</p>
<pre>$ unpackbootimg -i boot_img_lineage_os.img -o boot_img_lineage_os
BOARD_KERNEL_CMDLINE console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug
BOARD_KERNEL_BASE 80200000
BOARD_PAGE_SIZE 2048
</pre>
<p>New boot.img repackaging : 
</p>
<pre>$ mkbootimg --base 0x80200000 --kernel_offset  0x00008000 --ramdisk_offset 0x02000000 --tags_offset 0x00000100 --pagesize 2048 --cmdline 'console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug' --kernel boot_img_lineage_os/boot_img_lineage_os.img-zImage --ramdisk boot_img_lineage_os/boot_img_lineage_os.img-ramdisk.gz -o boot_img_lineage_os_recompress.img
</pre>
<p>Original and new boot.img files don't have the same size (6Mo) : 
</p>
<pre>$ ls -lh boot_img_lineage_os_recompress.img boot_img_lineage_os.img
-r--r--r-- 1 dom dom 19M oct.  26 16:13 boot_img_lineage_os.img
-rw-r--r-- 1 dom dom 13M nov.   7 19:02 boot_img_lineage_os_recompress.img
</pre>
<p>New boot.img file flashing : 
</p>
<pre>$ sudo fastboot flash boot ./boot_img_lineage_os_recompress.img
target didn't report max-download-size
sending 'boot' (12962 KB)...
OKAY [  0.411s]
writing 'boot'...
OKAY [  0.899s]
finished. total time: 1.309s
</pre>
<p>Device boots normally with this new image even if it's 6Mo smaller.
</p>
<p>A binary comparison of the two files shows that a chunck of 6 Mo of null bytes was added at the end of the LineageOS boot.img file.
</p>
<h3><span class="mw-headline" id="Starting_LineageOS_with_PostMarket_kernel">Starting LineageOS with PostMarket kernel</span></h3>
<p>Booting LineageOS with a <i>boot.img</i> including a Postmarket's kernel works !
</p>
<p>Create a <i>boot.img</i> including LineageOS ramdisk and the PostMarket kernel :
</p>
<pre>$ mkbootimg --base 0x80200000 --kernel_offset  0x00008000 --ramdisk_offset 0x02000000 --tags_offset 0x00000100 --pagesize 2048 --cmdline 'console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug' --kernel ~/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/vmlinuz-sony-taoshan --ramdisk boot_img_lineage_os/boot_img_lineage_os.img-ramdisk.gz -o boot_img_lineage_os_kernel_postmarket.img
</pre>
<p>Flash <i>boot.img</i> : 
</p>
<pre>$ sudo fastboot flash boot boot_img_lineage_os_kernel_postmarket.img
target didn't report max-download-size
sending 'boot' (15430 KB)...
OKAY [  0.488s]
writing 'boot'...
OKAY [  1.062s]
finished. total time: 1.551s
</pre>
<p>Restart device and check with <i>uname</i> that the kernel is PostMarket kernel : 
</p>
<pre>taoshan:/ $ uname -v
#1-postmarketOS SMP PREEMPT Fri Nov 9 20:16:31 UTC 2018
</pre>
<p><br>
</p>
<h3><span class="mw-headline" id="Booting_with_Postmarket_kernel_and_ramdisk">Booting with Postmarket kernel and ramdisk</span></h3>
<p>Booting device with Postmarket kernel and ramdisk seems not to work : device does not react at all when pressing power on button (screen stays black, led is off, no vibration). But we will see later that it's possible to do a telnet connection.
</p>
<p>Create a boot.img file with Postmarket's Ramdisk and Kernel : 
</p>
<pre>$ mkbootimg -base 0x80200000 --kernel_offset  0x00008000 --ramdisk_offset 0x02000000 --tags_offset 0x00000100 --pagesize 2048 --cmdline 'console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug' --kernel ~/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/vmlinuz-sony-taoshan --ramdisk ~/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/initramfs-sony-taoshan -o boot_img_kernel_ramdisk_postmarket.img
</pre>
<p>Flash this file :
</p>
<pre>$ sudo fastboot flash boot boot_img_kernel_ramdisk_postmarket.img 
target didn't report max-download-size
sending 'boot' (9422 KB)...
OKAY [  0.299s]
writing 'boot'...
OKAY [  0.652s]
finished. total time: 0.951s
</pre>
<p>Restart device :
</p>
<pre>dom@shangrao:~/postmarket/taoshan/temp$ sudo fastboot reboot
rebooting...
finished. total time: 0.051s
</pre>
<p>Nothing seems to happen when pressing the power on button (black screen, no vibration, led off).
</p>
<p><br>
</p>
<h3><span class="mw-headline" id="Establishing_a_telnet_connection_with_the_debug-shell_hook">Establishing a telnet connection with the debug-shell hook</span></h3>
<p>With the <i>debug-shell</i> extension activated, it will be possible to do a telnet connection to the device from the computer.
</p>
<p>Enable the <i>debug-shell</i> hook : 
</p>
<pre>$ pmbootstrap initfs hook_add debug-shell
[15:28:19] (rootfs_sony-taoshan) install postmarketos-mkinitfs-hook-debug-shell
[15:28:27] (rootfs_sony-taoshan) mkinitfs sony-taoshan
[15:28:32] NOTE: chroot is still active (use 'pmbootstrap shutdown' as necessary)
[15:28:32] Done
</pre>
<p>Create a <i>boot.img</i> file with Postmarket's kernel and ramdisk :
</p>
<pre>$ mkbootimg --base 0x80200000 --kernel_offset  0x00008000 --ramdisk_offset 0x02000000 --tags_offset 0x00000100 --pagesize 2048 --cmdline 'console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug' --kernel ~/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/vmlinuz-sony-taoshan --ramdisk ~/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/initramfs-sony-taoshan    -o boot_img_kernel_ramdisk_postmarket.img
</pre>
<p>And flash it : 
</p>
<pre>$ sudo fastboot flash boot boot_img_kernel_ramdisk_postmarket.img 
target didn't report max-download-size
sending 'boot' (9422 KB)...
OKAY [  0.299s]
writing 'boot'...
OKAY [  0.652s]
finished. total time: 0.951s
</pre>
<p>Reboot device : 
</p>
<pre>$ sudo fastboot reboot
rebooting...
finished. total time: 0.051s
</pre>
<p>Nothing happens : screen is black, led is off, no vibrations...
</p>
<p>Check if a net device appears :
</p>
<ul>
<li>disconnect USB cable</li>
<li>display net device list :</li>
</ul>
<pre>$ ip link
1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: enp2s0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc pfifo_fast state DOWN mode DEFAULT group default qlen 1000
    link/ether fc:aa:14:7d:67:0f brd ff:ff:ff:ff:ff:ff
3: wlp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP mode DORMANT group default qlen 1000
    link/ether d8:fc:93:41:b9:41 brd ff:ff:ff:ff:ff:ff
</pre>
<ul>
<li>reconnect USB cable</li>
<li>redisplay net device list :</li>
</ul>
<pre>1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN mode DEFAULT group default qlen 1000
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
2: enp2s0: &lt;NO-CARRIER,BROADCAST,MULTICAST,UP&gt; mtu 1500 qdisc pfifo_fast state DOWN mode DEFAULT group default qlen 1000
    link/ether fc:aa:14:7d:67:0f brd ff:ff:ff:ff:ff:ff
3: wlp3s0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc mq state UP mode DORMANT group default qlen 1000
    link/ether d8:fc:93:41:b9:41 brd ff:ff:ff:ff:ff:ff
7: enp0s20u4: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UNKNOWN mode DEFAULT group default qlen 1000
    link/ether c2:c1:d3:ef:a3:25 brd ff:ff:ff:ff:ff:ff
</pre>
<p>A new device <i>enp0s20u4</i> appeared with the mac address <i>c2:c1:d3:ef:a3:25</i>.
</p>
<p>Give it the IP address <i>172.16.42.2</i> :
</p>
<pre>$ sudo ip address add dev enp0s20u4 172.16.42.2/24
RTNETLINK answers: File exists
</pre>
<p>And activate it :
</p>
<pre>$ sudo ip link set enp0s20u4 up
</pre>
<p>Check the local IP can be pinged :
</p>
<pre>$ ping -c1 172.16.42.2
PING 172.16.42.2 (172.16.42.2) 56(84) bytes of data.
64 bytes from 172.16.42.2: icmp_seq=1 ttl=64 time=0.021 ms
--- 172.16.42.2 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.021/0.021/0.021/0.000 ms
</pre>
<p>Check that the phone responds at the address <i>172.16.42.1</i> : 
</p>
<pre>$ ping -c1 172.16.42.1
PING 172.16.42.1 (172.16.42.1) 56(84) bytes of data.
64 bytes from 172.16.42.1: icmp_seq=1 ttl=64 time=0.286 ms
--- 172.16.42.1 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.286/0.286/0.286/0.000 ms
</pre>
<p>Launch a telnet connection :
</p>
<pre>dom@shangrao:~/postmarket/taoshan/temp$ telnet 172.16.42.1
Trying 172.16.42.1...
Connected to 172.16.42.1.
Escape character is '^]'.
Type 'pmos_continue_boot' to continue booting:
/ # 
</pre>
<p>Device is up and running :-)
</p>
<h3><span class="mw-headline" id="Screen_remains_black_with_LineageOS_kernel_and_Postmarket_ramdisk">Screen remains black with LineageOS kernel and Postmarket ramdisk</span></h3>
<p>Create a <i>boot.img</i> file with LineageOS kernel and Postmarket ramdisk :
</p>
<pre>$ mkbootimg --base 0x80200000 --kernel_offset  0x00008000 --ramdisk_offset 0x02000000 --tags_offset 0x00000100 --pagesize 2048 --cmdline 'console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug' --kernel ./boot_img_lineage_os/boot_img_lineage_os.img-zImage --ramdisk ~/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/initramfs-sony-taoshan    -o boot_img_kernel_taoshan_ramdisk_postmarket.img
</pre>
<p>Flash this file and reboot :
</p>
<pre>$ sudo fastboot flash boot boot_img_kernel_taoshan_ramdisk_postmarket.img
$ sudo fastboot reboot
</pre>
<p>Initialize USB net :
</p>
<pre>$ sudo ip address add dev enp0s20u4 172.16.42.2/24
$ sudo ip link set enp0s20u4 up
</pre>
<p>Start a telnet connection :
</p>
<pre>$ telnet 172.16.42.1
Trying 172.16.42.1...
Connected to 172.16.42.1.
Escape character is '^]'.
Type 'pmos_continue_boot' to continue booting:
/ #
</pre>
<p>Check kernel is not Postmarket's kernel :
</p>
<pre>/ # uname -a
Linux (none) 3.4.0-gdf6292b #1 SMP PREEMPT Sun Sep 9 08:11:30 UTC 2018 armv7l Linux
</pre>
<p>Try do display an image :
</p>
<pre>/ # . init_functions.sh 
/ # show_splash /splash-loading.ppm.gz
/ # 
</pre>
<p>Screen stays black / off...
</p>
<p>With Postmarket ramdisk, device screen remains black (or off) (with Postmarket kernel or with LineageOS kernel).
But with LineageOS ramdisk, kernel displays Samsung logo.
</p>
<p>Is there something special in LineageOS ramdisk to initialize screen ?
</p>
<p><br>
</p>
<h2><span class="mw-headline" id="Changing_screen_brightness">Changing screen brightness</span></h2>
<p>Sending this command changes the screen brightness (even if it remains black) :
</p>
<pre># echo 255 &gt; /sys/devices/platform/msm_ssbi.0/pm8038-core/pm8xxx-led/leds/wled/brightness
</pre>
<p><br>
After sending the <i>show_splash</i> function, screen seems to display something white very briefly and then turns off with no luminosity : 
</p>
<pre>/ # . init_functions.sh 
/ # show_splash /splash-loading.ppm.gz
</pre> 
<p>Brightness falls back to zero : 
</p>
<pre># cat /sys/devices/platform/msm_ssbi.0/pm8038-core/pm8xxx-led/leds/wled/brightness
0
</pre>
<p>Following lines appears at the end of <i>dmesg</i> :
</p>
<pre>[ 3628.406286] MIPI::mipi_dsi_panel_power: 
[ 3628.406347] mipi_dsi_samsung_panel_power: MIPI : 1
[ 3628.406439] mipi_dsi_samsung_panel_power(1): init=1
[ 3628.482343] mipi_samsung_lcd_on: MIPI init cmd start
[ 3628.704623] mipi_samsung_lcd_on: MIPI init cmd end
[ 3628.719944] mdp4_calc_req_mdp_clk: src_h is zero!
[ 3628.749885] MIPI::mipi_dsi_panel_power: 
[ 3628.749946] mipi_dsi_samsung_panel_power: MIPI : 0
[ 3628.750068] mipi_dsi_samsung_panel_power(0): init=1
</pre>
<h3><span class="mw-headline" id="Adding_logo.rle_in_ramdisk">Adding logo.rle in ramdisk</span></h3>
<p>With Postmarket ramdisk, dmesg complains about no finding <i>logo.rle</i> file :
</p>
<pre>[    0.744208] load_565rle_image: Can not open /logo.rle
</pre>
<p>Copy the original LineageOS <i>logo.rle</i> file in taoshan's chroot FS : 
</p>
<pre>$ sudo cp postmarket/taoshan/temp/boot_img_lineage_os/ramdisk/logo.rle /home/dom/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/logo.rle
</pre>
<p>Configure <i>mkinitfs</i> to add this file in ramdisk :
</p>
<pre>$ pmbootstrap chroot -r
# cat /etc/postmarketos-mkinitfs/files/30-dOm-logo.files &lt;&lt; EOF
/logo.rle
EOF
# exit
</pre>
<p>Rebuild initfs :
</p>
<pre>$ pmbootstrap initfs build
[19:15:22] (rootfs_sony-taoshan) mkinitfs sony-taoshan
[19:15:26] NOTE: chroot is still active (use 'pmbootstrap shutdown' as necessary)
[19:15:26] Done
</pre>
<p>Create a <i>boot.img</i> file with Postmarket kernel and ramdisk (including logo) :
</p>
<pre>$ mkbootimg --base 0x80200000 --kernel_offset  0x00008000 --ramdisk_offset 0x02000000 --tags_offset 0x00000100 --pagesize 2048 --cmdline 'console=ttyHSL0,115200,n8 androidboot.hardware=qcom androidboot.bootdevice=msm_sdcc.1 user_debug=31 msm_rtb.filter=0x3F ehci-hcd.park=3 maxcpus=2 buildvariant=userdebug' --kernel ~/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/vmlinuz-sony-taoshan --ramdisk ~/.local/var/pmbootstrap/chroot_rootfs_sony-taoshan/boot/initramfs-sony-taoshan    -o boot_img_kernel_ramdisk_postmarket_with_logo.img
</pre>
<p>Flash this file and reboot :
</p>
<pre>$ sudo fastboot flash boot boot_img_kernel_ramdisk_postmarket_with_logo.img
$ sudo fastboot reboot
</pre>
<p>Sony logo (content of <i>logo.rle</i>)  appears on screen  !
</p>
<p>Initialize USB net and check <i>logo.rle</i> file :
</p>
<pre>$ telnet 172.16.42.1
Trying 172.16.42.1...
Connected to 172.16.42.1.
Escape character is '^]'.
Type 'pmos_continue_boot' to continue booting:
/ # ls -l /logo.rle 
-rw-r--r--    1 0        0             7660 Nov 11  2018 /logo.rle
</pre>
<p>Try to display a splash screen :
</p>
<pre>/ # . init_functions.sh 
/ # show_splash /splash-loading.ppm.gz
/ #
</pre>
<p>Nothing happens and screen continues to display Sony logo.
</p>
<p><br>
</p>
<h3><span class="mw-headline" id="Manually_updating_fb_mode_updates_screen">Manually updating fb mode updates screen</span></h3>
<p>Reference : 
</p>
<ul>
<li><a rel="nofollow" class="external free" href="https://wiki.postmarketos.org/wiki/Troubleshooting#Newer_version_in_binary_package_repositories_than_in_aports_folder">https://wiki.postmarketos.org/wiki/Troubleshooting#Newer_version_in_binary_package_repositories_than_in_aports_folder</a></li>
<li><a rel="nofollow" class="external free" href="https://github.com/postmarketOS/pmbootstrap/pull/66">https://github.com/postmarketOS/pmbootstrap/pull/66</a></li>
</ul>
<p>The following command updates screen :
</p>
<pre>/ # cat /sys/class/graphics/fb0/modes &gt; /sys/class/graphics/fb0/mode
</pre>
<p>The content of <b>modes</b> file is :
</p>
<pre>/ # cat /sys/class/graphics/fb0/modes
U:480x854p-0
</pre>
<p>So writing the string <b>U:480x854p-0</b> in the <b>mode</b> file works too :
</p>
<pre>/ # echo "U:480x854p-0" &gt; /sys/class/graphics/fb0/mode
</pre>
<p>By example, to display the loading splash :
</p>
<pre>/ # . init_functions.sh 
/ # show_splash splash-loading.ppm.gz
/ # echo "U:480x854p-0" &gt; /sys/class/graphics/fb0/mode
/ # 
</pre>
<p>Calling only the <i>show_splash</i> function to display another splash screen does not work :
</p>
<pre>/ # show_splash splash-mounterror.ppm.gz
</pre>
<p>But, once you send the <i>echo</i> command, splash screen appears :
</p>
<pre>/ # echo "U:480x854p-0" &gt; /sys/class/graphics/fb0/mode
</pre>
<p><br>
</p>
<h3><span class="mw-headline" id="Enabling_msm-fb-refresher">Enabling msm-fb-refresher</span></h3>
<p>As explained in <a rel="nofollow" class="external text" href="https://wiki.postmarketos.org/wiki/Troubleshooting:display">Troubleshooting</a>, <i>msm-fb-refresher</i> may help.
</p>
<p>Add <i>msm-fb-refresher</i> in <i>~/.local/var/pmbootstrap/cache_git/pmaports/device/device-sony-taoshan/APKBUILD</i> :
</p>
<pre>depends="postmarketos-base linux-sony-taoshan mkbootimg msm-fb-refresher mesa-dri-swrast"
</pre>
<p>Rebuild all :
</p>
<pre>$ pmbootstrap zap
$ pmbootstrap checksum device-sony-taoshan
$ pmbootstrap build device-sony-taoshan --force
$ pmbootstrap install
</pre>
<p>Check <i>msm-fb-refresher</i> presence in ramdisk :
</p>
<pre>$ pmbootstrap initfs ls | grep refresher
[17:44:36] *** initramfs ***
-rwxr-xr-x    1 root     root        5.2K Nov 12 17:44 msm-fb-refresher
[17:44:36] *** initramfs-extra ***
[17:44:37] See also: &lt;https://wiki.postmarketos.org/wiki/Initramfs_development&gt;
[17:44:37] NOTE: chroot is still active (use 'pmbootstrap shutdown' as necessary)
[17:44:37] Done
</pre>
<p>Flash and reboot :
</p>
<pre>$ pmbootstrap flasher flash_rootfs
$ pmbootstrap flasher flash_kernel
$ sudo fastboot reboot
</pre>
<p>Screen remains black but ping responds :
</p>
<pre>$ sudo ip address add dev enp0s20u4 172.16.42.2/24
$ sudo ip link set enp0s20u4 up
$ ping 172.16.42.1
PING 172.16.42.1 (172.16.42.1) 56(84) bytes of data.
64 bytes from 172.16.42.1: icmp_seq=2 ttl=64 time=0.314 ms
^C
</pre>
<p>Telnet connection is not possible :
</p>
<pre>$ telnet 172.16.42.1
Trying 172.16.42.1...
telnet: Unable to connect to remote host: Connection refused
</pre>
<p>But ssh connection is possible :
</p>
<pre>$ ssh 172.16.42.1
The authenticity of host '172.16.42.1 (172.16.42.1)' can't be established.
ECDSA key fingerprint is SHA256:BlhEQYA2LoQZR8/zWztgoVdQYmTUtHB7JHU5w+sH+eY.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '172.16.42.1' (ECDSA) to the list of known hosts.
dom@172.16.42.1's password: 
Welcome to postmarketOS!
</pre>
<p>Due to the zap command, debug-shell hook has been lost. Reenabled it, flash and reboot :
</p>
<pre>$ pmbootstrap initfs hook_add debug-shell
$ pmbootstrap flasher flash_kernel
$ sudo fastboot reboot
</pre>
<p>Screen remains black while booting. Telnet connection is possible :
</p>
<pre>$ telnet 172.16.42.1
Trying 172.16.42.1...
Connected to 172.16.42.1.
Escape character is '^]'.

Type 'pmos_continue_boot' to continue booting:
</pre>
<p>msm-fb-refresher is running :
</p>
<pre>/ # ps -ef | grep msm-fb-refreshe[r]
  275 0         0:00 /usr/sbin/msm-fb-refresher --loop
</pre>
<p>After increasing screen luminosity, a splash screen appears :
</p>
<pre>/ # echo 255 &gt; /sys/devices/platform/msm_ssbi.0/pm8038-core/pm8xxx-led/leds/wled/brightness
</pre>
<p>Loading another splash screen is immediately displayed :
</p>
<pre>/ # . init_functions.sh 
/ # show_splash /splash-loading.ppm.gz
</pre>
<p>Conclusion : <i>msm-fb-refresher</i> does it's job, but manually setting screen brightness in startup screen seems to be necessary.
</p>
<h3><span class="mw-headline" id="Boot_process_hangs_when_exiting_telnet_debug-shell">Boot process hangs when exiting telnet debug-shell</span></h3>
<p>When exiting the debug-shell with <b>pmos_continue_boot</b>, the boot process hangs and sshd daemon never starts.
</p>
<p>To follow the boot process after launching the <i>pmos_continue_boot</i> command, I will launch a second telnetd daemon listening on another port and connect to it to follow the content of <i>pmOS_init.log</i>.
</p>
<p>To start a daemon in background, we need to add <i>nohup</i> in the initramfs :
</p>
<pre>$ pmbootstrap chroot --rootfs
/ # cat /etc/postmarketos-mkinitfs/files/10-nohup.files
/usr/bin/nohup
EOF
/ # exit
$ pmbootstrap initfs build 
$ pmbootstrap flasher flash_kernel
$ sudo fastboot reboot
</pre>
<p>Start a second daemon :
</p>
<pre>$ telnet 172.16.42.1
/ # nohup telnetd -b 172.16.42.1:2323 -l /bin/sh
</pre>
<p>With a second terminal window, connect to it and prints log :
</p>
<pre>$ telnet 172.16.42.1 2323
	Trying 172.16.42.1...
	Connected to 172.16.42.1.
	Escape character is '^]'.
	/ # tail -f pmOS_init.log
</pre>
<p>After exiting from the first telnet connection with <i>pmos_continue_boot</i>, the log prints :
</p>
<pre>Terminated
Mount boot partition (/dev/dm-0)
Extract /boot/initramfs-sony-taoshan-extra
25124 blocks
[INFO] charging-sdl version 0.1.0
Device /dev/input/event1 not suitable.
commandline read: charging-sdl
commandline read: -pcf
commandline read: /usr/share/fonts/ttf-dejavu/DejaVuSans.ttf
(*) Direct/Thread: Started 'SigHandler' (768) [CRITICAL - OTHER/0] &lt;85340&gt;...
~~~~~~~~~~~~~~~~~~~~~~~~~| DirectFB 1.7.7 |~~~~~~~~~~~~~~~~~~~~~~~~~~
(c) 2012-2015  DirectFB integrated media GmbH
(c) 2001-2015  The world wide DirectFB Open Source Community
(c) 2000-2004  Convergence (integrated media) GmbH
----------------------------------------------------------------
(*) DirectFB/Core: Single Application Core. (2017-10-03 12:19) 
Device /dev/input/event5 not suitable.
(*) Direct/Memcpy: Using libc memcpy()
(*) Direct/Thread: Started 'Fusion Dispatch' (769) [MESSAGING - OTHER/0] &lt;85340&gt;...
Device /dev/input/event6 not suitable.
(*) Direct/Thread: Started 'VT Switcher' (772) [CRITICAL - OTHER/0] &lt;85340&gt;...
(*) Direct/Thread: Started 'VT Flusher' (773) [DEFAULT - OTHER/0] &lt;85340&gt;...
(*) DirectFB/FBDev: Found 'msmfb43_90501' (ID 0) with frame buffer at 0x82334000, 4812k (MMIO 0x00000000, 0k)
(*) Direct/Modules: suppress module 'linux_input'
Device /dev/input/event0 not suitable.
(*) Direct/Thread: Started 'Keyboard Input' (774) [INPUT - OTHER/0] &lt;85340&gt;...
(*) DirectFB/Input: Keyboard 0.9 (directfb.org)
(*) DirectFB/Input: Hot-plug detection enabled with Input Hub Driver 
(*) Direct/Thread: Started 'PS/2 Input' (775) [INPUT - OTHER/0] &lt;85340&gt;...
(*) DirectFB/Input: IMPS/2 Mouse (1) 1.0 (directfb.org)
(*) Direct/Thread: Started 'PS/2 Input' (776) [INPUT - OTHER/0] &lt;85340&gt;...
(*) DirectFB/Input: IMPS/2 Mouse (2) 1.0 (directfb.org)
(*) DirectFB/Graphics: Generic Software Rasterizer 0.7 (directfb.org)
(!) DirectFB/FBDev: No supported modes found in /etc/fb.modes and current mode not supported!
(!) DirectFB/FBDev: Current mode's pixelformat: rgba 8/24, 8/16, 8/8, 8/0 (32bit)
(!) DirectFB/Core/layers: Failed to initialize layer 0!
    --&gt; A general initialization error occured
(!) DirectFB/Core: Could not initialize 'layer_core' core!
    --&gt; A general initialization error occured
Segmentation fault
</pre>
<p>Executing the <b>start_charging_mode</b> from debug-shell prints the same error :
</p>
<pre>/# . init_functions.sh
/ # start_charging_mode
[...]
(*) DirectFB/Graphics: Generic Software Rasterizer 0.7 (directfb.org)
(!) DirectFB/FBDev: No supported modes found in /etc/fb.modes and current mode not supported!
(!) DirectFB/FBDev: Current mode's pixelformat: rgba 8/24, 8/16, 8/8, 8/0 (32bit)
(!) DirectFB/Core/layers: Failed to initialize layer 0!(!) DirectFB/Core: Could not initialize 'layer_core' core!
    --&gt; A general initialization error occured
Segmentation fault
</pre>
<p>After disabling this function, the boot process terminates, and sshd daemon is started.
</p>
<p>Source of the <i>start_charging_mode</i> function :
</p>
<pre>start_charging_mode(){
	# Check cmdline for charging mode
	chargingmodes="
		androidboot.mode=charger
		lpm_boot=1
		androidboot.huawei_type=oem_rtc
		startup=0x00010004
		lpcharge=1
		androidboot.bootchg=true
	"
	# shellcheck disable=SC2086
	grep -Eq "$(echo $chargingmodes | tr ' ' '|')" /proc/cmdline || return
	setup_directfb_tslib
	# Get the font from osk-sdl config
	fontpath=$(awk '/^keyboard-font/{print $3}' /etc/osk.conf)
	# Set up triggerhappy config
	{
		echo "KEY_POWER 1 pgrep -x charging-sdl || charging-sdl -pcf $fontpath"
	} &gt;/etc/triggerhappy.conf
	# Start it once and then start triggerhappy
	(
		charging-sdl -pcf "$fontpath" \
			|| show_splash /splash-charging-error.ppm.gz
	) &amp;
	thd --deviceglob /dev/input/event* --triggers /etc/triggerhappy.conf
}
</pre>
<p><br>
There are two issues with DirectFB :
</p>
<ul>
<li>The <i>No supported modes found in /etc/fb.modes</i> error : generate this file with the appropriate mode.</li>
<li>The final segmentation fault : try to generate a core dump and anlayze it.</li>
</ul>
<h3><span class="mw-headline" id="charging-sdl_segmentation_fault_analyzing">charging-sdl segmentation fault analyzing</span></h3>
<p>The idea is to generate the segmentation fault from <i>gdb</i> to examine backtrace.
</p>
<p>To include <i>gdb</i>, add it in the <i>depends</i> directive of <i>~/.local/var/pmbootstrap/cache_git/pmaports/device/device-sony-taoshan/APKBUILD</i> :
</p>
<pre>depends="postmarketos-base linux-sony-taoshan mkbootimg msm-fb-refresher mesa-dri-swrast gdb"
</pre>
<p>Remove debug-shell :
</p>
<pre>$ pmbootstrap initfs hook_del debug-shell
</pre>
<p>Rebuild rootfs and flash it :
</p>
<pre>$ pmbootstrap build --force device-sony-taoshan
$ pmbootstrap install
$ pmbootstrap flasher flash_rootfs
$ pmbootstrap flasher flash_kernel
</pre>
<p>After rebooting phone, enable USB networking and connect with ssh.
</p>
<pre>$ sudo ip address add dev enp0s20u4 172.16.42.2/24
$ sudo ip link set enp0s20u4 up
$ ssh 172.16.42.1 
</pre>
<p>Once connected, change root :
</p>
<pre>$ sudo su -
[sudo] password for dom: 
</pre>
<p>To generate the segmentation fault :
</p>
<pre>sony-taoshan:~# export DFBARGS="system=fbdev,no-cursor,disable-module=linux_input"
sony-taoshan:~# echo "KEY_POWER 1 pgrep -x charging-sdl || charging-sdl -pcf $fontpath" &gt; /etc/triggerhappy.conf
sony-taoshan:~# charging-sdl -pcf /usr/share/fonts/ttf-dejavu/DejaVuSans.ttf
[INFO] charging-sdl version 0.1.0
[...]
    --&gt; A general initialization error occured
Segmentation fault
sony-taoshan:~# 
</pre>
<p>To generate this seg fault from gdb, launch it like this :
</p>
<pre>sony-taoshan:~# gdb --args /usr/bin/charging-sdl -pcf /usr/share/fonts/ttf-dejavu/DejaVuSans.ttf
GNU gdb (GDB) 8.0.1
[...]
Reading symbols from /usr/bin/charging-sdl...done.
(gdb)
</pre>
<p>Start <i>charging-sdl</i> execution : 
</p>
<pre>(gdb) run
Starting program: /usr/bin/charging-sdl -pcf /usr/share/fonts/ttf-dejavu/DejaVuSans.ttf
[INFO] charging-sdl version 0.1.0
No protocol specified
commandline read: charging-sdl
commandline read: -pcf
commandline read: /usr/share/fonts/ttf-dejavu/DejaVuSans.ttf
[New LWP 1539]
(*) Direct/Thread: Started 'SigHandler' (1539) [CRITICAL - OTHER/0] &lt;85340&gt;...
   ~~~~~~~~~~~~~~~~~~~~~~~~~| DirectFB 1.7.7 |~~~~~~~~~~~~~~~~~~~~~~~~~~
        (c) 2012-2015  DirectFB integrated media GmbH
        (c) 2001-2015  The world wide DirectFB Open Source Community
        (c) 2000-2004  Convergence (integrated media) GmbH
      ----------------------------------------------------------------
(*) DirectFB/Core: Single Application Core. (2017-10-03 12:19) 
(*) Direct/Memcpy: Using libc memcpy()
[New LWP 1540]
(*) Direct/Thread: Started 'Fusion Dispatch' (1540) [MESSAGING - OTHER/0] &lt;85340&gt;...
[New LWP 1543]
(*) Direct/Thread: Started 'VT Switcher' (1543) [CRITICAL - OTHER/0] &lt;85340&gt;...
[New LWP 1544]
(*) Direct/Thread: Started 'VT Flusher' (1544) [DEFAULT - OTHER/0] &lt;85340&gt;...
(*) DirectFB/FBDev: Found 'msmfb43_90501' (ID 0) with frame buffer at 0x82334000, 4812k (MMIO 0x00000000, 0k)
(*) Direct/Modules: suppress module 'linux_input'
(*) DirectFB/Input: Hot-plug detection enabled with Input Hub Driver 
[New LWP 1545]
(*) Direct/Thread: Started 'Keyboard Input' (1545) [INPUT - OTHER/0] &lt;85340&gt;...
(*) DirectFB/Input: Keyboard 0.9 (directfb.org)
[New LWP 1546]
(*) Direct/Thread: Started 'PS/2 Input' (1546) [INPUT - OTHER/0] &lt;85340&gt;...
(*) DirectFB/Input: IMPS/2 Mouse (1) 1.0 (directfb.org)
[New LWP 1547]
(*) Direct/Thread: Started 'PS/2 Input' (1547) [INPUT - OTHER/0] &lt;85340&gt;...
(*) DirectFB/Input: IMPS/2 Mouse (2) 1.0 (directfb.org)
(*) DirectFB/Graphics: Generic Software Rasterizer 0.7 (directfb.org)
(!) DirectFB/FBDev: No supported modes found in /etc/fb.modes and current mode not supported!
(!) DirectFB/FBDev: Current mode's pixelformat: rgba 8/24, 8/16, 8/8, 8/0 (32bit)
(!) DirectFB/Core/layers: Failed to initialize layer 0!
    --&gt; A general initialization error occured
(!) DirectFB/Core: Could not initialize 'layer_core' core!
    --&gt; A general initialization error occured
Thread 6 "Keyboard Input" received signal ?, Unknown signal.
[Switching to LWP 1545]
0xb6fb29a8 in __clone () from /lib/ld-musl-armhf.so.1
</pre>
<p>Seg fault comes from the thread  <i>Keyboard Input</i> (LWP 1545) which receives a unknown signal.
</p>
<p>Print backtrace complains about a corrupt stack :
</p>
<pre>(gdb) backtrace
#0  0xb6fb29a8 in __clone () from /lib/ld-musl-armhf.so.1
#1  0xb6fb3668 in ?? () from /lib/ld-musl-armhf.so.1
Backtrace stopped: previous frame identical to this frame (corrupt stack?)
</pre>
<h4>
<span id="Error_DirectFB/FBDev:_No_supported_modes_found"></span><span class="mw-headline" id="Error_DirectFB.2FFBDev:_No_supported_modes_found">Error DirectFB/FBDev: No supported modes found</span>
</h4>
<p>The error <i>DirectFB/FBDev: No supported modes found in /etc/fb.modes and current mode not supported!</i> is a known problem. See the <i>Osk-sdl</i> page:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="https://wiki.postmarketos.org/wiki/Osk-sdl#DirectFB.2FFBDev:_No_supported_modes_found_in_.2Fetc.2Ffb.modes_and_current_mode_not_supported.21">DirectFB/FBDev: No supported modes found in /etc/fb.modes and current mode not supported</a></li>
<li><a rel="nofollow" class="external text" href="https://wiki.postmarketos.org/wiki/Osk-sdl#Create_fb.modes">Create fb.modes</a></li>
</ul>
<p>After creating the appropriate FB Mode in <i>/etc/fb.modes</i>, it should be possible to reactivate the <i>start_charging_mode</i> in 
<i>init_functions.sh</i>.
</p>
<p>With <i>debug-shell</i> enabled, connect via telnet, and enlight screen by writing in the <i>brightness</i> file :
</p>
<pre>echo 255 &gt; /sys/devices/platform/msm_ssbi.0/pm8038-core/pm8xxx-led/leds/wled/brightness
</pre>
<p>Create the <i>/etc/fb.modes</i> file :
</p>
<pre>cat &gt; /etc/fb.modes &lt;&lt; EOF
mode "480x854-0"
    # D: 0.003 MHz, H: 0.004 kHz, V: 0.005 Hz
    geometry 854 1708 854 1708 16
    timings 400000000 50 50 9 9 20 4
    accel false
    rgba 8/24,8/16,8/8,8/0
endmode
EOF
</pre>
<p>Exit telnet :
</p>
<pre>/ # pmos_continue_boot
</pre>
<p>Screen becomes black. After few seconds, connect with ssh and enlight screen again :
</p>
<pre>sony-taoshan:~$ sudo su -
[sudo] password for dom: 
sony-taoshan:~# echo 255 &gt; /sys/devices/platform/msm_ssbi.0/pm8038-core/pm8xxx-led/leds/wled/brightness
</pre>
<p>The Wayland screen should appears.
</p>
<h3><span class="mw-headline" id="Adding_FB_workarounds_in_APKBUILD">Adding FB workarounds in APKBUILD</span></h3>
<p>Go in the taoshan's device directory : <i>~/.local/var/pmbootstrap/cache_git/pmaports/device/device-sony-taoshan</i>.
</p>
<p>Create the <b>fb.modes</b> file :
</p>
<pre> 
mode "480x854-0"
    # D: 0.003 MHz, H: 0.004 kHz, V: 0.005 Hz
    geometry 854 1708 854 1708 16
    timings 400000000 50 50 9 9 20 4
    accel false
    rgba 8/24,8/16,8/8,8/0
endmode
</pre>
<p>Create the <b>screen_enlightener</b> script :
</p>
<pre>#!/bin/sh
brightness_file=$(find /sys/devices/platform/msm_ssbi.0/ -name brightness | grep -v rgb | head -n1)
test -z "$brightness_file" &amp;&amp; {
        echo "Can't find screen brightness file !"
        exit 1
}
echo "Screen brightness : $brightness_file"
test -w "$brightness_file" || {
        echo "Can't find write screen brightness file !"
        exit 1
}
while true ; do
        test $(cat $brightness_file) -ne 255 &amp;&amp; \
                echo 255 &gt; $brightness_file
        sleep 1
done  
</pre>
<p><br>
Create a hook script named <b>initfs-hook.sh</b> which will be called during boot process to start the <i>screen_enlightener</i> script in background :
</p>
<pre> 
#!/bin/sh
echo "Start the screen enlightener script"
/bin/sh /usr/sbin/screen_enlightener &gt;/tmp/screen_enlightener.log 2&gt;&amp;1 &lt;/dev/null &amp;
</pre>
<p>Create a <i>50-screen-enlightener.files</i> file which will include the <i>screen_enlightener</i> script in <i>initramfs</i> :
</p>
<pre>/usr/sbin/screen_enlightener
</pre>
<p>Update the <i>APKBUILD</i> :
</p>
<ul>
<li>declare these files in the <b>source</b> variable</li>
<li>add an <i>install</i> directive in the <i>package</i> function :</li>
</ul>
<pre>source="
	deviceinfo
	screen_enlightener
	fb.modes
	50-screen-enlightener.files
	initfs-hook.sh
"
[...]
package() {
	devicepkg_package $startdir $pkgname
	install -Dm544 "$srcdir"/fb.modes "$pkgdir"/etc/fb.modes
	install -Dm444 "$srcdir"/screen_enlightener "$pkgdir"/usr/sbin/screen_enlightener
	install -Dm444 "$srcdir"/50-screen-enlightener.files "$pkgdir"/etc/postmarketos-mkinitfs/files/50-screen-enlightener.files
	install -Dm644 "$srcdir"/initfs-hook.sh "$pkgdir"/etc/postmarketos-mkinitfs/hooks/00-${pkgname}.sh
}
</pre>
<p>It's not necessary to add an install directive for the <i>fb.modes</i> file : it's automatically in <i>initramfs-extra</i>.
</p>
<p>Checksums (at the end of <i>APKBUILD</i>) need to be updated after adding new files :
</p>
<pre>$ pmbootstrap checksum device-sony-taoshan
[13:02:46] (native) generate checksums for device-sony-taoshan
[13:02:46] NOTE: chroot is still active (use 'pmbootstrap shutdown' as necessary)
[13:02:46] Done
</pre>
<p>Rebuild all :
</p>
<pre>$ pmbootstrap build device-sony-taoshan --force
$ pmbootstrap install
</pre>
<p>Check files presence in chroot :
</p>
<pre>$ pmbootstrap chroot -r
[13:10:16] (rootfs_sony-taoshan) % sh -i

/ # ls -l /etc/fb.modes /usr/sbin/screen_enlightener /etc/postmarketos-mkinitfs/hooks/00-device-sony-taoshan.sh 
-r-xr--r--    1 root     root           185 Nov 17 17:44 /etc/fb.modes
-rw-r--r--    1 root     root           137 Nov 17 17:44 /etc/postmarketos-mkinitfs/hooks/00-device-sony-taoshan.sh
-r--r--r--    1 root     root           492 Nov 17 17:44 /usr/sbin/screen_enlightener

/ # cat /etc/postmarketos-mkinitfs/hooks/00-device-sony-taoshan.sh
#!/bin/sh
echo "Start the screen enlightener script"
/bin/sh /usr/sbin/screen_enlightener &gt;/tmp/screen_enlightener.log 2&gt;&amp;1 &lt;/dev/null &amp;

/ # exit
[13:10:28] NOTE: chroot is still active (use 'pmbootstrap shutdown' as necessary)
[13:10:28] Done
</pre>
<h2><span class="mw-headline" id="Touch_screen">Touch screen</span></h2>
<p>Touch screen is /dev/input/event2
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p><a href="../en/Installation_guide.html" title="Installation guide">Installation guide</a>
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/71">pmaports!71</a> Initial merge request</li>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/tree/master/device/testing/device-sony-taoshan">Device package</a></li>
<li><a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/tree/master/device/testing/linux-sony-taoshan">Kernel package</a></li>
</ul>
</div></div>
		
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Category</a>: <ul><li><a href="../en/Category:Devices.html" title="Category:Devices">Devices</a></li></ul>
</div></div>
		<div class="visualClear"></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=Sony_Xperia_L_(sony-taoshan)&amp;oldid=16492">https://wiki.postmarketos.org/index.php?title=Sony_Xperia_L_(sony-taoshan)&amp;oldid=16492</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 15 January 2021, at 08:50.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../en/About_postmarketOS.html" class="mw-redirect" title="PostmarketOS:About">About postmarketOS</a></li>
								<li id="footer-places-disclaimer"><a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-mobileview"><a href="https://wiki.postmarketos.org/index.php?title=Sony_Xperia_L_(sony-taoshan)&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="../poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="" width="88" height="31"></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

</body>
</html>
