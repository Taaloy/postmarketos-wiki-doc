<!DOCTYPE html>
<html class="client-nojs" dir="ltr" lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Mrtest - postmarketOS
  </title>
  <link href="../PostmarketOSWikiOffline.css" rel="stylesheet"/>
  <meta content="" name="ResourceLoaderDynamicStyles"/>
  <meta content="MediaWiki 1.34.2" name="generator"/>
  <link href="/favicon.ico" rel="shortcut icon"/>
  <link href="/opensearch_desc.php" rel="search" title="postmarketOS (en)" type="application/opensearchdescription+xml"/>
  <link href="https://wiki.postmarketos.org/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
  <link href="https://creativecommons.org/licenses/by-sa/4.0/" rel="license"/>
  <link href="/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate" title="postmarketOS Atom feed" type="application/atom+xml"/>
 </head>
 <body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Mrtest rootpage-Mrtest skin-vector action-view">
  <div class="mw-body" id="content" role="main" style="margin: 0">
   <a id="top">
   </a>
   <div class="mw-indicators mw-body-content">
   </div>
   <h1 class="firstHeading" id="firstHeading" lang="en">
    Mrtest
   </h1>
   <div class="mw-body-content" id="bodyContent">
    <div class="noprint" id="siteSub">
     From postmarketOS
    </div>
    <div id="contentSub">
    </div>
    <div id="jump-to-nav">
    </div>
    <a class="mw-jump-link" href="#mw-head">
     Jump to navigation
    </a>
    <a class="mw-jump-link" href="#p-search">
     Jump to search
    </a>
    <div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en">
     <div class="mw-parser-output">
      <div class="thumb tright">
       <div class="thumbinner" style="width:302px;">
        <a class="image" href="../Mrtest.jpg">
         <img alt="" class="thumbimage" decoding="async" height="400" src="../Mrtest.jpg" srcset="../Mrtest.jpg 1.5x ../Mrtest.jpg 2x" width="300"/>
        </a>
        <div class="thumbcaption">
         <div class="magnify">
          <a class="internal" href="../Mrtest.jpg" title="Enlarge">
          </a>
         </div>
         <code>
          mrtest add
         </code>
         in action, about to upgrade the kernel to a version from a merge request
        </div>
       </div>
      </div>
      <p>
       mrtest helps with testing merge requests from both
       <a class="mw-redirect" href="../en/Pmaports.git.html" title="Pmaports">
        pmaports
       </a>
       , as well as Alpine's
       <a class="external text" href="https://gitlab.alpinelinux.org/alpine/aports/" rel="nofollow">
        aports
       </a>
       . It automatizes downloading the packages that were built in CI and offers a convenient, interactive prompt to install them.
      </p>
      <div class="toc" id="toc">
       <input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/>
       <div class="toctitle" dir="ltr" lang="en">
        <h2>
         Contents
        </h2>
        <span class="toctogglespan">
         <label class="toctogglelabel" for="toctogglecheckbox">
         </label>
        </span>
       </div>
       <ul>
        <li class="toclevel-1 tocsection-1">
         <a href="#Installation">
          <span class="tocnumber">
           1
          </span>
          <span class="toctext">
           Installation
          </span>
         </a>
        </li>
        <li class="toclevel-1 tocsection-2">
         <a href="#Installing_packages">
          <span class="tocnumber">
           2
          </span>
          <span class="toctext">
           Installing packages
          </span>
         </a>
         <ul>
          <li class="toclevel-2 tocsection-3">
           <a href="#Example">
            <span class="tocnumber">
             2.1
            </span>
            <span class="toctext">
             Example
            </span>
           </a>
          </li>
         </ul>
        </li>
        <li class="toclevel-1 tocsection-4">
         <a href="#Uninstalling_packages">
          <span class="tocnumber">
           3
          </span>
          <span class="toctext">
           Uninstalling packages
          </span>
         </a>
         <ul>
          <li class="toclevel-2 tocsection-5">
           <a href="#Example_2">
            <span class="tocnumber">
             3.1
            </span>
            <span class="toctext">
             Example
            </span>
           </a>
          </li>
         </ul>
        </li>
        <li class="toclevel-1 tocsection-6">
         <a href="#See_also">
          <span class="tocnumber">
           4
          </span>
          <span class="toctext">
           See also
          </span>
         </a>
        </li>
       </ul>
      </div>
      <h2>
       <span class="mw-headline" id="Installation">
        Installation
       </span>
      </h2>
      <p>
       Either from Alpine's packages (as of writing in edge, not yet in stable):
      </p>
      <div class="mw-highlight mw-content-ltr" dir="ltr">
       <pre><span></span><span class="gp">#</span> apk add mrtest
</pre>
      </div>
      <p>
       Or from the git repository:
      </p>
      <div class="mw-highlight mw-content-ltr" dir="ltr">
       <pre><span></span><span class="gp">$</span> git clone https://gitlab.com/postmarketOS/mrhlpr.git
</pre>
      </div>
      <p>
       mrtest source code lives inside
       <a class="external text" href="https://gitlab.com/postmarketOS/mrhlpr" rel="nofollow">
        mrhlpr.git
       </a>
       , as it shares code for interacting with the gitlab API with the mrhlpr project.
      </p>
      <h2>
       <span class="mw-headline" id="Installing_packages">
        Installing packages
       </span>
      </h2>
      <p>
       Navigate to a merge request that you want to test. After reading through the changes made in the merge request, run
       <code>
        mrtest add
       </code>
       with the ID. It will automatically figure out the last pipeline, get the job with the suitable arch of your device, and show which packages are available for installation. Then you will be able to select the packages in an interactive prompt.
      </p>
      <p>
       To install packages from a merge request in Alpine, use
       <code>
        mrtest add -a
       </code>
       (or
       <code>
        --alpine
       </code>
       ).
      </p>
      <h3>
       <span class="mw-headline" id="Example">
        Example
       </span>
      </h3>
      <p>
       Trying to test
       <a class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/3025" rel="nofollow">
        pmaports!3025
       </a>
       results in the following output:
      </p>
      <pre>$ mrtest add 3025
Download https://gitlab.com/api/v4/projects/postmarketOS%2Fpmaports/merge_requests/3025
Download https://gitlab.com/api/v4/projects/8065375
Download https://gitlab.com/api/v4/projects/8065375/pipelines/502182185/jobs
Download https://gitlab.com/api/v4/projects/8065375/jobs/2255535921/artifacts
Getting installed packages...
Which packages to install?

  1) [ ] powersupply-0.6.0-r0.apk

0 of 1 selected.

Commands:
  1-99: toggle this package
  a:    toggle all packages
  u:    toggle upgrade (or downgrade) of installed packages
  l:    list selection
  y:    confirm selection
  q:    quit

What now?&gt; a
1 of 1 selected.
What now?&gt; y
Selection confirmed
Extracting packages from artifacts archive...
Installing packages...
(1/7) Installing py3-ordered-set (4.0.2-r3)
(2/7) Installing py3-appdirs (1.4.4-r3)
(3/7) Installing py3-parsing (2.4.7-r3)
(4/7) Installing py3-packaging (21.3-r0)
(5/7) Installing py3-setuptools (52.0.0-r5)
(6/7) Installing powersupply (0.6.0-r0)
(7/7) Installing .mrtest-3025-postmarketOS (20220327.153518)
Executing busybox-1.35.0-r6.trigger
Executing gtk-update-icon-cache-2.24.33-r0.trigger
OK: 1985 MiB in 919 packages
All done! Use 'mrtest zap' to uninstall added packages.
</pre>
      <h2>
       <span class="mw-headline" id="Uninstalling_packages">
        Uninstalling packages
       </span>
      </h2>
      <p>
       Use
       <code>
        mrtest zap
       </code>
       to check for previously installed virtual packages, and to get a prompt to uninstall them. Uninstalling virtual packages will remove all packages that were added with a
       <code>
        mrtest add
       </code>
       command. Note that this does not include upgraded packages, to remove upgrade packages you will need to run
       <code>
        apk upgrade -a
       </code>
       as the output at the end of
       <code>
        mrtest zap
       </code>
       explains.
      </p>
      <h3>
       <span class="mw-headline" id="Example_2">
        Example
       </span>
      </h3>
      <pre>$ mrtest zap              
Getting installed packages...
Virtual packages from previous 'mrtest add':
* .mrtest-3025-postmarketOS
Remove virtual packages and packages added with mrtest? [y/N] y
Removing packages...
(1/7) Purging .mrtest-3025-postmarketOS (20220327.153518)
(2/7) Purging powersupply (0.6.0-r0)
(3/7) Purging py3-setuptools (52.0.0-r5)
(4/7) Purging py3-ordered-set (4.0.2-r3)
(5/7) Purging py3-appdirs (1.4.4-r3)
(6/7) Purging py3-packaging (21.3-r0)
(7/7) Purging py3-parsing (2.4.7-r3)
Executing busybox-1.35.0-r6.trigger
Executing gtk-update-icon-cache-2.24.33-r0.trigger
OK: 1981 MiB in 912 packages
All done!

Note that 'mrtest zap' will only remove packages *added* during
'mrtest add'. If you want to revert package *upgrades*, run
'apk upgrade -a'. This will upgrade/downgrade all your packages
to the versions in the repositories.
</pre>
      <h2>
       <span class="mw-headline" id="See_also">
        See also
       </span>
      </h2>
      <ul>
       <li>
        <a class="external text" href="https://gitlab.com/postmarketOS/mrhlpr/-/merge_requests/12" rel="nofollow">
         mrhlpr!12
        </a>
        : initial merge request
       </li>
       <li>
        <a class="external text" href="https://cast.postmarketos.org/episode/16-SDM845-mrtest-PinePhone-keyboard-Chromebooks-PowerVR/" rel="nofollow">
         postmarketOS podcast #16
        </a>
        where the tool gets introduced and discussed
       </li>
      </ul>
     </div>
    </div>
    <div class="catlinks catlinks-allhidden" data-mw="interface" id="catlinks">
    </div>
    <div class="visualClear">
    </div>
   </div>
  </div>
  <div id="footer" role="contentinfo" style="margin: 0">
   <ul id="footer-info">
    <li>
     Retrieved from "
     <a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=Mrtest&amp;oldid=26581">
      https://wiki.postmarketos.org/index.php?title=Mrtest&amp;oldid=26581
     </a>
     "
    </li>
    <li id="footer-info-lastmod">
     This page was last edited on 28 March 2022, at 21:09.
    </li>
    <li id="footer-info-copyright">
     Content is available under
     <a class="external" href="https://creativecommons.org/licenses/by-sa/4.0/" rel="nofollow">
      Creative Commons Attribution-ShareAlike
     </a>
     unless otherwise noted.
    </li>
    <br/>
   </ul>
   <ul id="footer-places">
    <li id="footer-places-privacy">
     <a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">
      Privacy policy
     </a>
    </li>
    <li id="footer-places-about">
     <a class="mw-redirect" href="../en/About_postmarketOS.html" title="PostmarketOS:About">
      About postmarketOS
     </a>
    </li>
    <li id="footer-places-disclaimer">
     <a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">
      Disclaimers
     </a>
    </li>
    <li id="footer-places-mobileview">
     <a class="noprint stopMobileRedirectToggle" href="https://wiki.postmarketos.org/index.php?title=Mrtest&amp;mobileaction=toggle_view_mobile">
      Mobile view
     </a>
    </li>
   </ul>
   <ul class="noprint" id="footer-icons">
    <li id="footer-copyrightico">
     <a href="https://creativecommons.org/licenses/by-sa/4.0/">
      <img alt="Creative Commons Attribution-ShareAlike" height="31" src="../cc-by-sa.png" width="88"/>
     </a>
    </li>
    <li id="footer-poweredbyico">
     <a href="https://www.mediawiki.org/">
      <img alt="Powered by MediaWiki" height="31" src="../poweredby_mediawiki_88x31.png" srcset="" width="88"/>
     </a>
    </li>
   </ul>
   <div style="clear: both;">
   </div>
  </div>
 </body>
</html>
