<!DOCTYPE html>
<html class="client-nojs" dir="ltr" lang="en">
 <head>
  <meta charset="utf-8"/>
  <title>
   Bluetooth - postmarketOS
  </title>
  <link href="../PostmarketOSWikiOffline.css" rel="stylesheet"/>
  <meta content="" name="ResourceLoaderDynamicStyles"/>
  <meta content="MediaWiki 1.34.2" name="generator"/>
  <link href="/favicon.ico" rel="shortcut icon"/>
  <link href="/opensearch_desc.php" rel="search" title="postmarketOS (en)" type="application/opensearchdescription+xml"/>
  <link href="https://wiki.postmarketos.org/api.php?action=rsd" rel="EditURI" type="application/rsd+xml"/>
  <link href="https://creativecommons.org/licenses/by-sa/4.0/" rel="license"/>
  <link href="/index.php?title=Special:RecentChanges&amp;feed=atom" rel="alternate" title="postmarketOS Atom feed" type="application/atom+xml"/>
 </head>
 <body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Bluetooth rootpage-Bluetooth skin-vector action-view">
  <div class="mw-body" id="content" role="main" style="margin: 0">
   <a id="top">
   </a>
   <div class="mw-indicators mw-body-content">
   </div>
   <h1 class="firstHeading" id="firstHeading" lang="en">
    Bluetooth
   </h1>
   <div class="mw-body-content" id="bodyContent">
    <div class="noprint" id="siteSub">
     From postmarketOS
    </div>
    <div id="contentSub">
    </div>
    <div id="jump-to-nav">
    </div>
    <a class="mw-jump-link" href="#mw-head">
     Jump to navigation
    </a>
    <a class="mw-jump-link" href="#p-search">
     Jump to search
    </a>
    <div class="mw-content-ltr" dir="ltr" id="mw-content-text" lang="en">
     <div class="mw-parser-output">
      <p>
       <a class="extiw" href="https://en.wikipedia.org/wiki/Bluetooth" title="wikipedia:Bluetooth">
        Bluetooth
       </a>
       is a standard for the short-range wireless interconnection of cellular phones, computers, and other electronic devices. In Linux, the canonical implementation of the Bluetooth protocol stack is
       <a class="external text" href="http://www.bluez.org/" rel="nofollow">
        BlueZ
       </a>
       .
      </p>
      <div class="toc" id="toc">
       <input class="toctogglecheckbox" id="toctogglecheckbox" role="button" style="display:none" type="checkbox"/>
       <div class="toctitle" dir="ltr" lang="en">
        <h2>
         Contents
        </h2>
        <span class="toctogglespan">
         <label class="toctogglelabel" for="toctogglecheckbox">
         </label>
        </span>
       </div>
       <ul>
        <li class="toclevel-1 tocsection-1">
         <a href="#Pairing">
          <span class="tocnumber">
           1
          </span>
          <span class="toctext">
           Pairing
          </span>
         </a>
        </li>
        <li class="toclevel-1 tocsection-2">
         <a href="#Supported_Bluetooth_Profiles">
          <span class="tocnumber">
           2
          </span>
          <span class="toctext">
           Supported Bluetooth Profiles
          </span>
         </a>
         <ul>
          <li class="toclevel-2 tocsection-3">
           <a href="#Audio.2FVideo_Remote_Control_Profile_.28AVRCP.29">
            <span class="tocnumber">
             2.1
            </span>
            <span class="toctext">
             Audio/Video Remote Control Profile (AVRCP)
            </span>
           </a>
          </li>
          <li class="toclevel-2 tocsection-4">
           <a href="#Advanced_Audio_Distribution_Profile_.28A2DP.29">
            <span class="tocnumber">
             2.2
            </span>
            <span class="toctext">
             Advanced Audio Distribution Profile (A2DP)
            </span>
           </a>
          </li>
          <li class="toclevel-2 tocsection-5">
           <a href="#PhoneBook_Access_Profile_.28PBAP.29">
            <span class="tocnumber">
             2.3
            </span>
            <span class="toctext">
             PhoneBook Access Profile (PBAP)
            </span>
           </a>
          </li>
          <li class="toclevel-2 tocsection-6">
           <a href="#Object_Push_Profile_.28OPP.29">
            <span class="tocnumber">
             2.4
            </span>
            <span class="toctext">
             Object Push Profile (OPP)
            </span>
           </a>
          </li>
          <li class="toclevel-2 tocsection-7">
           <a href="#Human_Interface_Device_Profile_.28HID.29">
            <span class="tocnumber">
             2.5
            </span>
            <span class="toctext">
             Human Interface Device Profile (HID)
            </span>
           </a>
          </li>
         </ul>
        </li>
        <li class="toclevel-1 tocsection-8">
         <a href="#Unsupported_Bluetooth_Profiles">
          <span class="tocnumber">
           3
          </span>
          <span class="toctext">
           Unsupported Bluetooth Profiles
          </span>
         </a>
         <ul>
          <li class="toclevel-2 tocsection-9">
           <a href="#Message_Access_Profile_.28MAP.29">
            <span class="tocnumber">
             3.1
            </span>
            <span class="toctext">
             Message Access Profile (MAP)
            </span>
           </a>
          </li>
          <li class="toclevel-2 tocsection-10">
           <a href="#Personal_Area_Network_.28PAN.29">
            <span class="tocnumber">
             3.2
            </span>
            <span class="toctext">
             Personal Area Network (PAN)
            </span>
           </a>
          </li>
          <li class="toclevel-2 tocsection-11">
           <a href="#Hands-Free_Profile_.28HFP.29">
            <span class="tocnumber">
             3.3
            </span>
            <span class="toctext">
             Hands-Free Profile (HFP)
            </span>
           </a>
          </li>
          <li class="toclevel-2 tocsection-12">
           <a href="#Other_profiles">
            <span class="tocnumber">
             3.4
            </span>
            <span class="toctext">
             Other profiles
            </span>
           </a>
          </li>
         </ul>
        </li>
        <li class="toclevel-1 tocsection-13">
         <a href="#Bluetooth_profiles_supported_by_other_mobile_OSes">
          <span class="tocnumber">
           4
          </span>
          <span class="toctext">
           Bluetooth profiles supported by other mobile OSes
          </span>
         </a>
        </li>
        <li class="toclevel-1 tocsection-14">
         <a href="#Troubleshooting">
          <span class="tocnumber">
           5
          </span>
          <span class="toctext">
           Troubleshooting
          </span>
         </a>
        </li>
       </ul>
      </div>
      <h2>
       <span class="mw-headline" id="Pairing">
        Pairing
       </span>
      </h2>
      <div class="mw-highlight mw-content-ltr" dir="ltr">
       <pre><span></span><span class="gp">phone:~#</span> service bluetooth start
<span class="gp">phone:~#</span> bluetoothctl
<span class="go">Agent registered</span>
<span class="go">[CHG] Controller XX:XX:XX:XX:XX:XX Pairable: yes</span>
<span class="gp">[bluetooth]#</span> scan on
<span class="go">[NEW] 00:11:22:33:44:55</span>
<span class="gp">[bluetooth]#</span> pair <span class="m">00</span>:11:22:33:44:55
</pre>
      </div>
      <p>
       To use bluetooth headphones with pulseaudio, the package
       <code>
        pulseaudio-bluez
       </code>
       is required.
      </p>
      <h2>
       <span class="mw-headline" id="Supported_Bluetooth_Profiles">
        Supported Bluetooth Profiles
       </span>
      </h2>
      <h3>
       <span id="Audio/Video_Remote_Control_Profile_(AVRCP)">
       </span>
       <span class="mw-headline" id="Audio.2FVideo_Remote_Control_Profile_.28AVRCP.29">
        Audio/Video Remote Control Profile (AVRCP)
       </span>
      </h3>
      <p>
       To use media keys with Bluetooth, the
       <code>
        mpris-proxy
       </code>
       command should be run. It needs access to Dbus.
       <code>
        mpris-proxy
       </code>
       is started at boot to enable AVRCP 1.5 support. PulseAudio and BlueZ must be installed for this which pulls in
       <code>
        mpris-proxy
       </code>
       automatically.
MR at pmaports:
       <a class="external free" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/1804" rel="nofollow">
        https://gitlab.com/postmarketOS/pmaports/-/merge_requests/1804
       </a>
      </p>
      <h3>
       <span id="Advanced_Audio_Distribution_Profile_(A2DP)">
       </span>
       <span class="mw-headline" id="Advanced_Audio_Distribution_Profile_.28A2DP.29">
        Advanced Audio Distribution Profile (A2DP)
       </span>
      </h3>
      <p>
       PulseAudio and BlueZ handle together Bluetooth A2DP 1.3 support.
This is supported out-of-the-box.
      </p>
      <h3>
       <span id="PhoneBook_Access_Profile_(PBAP)">
       </span>
       <span class="mw-headline" id="PhoneBook_Access_Profile_.28PBAP.29">
        PhoneBook Access Profile (PBAP)
       </span>
      </h3>
      <p>
       BlueZ got PBAP 1.1 support recently in 5.63 with GNOME Evolution as backend.
Currently, a MR is pending at Alpine to enable this feature:
       <a class="external free" href="https://gitlab.alpinelinux.org/alpine/aports/-/merge_requests/29955" rel="nofollow">
        https://gitlab.alpinelinux.org/alpine/aports/-/merge_requests/29955
       </a>
      </p>
      <h3>
       <span id="Object_Push_Profile_(OPP)">
       </span>
       <span class="mw-headline" id="Object_Push_Profile_.28OPP.29">
        Object Push Profile (OPP)
       </span>
      </h3>
      <p>
       OBEXd was enabled at boot to enable OPP 1.2 support for transfering and receiving files over Bluetooth.
MR at pmaports:
       <a class="external free" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/2245" rel="nofollow">
        https://gitlab.com/postmarketOS/pmaports/-/merge_requests/2245
       </a>
      </p>
      <h3>
       <span id="Human_Interface_Device_Profile_(HID)">
       </span>
       <span class="mw-headline" id="Human_Interface_Device_Profile_.28HID.29">
        Human Interface Device Profile (HID)
       </span>
      </h3>
      <p>
       BlueZ provides the HID 1.0 profile to support mice and keyboards over Bluetooth.
It is enabled by default.
      </p>
      <h2>
       <span class="mw-headline" id="Unsupported_Bluetooth_Profiles">
        Unsupported Bluetooth Profiles
       </span>
      </h2>
      <h3>
       <span id="Message_Access_Profile_(MAP)">
       </span>
       <span class="mw-headline" id="Message_Access_Profile_.28MAP.29">
        Message Access Profile (MAP)
       </span>
      </h3>
      <p>
       BlueZ has support for MAP 1.0 but does not have a backend which is compatible with any UI stack.
The supported backends are from the old Nokia Maemo days.
      </p>
      <h3>
       <span id="Personal_Area_Network_(PAN)">
       </span>
       <span class="mw-headline" id="Personal_Area_Network_.28PAN.29">
        Personal Area Network (PAN)
       </span>
      </h3>
      <p>
       BlueZ supports PAN 1.0, but hasn't been tested or enabled in postmarketOS (yet).
      </p>
      <h3>
       <span id="Hands-Free_Profile_(HFP)">
       </span>
       <span class="mw-headline" id="Hands-Free_Profile_.28HFP.29">
        Hands-Free Profile (HFP)
       </span>
      </h3>
      <p>
       BlueZ and PulseAudio partly support HFP 1.6. Only the audio part is supported.
Reporting battery levels from the AG to HF is unsupported and all cellular operations and status reporting is not supported (yet).
A first step in fully supporting Bluetooth HFP 1.6 is taken here:
       <a class="external free" href="https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/631" rel="nofollow">
        https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/631
       </a>
      </p>
      <p>
       postmarketOS edge has the necessary patches applied to PulseAudio for supporting Bluetooth HFP AT commands (battery level reporting, cellular status, accept/reject calls, etc.), audio routing not yet.
Feedback is welcome in
       <a class="external free" href="https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/693" rel="nofollow">
        https://gitlab.freedesktop.org/pulseaudio/pulseaudio/-/merge_requests/693
       </a>
      </p>
      <h3>
       <span class="mw-headline" id="Other_profiles">
        Other profiles
       </span>
      </h3>
      <p>
       Bluetooth supports many other profiles, see
       <a class="external free" href="https://www.bluetooth.com/specifications/" rel="nofollow">
        https://www.bluetooth.com/specifications/
       </a>
       It is currently unknown if they are supported or not.
      </p>
      <h2>
       <span class="mw-headline" id="Bluetooth_profiles_supported_by_other_mobile_OSes">
        Bluetooth profiles supported by other mobile OSes
       </span>
      </h2>
      <ul>
       <li>
        Supported Bluetooth profiles by Apple:
        <a class="external free" href="https://support.apple.com/en-us/HT204387" rel="nofollow">
         https://support.apple.com/en-us/HT204387
        </a>
       </li>
       <li>
        Supported Bluetooth profile by Android:
        <a class="external free" href="https://source.android.com/devices/bluetooth/services" rel="nofollow">
         https://source.android.com/devices/bluetooth/services
        </a>
       </li>
      </ul>
      <h2>
       <span class="mw-headline" id="Troubleshooting">
        Troubleshooting
       </span>
      </h2>
      <p>
       <code>
        No default controller available
       </code>
      </p>
      <div class="mw-highlight mw-content-ltr" dir="ltr">
       <pre><span></span><span class="gp">#</span> modprobe -r btqcomsmd
<span class="gp">#</span> modprobe btqcomsmd
</pre>
      </div>
      <p>
       <code>
        Failed set serial line discipline: Invalid argument
       </code>
       in btattach or
       <code>
        Can't set line discipline: Invalid argument
       </code>
       in hciattach:
      </p>
      <p>
       Enable
       <code>
        CONFIG_BT_HCIUART
       </code>
       (and possibly
       <code>
        CONFIG_BT_HCIUART_BCM
       </code>
       ) in kernel config.
      </p>
      <p>
       <br/>
       <code>
        btattach -P bcm
       </code>
       doesn't set desired baud rate after uploading firmware:
      </p>
      <p>
       Use hciattach instead (
       <a class="external free" href="https://github.com/Arkq/bluez-alsa/issues/205" rel="nofollow">
        https://github.com/Arkq/bluez-alsa/issues/205
       </a>
       ) and verify results with
       <code>
        stty -F /dev/tty
       </code>
       .
      </p>
      <p>
       <br/>
       <code>
        Failed to start discovery: org.bluez.Error.NotReady
       </code>
       or
       <code>
        Failed to connect: org.bluez.Error.NotReady br-connection-adapter-not-powered
       </code>
      </p>
      <div class="mw-highlight mw-content-ltr" dir="ltr">
       <pre><span></span><span class="gp">[bluetooth]#</span> power on
<span class="go">Changing power on succeeded</span>
<span class="go">[CHG] Controller XX:XX:XX:XX:XX:XX Powered: yes</span>
</pre>
      </div>
      <p>
       <code>
        Failed to connect: org.bluez.Error.Failed br-connection-profile-unavailable
       </code>
       when connecting to a headset
      </p>
      <div class="mw-highlight mw-content-ltr" dir="ltr">
       <pre><span></span><span class="gp">#</span> apk add bluez-alsa
<span class="gp">#</span> service bluealsa start
<span class="gp">#</span> bluetoothctl
<span class="gp">[bluetooth]#</span> connect <span class="m">00</span>:11:22:33:44:55
<span class="go">Attempting to connect 00:11:22:33:44:55</span>
<span class="go">Connection successful</span>
<span class="go">[CHG] Device 00:11:22:33:44:55 ServicesResolved: yes</span>
</pre>
      </div>
     </div>
    </div>
    <div class="catlinks" data-mw="interface" id="catlinks">
     <div class="mw-normal-catlinks" id="mw-normal-catlinks">
      <a href="../Special:Categories.html" title="Special:Categories">
       Category
      </a>
      :
      <ul>
       <li>
        <a href="../en/Category:Technical_Reference.html" title="Category:Technical Reference">
         Technical Reference
        </a>
       </li>
      </ul>
     </div>
    </div>
    <div class="visualClear">
    </div>
   </div>
  </div>
  <div id="footer" role="contentinfo" style="margin: 0">
   <ul id="footer-info">
    <li>
     Retrieved from "
     <a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=Bluetooth&amp;oldid=30086">
      https://wiki.postmarketos.org/index.php?title=Bluetooth&amp;oldid=30086
     </a>
     "
    </li>
    <li id="footer-info-lastmod">
     This page was last edited on 8 August 2022, at 12:47.
    </li>
    <li id="footer-info-copyright">
     Content is available under
     <a class="external" href="https://creativecommons.org/licenses/by-sa/4.0/" rel="nofollow">
      Creative Commons Attribution-ShareAlike
     </a>
     unless otherwise noted.
    </li>
    <br/>
   </ul>
   <ul id="footer-places">
    <li id="footer-places-privacy">
     <a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">
      Privacy policy
     </a>
    </li>
    <li id="footer-places-about">
     <a class="mw-redirect" href="../en/About_postmarketOS.html" title="PostmarketOS:About">
      About postmarketOS
     </a>
    </li>
    <li id="footer-places-disclaimer">
     <a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">
      Disclaimers
     </a>
    </li>
    <li id="footer-places-mobileview">
     <a class="noprint stopMobileRedirectToggle" href="https://wiki.postmarketos.org/index.php?title=Bluetooth&amp;mobileaction=toggle_view_mobile">
      Mobile view
     </a>
    </li>
   </ul>
   <ul class="noprint" id="footer-icons">
    <li id="footer-copyrightico">
     <a href="https://creativecommons.org/licenses/by-sa/4.0/">
      <img alt="Creative Commons Attribution-ShareAlike" height="31" src="../cc-by-sa.png" width="88"/>
     </a>
    </li>
    <li id="footer-poweredbyico">
     <a href="https://www.mediawiki.org/">
      <img alt="Powered by MediaWiki" height="31" src="../poweredby_mediawiki_88x31.png" srcset="" width="88"/>
     </a>
    </li>
   </ul>
   <div style="clear: both;">
   </div>
  </div>
 </body>
</html>
