<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>PINE64 PinePhone (pine64-pinephone) - postmarketOS</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.34.2">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="postmarketOS (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-PINE64_PinePhone_pine64-pinephone rootpage-PINE64_PinePhone_pine64-pinephone skin-vector action-view">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">PINE64 PinePhone (pine64-pinephone)</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From postmarketOS</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<div role="note" class="note" style="padding: 5px 15px 0 15px; color: #705000; border: 1px solid #fde29b; background-color: #fdf1d1; margin-top: 5px;">
<p><b>Find and report PinePhone related issues <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues?label_name%5B%5D=device-pine64-pinephone">here</a>.</b> Join the <a href="../en/Matrix_and_IRC.html" title="Matrix and IRC">chat</a> if you have questions.
</p>
</div>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">PINE64 PinePhone</caption>
<tbody>
<tr class=""><td colspan="2" class="" style="text-align:center;">
<a href="../Pinephone-plasma-mobile.jpg" class="image"><img alt="PinePhone running Plasma Mobile" src="../Pinephone-plasma-mobile.jpg" decoding="async" width="200" height="311" srcset="../plasma-mobile.jpg 1.5x"></a><br><span style="">PinePhone running Plasma Mobile</span>
</td></tr>
<tr class="">
<th scope="row" style="text-align:left;">Manufacturer</th>
    <td class="" style="">
PINE64</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Name</th>
    <td class="" style="">
PinePhone</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Codename</th>
    <td class="" style="">
pine64-pinephone</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Released</th>
    <td class="" style="">
2019</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Category</th>
    <td class="" style="">
main</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Original software</th>
    <td class="" style="">
postmarketOS</td>
</tr>
<tr><th colspan="2" class="" style="text-align:center;">Hardware</th></tr>
<tr class="">
<th scope="row" style="text-align:left;">Chipset</th>
    <td class="" style="">
<a href="../en/Allwinner_A64.html" title="Allwinner A64">Allwinner A64</a>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">CPU</th>
    <td class="" style="">
4x 1152 MHz Cortex-A53</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPU</th>
    <td class="" style="">
Mali-400 MP2</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Display</th>
    <td class="" style="">
720x1440 IPS</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Storage</th>
    <td class="" style="">
16 GB / 32 GB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Memory</th>
    <td class="" style="">
2 GB / 3 GB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Architecture</th>
    <td class="" style="">
aarch64</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Type</th>
    <td class="" style="">
phone</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Unixbench Whet/Dhry score</th>
    <td class="" style="">
1314.3</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Features</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="After connecting the device with USB to your PC, you can connect to it via telnet (initramfs) or SSH (booted system).">USB Networking</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="It is possible to flash the device with `pmbootstrap flasher`.">Flashing</abbr></th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Touchscreen</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Display works. Ideally with sleep mode and brightness control.">Display</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">WiFi</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Full disk encryption and unlocking with osk-sdl.">FDE</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Instead of a Linux kernel fork, it is possible to run mainline.">Mainline</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Charging and battery level reporting works">Battery</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">3D Acceleration</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Audio playback, microphone, headset and buttons.">Audio</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Bluetooth</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Camera</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPS</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Mobile data</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">SMS</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Calls</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">USB OTG</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">NFC</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Sensors</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Auto screen rotation works in desktops e.g. Phosh or Plasma Mobile">Accelerometer</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Magnetometer</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ambient Light</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Proximity</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Also known as flip cover sensor">Hall Effect</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Barometer</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Power Sensor</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Misc</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;">Camera Flash</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Keyboard</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Touchpad</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Full-sized USB-A port works (Usually applicable to SBCs and laptops).">USB-A</abbr></th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Video and audio output with HDMI or Display Port works.">HDMI/DP</abbr></th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ir TX</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ir RX</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Stylus</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Haptics</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ethernet</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">FOSS bootloader</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<p><br>
</p>
<p><br>
</p>
<div class="thumb tright"><div class="thumbinner" style="width:202px;">
<a href="../Pinephone-ondev-sd-to-emmc.jpeg" class="image"><img alt="" src="../Pinephone-ondev-sd-to-emmc.jpeg" decoding="async" width="200" height="267" class="thumbimage" srcset="../300px-Pinephone-ondev-sd-to-emmc.jpeg 1.5x ../400px-Pinephone-ondev-sd-to-emmc.jpeg 2x"></a>  <div class="thumbcaption">
<div class="magnify"><a href="../Pinephone-ondev-sd-to-emmc.jpeg" class="internal" title="Enlarge"></a></div>On-device installer asking whether to install to SD or eMMC.</div>
</div></div> 
<p>The <a rel="nofollow" class="external text" href="https://www.pine64.org/pinephone/">PinePhone</a> is a smartphone by PINE64. The postmarketOS vendor and device names are "pine64" and "pinephone" respectively. The back panel can be lifted off by pulling at the notch on the bottom-right corner of the phone. This exposes the battery, microSD and SIM slots, and DIP switches. It comes with a 3000mAh battery and uses the same form-factor as the Samsung Galaxy J7 (2015) for replacement.
</p>
<p>The PinePhone will <a rel="nofollow" class="external text" href="https://wiki.pine64.org/wiki/PinePhone_Installation_Instructions#Boot_priority">boot</a> from a bootable microSD card if it is present otherwise it will fall back to booting from internal eMMC.
</p>
<div id="toc" class="toc">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2>Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Contributors"><span class="tocnumber">1</span> <span class="toctext">Contributors</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Installation"><span class="tocnumber">2</span> <span class="toctext">Installation</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#Serial_console"><span class="tocnumber">3</span> <span class="toctext">Serial console</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#Hardware_switches"><span class="tocnumber">4</span> <span class="toctext">Hardware switches</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#Expansion_port"><span class="tocnumber">5</span> <span class="toctext">Expansion port</span></a></li>
<li class="toclevel-1 tocsection-6">
<a href="#Components"><span class="tocnumber">6</span> <span class="toctext">Components</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#Cameras"><span class="tocnumber">6.1</span> <span class="toctext">Cameras</span></a></li>
<li class="toclevel-2 tocsection-8"><a href="#Camera_Flash"><span class="tocnumber">6.2</span> <span class="toctext">Camera Flash</span></a></li>
<li class="toclevel-2 tocsection-9"><a href="#WiFi"><span class="tocnumber">6.3</span> <span class="toctext">WiFi</span></a></li>
<li class="toclevel-2 tocsection-10"><a href="#Bluetooth"><span class="tocnumber">6.4</span> <span class="toctext">Bluetooth</span></a></li>
<li class="toclevel-2 tocsection-11">
<a href="#Modem"><span class="tocnumber">6.5</span> <span class="toctext">Modem</span></a>
<ul>
<li class="toclevel-3 tocsection-12"><a href="#VoLTE"><span class="tocnumber">6.5.1</span> <span class="toctext">VoLTE</span></a></li>
<li class="toclevel-3 tocsection-13"><a href="#GNSS.2FGPS"><span class="tocnumber">6.5.2</span> <span class="toctext">GNSS/GPS</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-14"><a href="#Sensors"><span class="tocnumber">6.6</span> <span class="toctext">Sensors</span></a></li>
<li class="toclevel-2 tocsection-15"><a href="#RGB_Led"><span class="tocnumber">6.7</span> <span class="toctext">RGB Led</span></a></li>
<li class="toclevel-2 tocsection-16">
<a href="#Audio"><span class="tocnumber">6.8</span> <span class="toctext">Audio</span></a>
<ul>
<li class="toclevel-3 tocsection-17"><a href="#Speakers"><span class="tocnumber">6.8.1</span> <span class="toctext">Speakers</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-18"><a href="#USB_Host_.28OTG.29"><span class="tocnumber">6.9</span> <span class="toctext">USB Host (OTG)</span></a></li>
<li class="toclevel-2 tocsection-19">
<a href="#RAM"><span class="tocnumber">6.10</span> <span class="toctext">RAM</span></a>
<ul>
<li class="toclevel-3 tocsection-20"><a href="#Changing_the_Clock_Frequency"><span class="tocnumber">6.10.1</span> <span class="toctext">Changing the Clock Frequency</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-21">
<a href="#eMMC"><span class="tocnumber">6.11</span> <span class="toctext">eMMC</span></a>
<ul>
<li class="toclevel-3 tocsection-22">
<a href="#Increasing_eMMC_speed_.28Vccq_mod.29"><span class="tocnumber">6.11.1</span> <span class="toctext">Increasing eMMC speed (Vccq mod)</span></a>
<ul>
<li class="toclevel-4 tocsection-23"><a href="#Hardware_modification_steps"><span class="tocnumber">6.11.1.1</span> <span class="toctext">Hardware modification steps</span></a></li>
<li class="toclevel-4 tocsection-24"><a href="#Notes"><span class="tocnumber">6.11.1.2</span> <span class="toctext">Notes</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-2 tocsection-25"><a href="#Magnetometer"><span class="tocnumber">6.12</span> <span class="toctext">Magnetometer</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-26">
<a href="#Troubleshooting"><span class="tocnumber">7</span> <span class="toctext">Troubleshooting</span></a>
<ul>
<li class="toclevel-2 tocsection-27"><a href="#Modem.27s_SMS_cache_is_full_and_cannot_receive_SMS"><span class="tocnumber">7.1</span> <span class="toctext">Modem's SMS cache is full and cannot receive SMS</span></a></li>
<li class="toclevel-2 tocsection-28"><a href="#Qt_Based_Browsers_Not_Loading_Web_Pages"><span class="tocnumber">7.2</span> <span class="toctext">Qt Based Browsers Not Loading Web Pages</span></a></li>
<li class="toclevel-2 tocsection-29">
<a href="#Boot_related"><span class="tocnumber">7.3</span> <span class="toctext">Boot related</span></a>
<ul>
<li class="toclevel-3 tocsection-30">
<a href="#Fix_broken_boot_partition"><span class="tocnumber">7.3.1</span> <span class="toctext">Fix broken boot partition</span></a>
<ul>
<li class="toclevel-4 tocsection-31"><a href="#Boot_partition_on_eMMC"><span class="tocnumber">7.3.1.1</span> <span class="toctext">Boot partition on eMMC</span></a></li>
<li class="toclevel-4 tocsection-32"><a href="#Boot_partition_on_SD_card"><span class="tocnumber">7.3.1.2</span> <span class="toctext">Boot partition on SD card</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-33">
<a href="#Fix_U-Boot"><span class="tocnumber">7.3.2</span> <span class="toctext">Fix U-Boot</span></a>
<ul>
<li class="toclevel-4 tocsection-34"><a href="#postmarketOS_installed_to_eMMC"><span class="tocnumber">7.3.2.1</span> <span class="toctext">postmarketOS installed to eMMC</span></a></li>
<li class="toclevel-4 tocsection-35"><a href="#postmarketOS_installed_to_SD"><span class="tocnumber">7.3.2.2</span> <span class="toctext">postmarketOS installed to SD</span></a></li>
</ul>
</li>
<li class="toclevel-3 tocsection-36"><a href="#Failed_to_create_boot.2Fxxx:_No_space_left_on_device"><span class="tocnumber">7.3.3</span> <span class="toctext">Failed to create boot/xxx: No space left on device</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-37"><a href="#See_also"><span class="tocnumber">8</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h3><span class="mw-headline" id="Contributors">Contributors</span></h3>
<ul>
<li><i><a href="../User:MartijnBraam.html" title="User:MartijnBraam">MartijnBraam</a></i></li>
<li><i><a href="../User:Z3ntu.html" title="User:Z3ntu">z3ntu</a></i></li>
<li><i><a href="/index.php?title=User:Bshah&amp;action=edit&amp;redlink=1" class="new" title="User:Bshah (page does not exist)">bshah</a></i></li>
<li><i><a href="../User:Ollieparanoid.html" title="User:Ollieparanoid">ollieparanoid</a></i></li>
<li>(and many more!)</li>
</ul>
<p><br>
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>The recommended installation method is flashing a pre-built installer image to the SD card, as described in the <a href="../en/Installation.html" title="Installation">Installation</a> article.
</p>
<p>Apparently for some users the touch screen does not work with the v22.12 installation image. If you are affected, please help tracking this down in <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/postmarketos-ondev/-/issues/60">postmarketos-ondev#60</a>. You can work around this by using a <a rel="nofollow" class="external text" href="https://images.postmarketos.org/bpo/v22.06/pine64-pinephone/">v22.06</a> installer image and <a href="../en/Upgrade_to_a_newer_postmarketOS_release.html" title="Upgrade to a newer postmarketOS release">upgrading</a> to the latest release. Or by building your own image with <a href="../en/Pmbootstrap.html" title="Pmbootstrap">pmbootstrap</a>.
</p>
<p>As of writing, CPU idle states are not entered when booting from eMMC on both v22.12 and edge, leading to fast battery drain (<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues/1946">pmaports#1946</a>). A workaround is installing to SD card. Help with resolving this is appreciated, see e.g. discussions in <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/3931">pmaports!3931</a>.
</p>
<p>It is also possible to flash postmarketOS to the PinePhone with <a href="../en/JumpDrive.html" title="JumpDrive">JumpDrive</a>.
</p>
<h2><span class="mw-headline" id="Serial_console">Serial console</span></h2>
<p>The PinePhone has a serial port in the headphone connector, it's activated by the 6th contact on the DIP switch. If the switch is on then the headphone connector is in audio mode, if it's off then it's in UART mode.
</p>
<p>The uart is 115200n8
</p>
<p>The pinout for the serial connector on the headphone jack is:
</p>
<ul>
<li>Tip: RX</li>
<li>Ring: TX</li>
<li>Sleeve: GND</li>
</ul>
<p>The serial connection is 3.3V
</p>
<p>You can also buy the debug cable from <a rel="nofollow" class="external text" href="https://store.pine64.org">PINE64 Store</a>.
The store cable uses a 4 ring plug, as seen in the <a rel="nofollow" class="external text" href="http://files.pine64.org/doc/pinebook/guide/Pinebook_Earphone_Serial_Console_Developer_Guide.pdf">PDF</a>, but a 3 ring plug works just as well.
</p>
<p><a href="../PinePhone-main-board.jpg" class="image"><img alt="PinePhone-main-board.jpg" src="../PinePhone-main-board.jpg" decoding="async" width="300" height="243" srcset="../450px-PinePhone-main-board.jpg 1.5x ../600px-PinePhone-main-board.jpg 2x"></a>
</p>
<h2><span class="mw-headline" id="Hardware_switches">Hardware switches</span></h2>
<p>There's a 6 contact DIP switch on the back of the phone underneath the back cover. The 6 switches are for enabling/disabling hardware components. The switch has tiny numbers 1-6 beneath the contacts, moving the contact up sets that contact on. 
</p>
<table class="wikitable">
<tbody>
<tr>
<th>#
</th>
<th>Off
</th>
<th>On
</th>
</tr>
<tr>
<td>1
</td>
<td>Modem disabled
</td>
<td>Modem enabled
</td>
</tr>
<tr>
<td>2
</td>
<td>Wifi/BT disabled
</td>
<td>Wifi/BT enabled
</td>
</tr>
<tr>
<td>3
</td>
<td>Microphone disabled
</td>
<td>Microphone enabled
</td>
</tr>
<tr>
<td>4
</td>
<td>Rear camera disabled
</td>
<td>Rear camera enabled
</td>
</tr>
<tr>
<td>5
</td>
<td>Front camera disabled
</td>
<td>Front camera enabled
</td>
</tr>
<tr>
<td>6
</td>
<td>Headphone UART mode
</td>
<td>Headphone audio mode
</td>
</tr>
</tbody>
</table>
<h2><span class="mw-headline" id="Expansion_port">Expansion port</span></h2>
<p>There is a 2x3 grid of pogo pins on the back of the PinePhone for connecting a back cover with extra hardware like an extended battery case or a keyboard case. The pinout for this connector:
</p>
<table class="wikitable">
<tbody>
<tr>
<td>Interrupt
</td>
<td>SDA
</td>
<td>SCL
</td>
</tr>
<tr>
<td>5V / VBUS
</td>
<td>VBAT
</td>
<td>GND
</td>
</tr>
</tbody>
</table>
<p>The VBUS pin is powered by USB and is 5V. The second power pin is VBAT, which connects to the battery voltage. The I2C and interrupt lines have pull-ups on the phone side. The I2C lines are pulled up to 3V3 by the phone.
</p>
<h2><span class="mw-headline" id="Components">Components</span></h2>
<table class="wikitable">
<tbody>
<tr>
<th>Component
</th>
<th>Model
</th>
<th>Driver
</th>
</tr>
<tr>
<td>Touchscreen
</td>
<td>Goodix GT917S
</td>
<td>TOUCHSCREEN_GOODIX
</td>
</tr>
<tr>
<td>Rear camera
</td>
<td>OmniVision OV5640
</td>
<td>VIDEO_OV5640
</td>
</tr>
<tr>
<td>Camera flash
</td>
<td>SGMICRO SGM3140
</td>
<td>LEDS_SGM3140
</td>
</tr>
<tr>
<td>Front camera
</td>
<td>GalaxyCore GC2145
</td>
<td>Nope
</td>
</tr>
<tr>
<td>LCD
</td>
<td>Xingbangda XBD599
</td>
<td>CONFIG_DRM_PANEL_XINGBANGDA_XBD599
</td>
</tr>
<tr>
<td>WiFi
</td>
<td>Realtek RTL8723CS
</td>
<td>RTL8723CS
</td>
</tr>
<tr>
<td>Bluetooth
</td>
<td>Realtek RTL8723CS
</td>
<td>BT_HCIUART_RTL
</td>
</tr>
<tr>
<td>Modem
</td>
<td>Quectel EC25-G
</td>
<td>USB_NET_QMI_WWAN
</td>
</tr>
<tr>
<td>GNSS/GPS
</td>
<td>Quectel EC25-G
</td>
<td>CONFIG_USB_SERIAL_OPTION
</td>
</tr>
<tr>
<td>Magnetometer
</td>
<td>ST LIS3MDL
</td>
<td>IIO_ST_MAGN_3AXIS
</td>
</tr>
<tr>
<td>Ambient light / Proximity
</td>
<td>SensorTek STK3335
</td>
<td>STK3310
</td>
</tr>
<tr>
<td>Sixaxis
</td>
<td>InvenSense MPU-6050
</td>
<td>INV_MPU6050_I2C
</td>
</tr>
<tr>
<td>Vibration motor
</td>
<td>Unknown model
</td>
<td>INPUT_GPIO_VIBRA
</td>
</tr>
<tr>
<td>Notification LED
</td>
<td>LED0603RGB
</td>
<td>LEDS_GPIO
</td>
</tr>
<tr>
<td>Volume buttons
</td>
<td>Buttons connected to the KEYADC
</td>
<td>KEYBOARD_SUN4I_LRADC
</td>
</tr>
<tr>
<td>Power button
</td>
<td>X-Powers AXP803
</td>
<td>INPUT_AXP20X_PEK
</td>
</tr>
<tr>
<td>Battery fuel gauge
</td>
<td>X-Powers AXP803
</td>
<td>BATTERY_AXP20X
</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<h3><span class="mw-headline" id="Cameras">Cameras</span></h3>
<p>Currently only the rear camera (OV5640) has mainline Linux support, a driver for the front camera (GC2145) is being developed in the kernel fork for the phone development.
</p>
<p>Megapixels is the defacto camera program for the PinePhone, and supports both the front and rear cameras, autofocus for the rear camera, and postprocessing options to make the images better.
</p>
<p>Another alternative is to use <code>media-ctl</code>. The camera hardware pipeline is controlled with <code>/dev/media1</code> and the result is on <code>/dev/video3</code>
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="go">Enable the rear camera and disable the front camera</span>
<span class="gp">pinephone:~#</span> media-ctl -d /dev/media1 --links <span class="s1">'"gc2145 4-003c":0-&gt;"sun6i-csi-bridge":0[0]'</span>
<span class="gp">pinephone:~#</span> media-ctl -d /dev/media1 --links <span class="s1">'"ov5640 4-004c":0-&gt;"sun6i-csi-bridge":0[1]'</span>

<span class="go">Set image parameters on the rear camera entity</span>
<span class="gp">pinephone:~#</span> media-ctl -d /dev/media1 --set-v4l2 <span class="s1">'"ov5640 4-004c":0[fmt:UYVY8_2X8/1280x720]'</span>

<span class="go">Verify connections</span>
<span class="gp">pinephone:~#</span> media-ctl -d /dev/media1 -p

<span class="go">...</span>
<span class="go">Device topology</span>
<span class="go">- entity 1: sun6i-csi-bridge (2 pads, 3 links)</span>
<span class="go">            type V4L2 subdev subtype Unknown flags 0</span>
<span class="go">            device node name /dev/v4l-subdev0</span>
<span class="go">	pad0: Sink</span>
<span class="go">		[fmt:UYVY8_2X8/1280x720 field:none colorspace:srgb xfer:srgb ycbcr:601 quantization:full-range]</span>
<span class="go">		&lt;- "gc2145 4-003c":0 []</span>
<span class="go">		&lt;- "ov5640 4-004c":0 [ENABLED]</span>
<span class="go">...</span>

<span class="go">Take the picture</span>
<span class="gp">pinephone:~#</span> ffmpeg -s 1280x720 -f video4linux2 -i /dev/video3 -vframes <span class="m">1</span> selfie.jpg
</pre></div>
<div class="floatnone"><a href="../Rose.jpg" class="image"><img alt="Rose.jpg" src="../Rose.jpg" decoding="async" width="400" height="300" srcset="../Rose.jpg 1.5x ../Rose.jpg 2x"></a></div>
<h3><span class="mw-headline" id="Camera_Flash">Camera Flash</span></h3>
<p><i>Please note, that the driver for the sgm3140 is not yet included in the main kernel source and as such is not available for use yet without compiling the module yourself.</i>
</p>
<p>The camera flash consist out of a SG Micro SGM3140 "500mA Buck/Boost Charge Pump LED Driver" and a EHP-C04 LED. It supports Flash and Torch mode, the first being brighter but only for 200-300ms, when it switches to Torch mode automatically. Torch mode is lower brightness but can be turned on continuously.
</p>
<p>Controlling the flash from user space is possible via sysfs and via v4l2:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> Torch on
<span class="gp">$</span> <span class="nb">echo</span> <span class="m">1</span> &gt; /sys/class/leds/white<span class="se">\:</span>flash/brightness
<span class="gp">#</span> Torch off
<span class="gp">$</span> <span class="nb">echo</span> <span class="m">0</span> &gt; /sys/class/leds/white<span class="se">\:</span>flash/brightness
<span class="gp">#</span> Activate flash
<span class="gp">$</span> <span class="nb">echo</span> <span class="m">1</span> &gt; /sys/class/leds/white<span class="se">\:</span>flash/flash_strobe
</pre></div>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> Torch on
<span class="gp">$</span> v4l2-ctl -d /dev/video1 -c <span class="nv">led_mode</span><span class="o">=</span><span class="m">2</span>
<span class="gp">#</span> Torch off
<span class="gp">$</span> v4l2-ctl -d /dev/video1 -c <span class="nv">led_mode</span><span class="o">=</span><span class="m">0</span>
<span class="gp">#</span> Activate flash
<span class="gp">$</span> v4l2-ctl -d /dev/video1 -c <span class="nv">led_mode</span><span class="o">=</span><span class="m">1</span>
<span class="gp">$</span> v4l2-ctl -d /dev/video1 -c <span class="nv">strobe</span><span class="o">=</span><span class="m">1</span>
</pre></div>
<h3><span class="mw-headline" id="WiFi">WiFi</span></h3>
<p>The wifi uses the rtl8723cs driver and is functional. There is still an issue with the driver not reloading correctly when the SoC is put into suspend mode, this can be worked around by reloading the kernel module:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">pinephone:~#</span> sudo rmmod 8723cs
<span class="gp">pinephone:~#</span> sudo modprobe 8723cs
</pre></div>
<h3><span class="mw-headline" id="Bluetooth">Bluetooth</span></h3>
<p>Main article: <a href="../en/Bluetooth.html" title="Bluetooth">Bluetooth</a>.
</p>
<p>The bluetooth connection is handled by the wifi chipset. It is functional but there is no integration in Plasma Mobile yet. To pair a bluetooth device start the bluetooth service and use bluetoothctl to connect.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">pinephone:~#</span> sudo service bluetooth start
<span class="gp">pinephone:~#</span> bluetoothctl
<span class="gp">#</span> scan on
<span class="go">[NEW] 00:11:22:33:44:55</span>
<span class="gp">#</span> pair <span class="m">00</span>:11:22:33:44:55
</pre></div>
<p>To use bluetooth headphones with pulseaudio, the package <code>pulseaudio-bluez</code> is required.
</p>
<h3><span class="mw-headline" id="Modem">Modem</span></h3>
<p>Receiving and sending text messages works, The calls work but there are some issues left with the audio routing. Mobile data is functional.
For information on audio routing and setting up the modem in <a href="../en/Phosh.html" title="Phosh">Phosh</a>, see the specific article.
</p>
<p>To bring up mobile data run the following commands (for plasma mobile):
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">pinephone:~#</span> sudo apk add ofonoctl
<span class="gp">pinephone:~#</span> ofonoctl wan --connect --append-dns
</pre></div>
<p>Or use only modemmanager which integrates better with Phosh.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">pinephone:~#</span> sudo mmcli -m <span class="m">0</span> --create-bearer<span class="o">=</span><span class="s1">'apn=APN.NAME,user=USERNAME,password=PASSWORD,allowed-auth=chap,allow-roaming=no'</span>
<span class="gp">pinephone:~#</span> sudo nmcli c add <span class="nb">type</span> gsm ifname cdc-wdm0 con-name OPERATOR-NAME apn APN.NAME user USERNAME password PASSWORD

<span class="gp">#</span> Check your connection
<span class="gp">pinephone:~#</span> nmcli c   <span class="c1"># check status of the connection named OPERATOR-NAME as above</span>
<span class="gp">pinephone:~#</span> nmcli d    <span class="c1">#  check status of cdc-wdm0</span>
</pre></div>
<p>In order to connect to the serial console of the modem, you need a terminal application. One option is to use <code>minicom</code>.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> apk add minicom
</pre></div>
<p>Connect to the console by issuing:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> minicom -D /dev/ttyUSB2
</pre></div>
<p>The command <code>AT</code> returns OK:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="go">AT</span>
<span class="go">OK</span>
</pre></div>
<p>The command <code>ATI</code> returns some version information from the modem:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="go">ATI</span>
<span class="go">Quectel</span>
<span class="go">EG25</span>
<span class="go">Revision: EG25GGBR07A07M2G</span>

<span class="go">OK</span>
</pre></div>
<p>The command <code>AT+QDAI</code> (Digital Audio Interface Configure) is used to configure the digital audio interface. <code>AT+QDAI?</code> returns the current configuration:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="go">AT+QDAI?</span>
<span class="go">+QDAI: 3,0,0,4,0,0,1,1</span>

<span class="go">OK</span>
</pre></div>
<p><br>
Some more details on how to configure the modem is available <a rel="nofollow" class="external text" href="https://megous.com/dl/tmp/modem.txt">here</a>. The reference for the available commands is the <a rel="nofollow" class="external text" href="https://itbrainpower.net/downloadables/Quectel_EC25_EC21_AT_Commands_Manual_V1.0.pdf">EC25 &amp; EC21 AT Commands Manual</a>.
</p>
<h4><span class="mw-headline" id="VoLTE">VoLTE</span></h4>
<p>The EG25 modem in the PinePhone comes preloaded with VoLTE profiles for a few providers. The modem can handle VoLTE fully internally so nothing complicated is required on the postmarketOS side. PostmarketOS tries to set the VoLTE profile automatically. If that fails it can also be set manually:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> List of embedded VoLTE profiles
<span class="gp">$</span> <span class="nb">echo</span> <span class="s1">'AT+QMBNCFG="list"'</span> <span class="p">|</span> atinout - /dev/EG25.AT -
<span class="go">+QMBNCFG: "List",0,1,1,"ROW_Generic_3GPP",0x0501081F,201901141</span>
<span class="go">+QMBNCFG: "List",1,0,0,"VoLTE-ATT",0x0501033C,201909271</span>
<span class="go">+QMBNCFG: "List",2,0,0,"hVoLTE-Verizon",0x05010141,201911251</span>
<span class="go">+QMBNCFG: "List",3,0,0,"Sprint-VoLTE",0x05010205,201908141</span>
<span class="go">+QMBNCFG: "List",4,0,0,"Commercial-TMO_VoLTE",0x05010505,201811231</span>
<span class="go">+QMBNCFG: "List",5,0,0,"Telus-Commercial_VoLTE",0x05800C43,201912031</span>
<span class="go">+QMBNCFG: "List",6,0,0,"Commercial-SBM",0x05011C18,201904021</span>
<span class="go">+QMBNCFG: "List",7,0,0,"Commercial-DT",0x05011F1C,201905311</span>
<span class="go">+QMBNCFG: "List",8,0,0,"Reliance_OpnMkt",0x05011B38,201910161</span>
<span class="go">+QMBNCFG: "List",9,0,0,"TF_Germany_VoLTE",0x05010C1B,201909201</span>
<span class="go">+QMBNCFG: "List",10,0,0,"TF_Spain_VoLTE",0x05010CFA,201909261</span>
<span class="go">+QMBNCFG: "List",11,0,0,"Volte_OpenMkt-Commercial-CMCC",0x05012071,201904281</span>
<span class="go">+QMBNCFG: "List",12,0,0,"OpenMkt-Commercial-CT",0x05011322,201911081</span>
<span class="go">+QMBNCFG: "List",13,0,0,"OpenMkt-Commercial-CU",0x05011505,201807052</span>

<span class="go">OK</span>

<span class="gp">#</span> Select the profile most applicable to your provider, or use the Generic one <span class="k">if</span> nothing matches
<span class="gp">$</span> <span class="nb">echo</span> <span class="s1">'AT+QMBNCFG="select","ROW_Generic_3GPP"'</span> <span class="p">|</span> atinout - /dev/EG25.AT -

<span class="go">OK</span>
<span class="gp">#</span> Enable calling over ip <span class="o">(</span>VoLTE<span class="o">)</span>
<span class="gp">$</span> <span class="nb">echo</span> <span class="s1">'AT+QCFG="ims",1'</span> <span class="p">|</span> atinout - /dev/EG25.AT -

<span class="go">OK</span>
<span class="gp">#</span> Reboot the modem to apply the settings
<span class="gp">$</span> <span class="nb">echo</span> <span class="s1">'AT+CFUN=1,1'</span> <span class="p">|</span> atinout - /dev/EG25.AT -
</pre></div>
<p>After this process VoLTE should be used when available. To check the status while in a call you can run the CLCC command:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> <span class="nb">echo</span> <span class="s1">'AT+CLCC'</span> <span class="p">|</span> atinout - /dev/EG25.AT -

<span class="go">+CLCC: 1,1,0,1,0,"",128</span>
<span class="go">+CLCC: 2,1,0,1,0,"",128</span>

<span class="go">OK</span>
</pre></div>
<p>The "1" in the 4th column on the second CLCC row means it's currently calling with VoLTE, when it's "0" it's calling over the legacy phone network.
</p>
<h4>
<span id="GNSS/GPS"></span><span class="mw-headline" id="GNSS.2FGPS">GNSS/GPS</span>
</h4>
<p>The Quectel EG25-G modem has a builtin GNSS receiver for GPS, GLONASS, Galileo and BeiDou.
The default configuration on postmarketOS is to enable GPS and GLONASS as they work the best on the Quectel EG25-G when location services are needed.
</p>
<p>When ModemManager is used with this modem, GeoClue will ask ModemManager to enable the GNSS receiver on demand.
Only if a GeoClue client asks for a high accuracy position, GeoClue will make use of the GNSS receiver.
In all other cases, GeoClue will use the WiFi/Cellular positioning together with Mozilla data.
</p>
<p>You can use the <code>where-am-i</code> demo of GeoClue to play around with the GNSS receiver.
</p>
<p><code>mmcli --help-location</code>  provides also a set of commands which allow you to manually enable/disable the GNSS receiver or print your location.
</p>
<h3><span class="mw-headline" id="Sensors">Sensors</span></h3>
<p>All sensors work and are accessible as Industrial I/O (iio) devices in Linux. To query the data you can cat the files in `/sys/bus/iio/` to make the kernel module query the sensors
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">pinephone:~#</span> cat /sys/bus/iio/devices/iio<span class="se">\:</span>device0/name
<span class="go">mpu6050</span>
<span class="gp">pinephone:~#</span> cat /sys/bus/iio/devices/iio<span class="se">\:</span>device0/in_accel_z_raw
<span class="go">-17594</span>
<span class="gp">pinephone:~#</span> <span class="nb">echo</span> <span class="s2">"Verified gravity still exists"</span>
</pre></div>
<h3><span class="mw-headline" id="RGB_Led">RGB Led</span></h3>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> Activate LED
<span class="go">echo 1 &gt; /sys/class/leds/$COLOR/brightness</span>
<span class="gp">#</span> Deactivate LED
<span class="go">echo 0 &gt; /sys/class/leds/$COLOR/brightness</span>
</pre></div>
<p>You may turn on and off the blue led by issuing:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> <span class="nb">echo</span> <span class="m">1</span> &gt;/sys/devices/platform/leds/leds/pinephone<span class="se">\:</span>blue<span class="se">\:</span>user/brightness
<span class="gp">#</span> <span class="nb">echo</span> <span class="m">0</span> &gt;/sys/devices/platform/leds/leds/pinephone<span class="se">\:</span>blue<span class="se">\:</span>user/brightness
</pre></div>
<p>Make sure you run these commands as root (<code>sudo -i</code>). For user,<br>
<code>echo 1 | sudo tee /sys/devices/platform/leds/leds/pinephone\:blue\:user/brightness</code> works but<br>
<code>sudo echo 1 &gt;/sys/devices/platform/leds/leds/pinephone\:blue\:user/brightness</code> won't work.
</p>
<h3><span class="mw-headline" id="Audio">Audio</span></h3>
<h4><span class="mw-headline" id="Speakers">Speakers</span></h4>
<p>Sound output should work after unmuting <code>AIF1 Slot 0 digital</code>
</p>
<p>Start by making sure alsa-utils are installed:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> sudo apk add alsa-utils
</pre></div>
<p>You may use amixer, or alsamixer to unmute the required channels, and to control the volume:
</p>
<p>Amixer:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> amixer scontents
<span class="gp">$</span> amixer sset Master unmute
</pre></div> 
<p>Alsamixer (use terminal keyboard input to use up/down/left/right keys, to set volume and select devices):
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> alsamixer -V all
</pre></div>
<p>Test the sound output by issuing:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> speaker-test -c3
</pre></div>
<h3>
<span id="USB_Host_(OTG)"></span><span class="mw-headline" id="USB_Host_.28OTG.29">USB Host (OTG)</span>
</h3>
<p>For hardware revisions v1.0 and v1.1, USB OTG is broken and require soldering skills.
</p>
<p>Since <a rel="nofollow" class="external text" href="https://wiki.pine64.org/wiki/PinePhone_v1.2">revision v1.2</a>, USB OTG should works fine.
</p>
<h3><span class="mw-headline" id="RAM">RAM</span></h3>
<h4><span class="mw-headline" id="Changing_the_Clock_Frequency">Changing the Clock Frequency</span></h4>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">Only change the RAM clock frequency if you know what you are doing. Otherwise you will probably break your installation and need to reinstall postmarketOS!</td>
</tr></tbody></table>
<p>postmarketOS runs with a RAM clock of 528 MHz to be most compatible with all PinePhones. Some PinePhones support higher RAM clock frequencies, and if you know what you are doing you can change it by replacing 528 with 552 and even 624.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> update-u-boot -r <span class="m">528</span>
</pre></div>
<p>Find the frequency your PinePhone is currently running at in <code>/proc/device-tree/memory/ram_freq</code>.
</p>
<p>Details in <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/1998">pmaports!1998</a>. Author of the patches BobbyTheBuilder also made a <a rel="nofollow" class="external text" href="https://odysee.com/@Newbyte:7/pp_sd:b">side-by-side video</a>.
</p>
<h3><span class="mw-headline" id="eMMC">eMMC</span></h3>
<h4>
<span id="Increasing_eMMC_speed_(Vccq_mod)"></span><span class="mw-headline" id="Increasing_eMMC_speed_.28Vccq_mod.29">Increasing eMMC speed (Vccq mod)</span>
</h4>
<table role="text container" style="color: inherit; background-color: #fee7e6; border: 1px solid #d33; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Icon" src="../Red_warning_icon.svg" decoding="async" title="Icon" width="20" height="20" srcset="../Red_warning_icon.svg 1.5x ../Red_warning_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">
<b>WARNING:</b> Neither PINE64 nor postmarketOS takes any responsibility for any modification the user applies. The hardware modification is not supported on all eMMCs - specific eMMCs won't work anymore after doing the hardware mod. The user is obliged to check if they are using a compatible eMMC before applying the hardware mod. The modification requires an expert level of soldering due to the sizes of the involved parts.</td>
</tr></tbody></table>
<p>On PinePhone hardware revisions 1.0 to 1.2b, the eMMC speed is limited by the eMMC power supply voltage. 
A hardware modification can be performed to increase the eMMC read/write speed.
</p>
<p>Here are the read speed improvement we have measured (your results may vary):
</p>
<ul>
<li>PinePhone 1.2 pmOS CE (convergence package) with 32GB SanDisk eMMC: before 55MB/s, after 125MB/s</li>
<li>PinePhone 1.0 Braveheart edition with 16GB Kimtigo eMMC: before: 80MB/s, after 110MB/s</li>
</ul>
<p>You can measure the read speed of your eMMC (or microSD) by using <code>hdparm</code>, consider only the buffered disk reads result.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> sudo apk add hdparm
<span class="gp">$</span> sudo hdparm -tT /dev/mmcblk2
</pre></div>
<p>The PinePhone eMMC read speed (~50-80MB/s) is limited from the DDR52 timing used, while both the eMMC and A64 SoC support HS200 and HS400 speeds.
</p>
<p>Every eMMC card has two power supplies:
</p>
<ul>
<li>Vcc powering the NAND storage inside the eMMC</li>
<li>Vccq powering the eMMC micro-controller and the MMC bus</li>
</ul>
<p>You can use eMMC cards in High Speed mode (HS200/HS400) only by powering Vccq at 1.8V or 1.2V, in the PinePhone (1.0 to 1.2b) Vccq is powered at 3.3V.
</p>
<p>The PinePhone mainboard can be modified to switch Vccq from 3.3V to 1.8V, making possible to use HS200 and HS400 modes.
</p>
<h5><span class="mw-headline" id="Hardware_modification_steps">Hardware modification steps</span></h5>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">This modification involves desoldering and soldering components on the PinePhone mainboard, do this only if you know what you are doing. We are not responsible for any damage.</td>
</tr></tbody></table>
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">After performing this modification you won't be able to boot from eMMC any Linux image that is missing the proper Device Tree Overlay, this limitation does not apply to the microSD slot.</td>
</tr></tbody></table>
<ul>
<li>Disassemble the PinePhone and remove the mainboard from the phone</li>
<li>Remove the metallic RF shield from the mainboard side with the A64 SoC visible at the center.</li>
<li>Locate R615 and R614 footprints with the help of the <a rel="nofollow" class="external text" href="https://wiki.pine64.org/index.php/PinePhone#PinePhone_board_information.2C_schematics_and_certifications">component placement drawing</a> for your PP revision.</li>
</ul>
<p>The R615 resistor is above the eMMC card, and the R614 footprint should be right above it.
</p>
<div class="floatnone"><a href="../Pinephone-r615-r614.jpeg" class="image"><img alt="Pinephone-r615-r614.jpeg" src="../Pinephone-r615-r614.jpeg" decoding="async" width="400" height="400" srcset="../600px-Pinephone-r615-r614.jpeg 1.5x ../800px-Pinephone-r615-r614.jpeg 2x"></a></div>
<ul>
<li>Desolder R615 0 ohm resistor and solder it to R614, or bridge R614 with solder.</li>
<li>Put back the metallic RF shield paying attention to the alignment</li>
<li>Reassemble the PinePhone</li>
<li>Reinstall PostmarketOS to the eMMC selecting the <code>device-pine64-pinephone-vccq-mod</code> as package to be installed during <code>pmbootstrap init</code>
</li>
</ul>
<p>This configuration is persistent to kernel and U-Boot upgrades, but the package has to be installed again when reinstalling the system to eMMC.
</p>
<p>If you boot your modified PinePhone without installing <code>device-pine64-pinephone-vccq-mod</code> first, your phone will freeze during boot, this is expected since the stock kernel Device Tree no longer corresponds to your PinePhone hardware (Vccq is now 1.8V instead of 3.3V).
</p>
<p>You can recover a not booting eMMC installation by manually copying the <code>device-pine64-pinephone-vccq-mod</code> files, for example after installing the package on a microSD installation, with the help of Jumpdrive.
</p>
<p>You can check the current eMMC timing mode and clock with:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> cat /sys/kernel/debug/mmc2/ios
</pre></div>
<h5><span class="mw-headline" id="Notes">Notes</span></h5>
<p>In theory a PinePhone with Vccq mod could boot an unmodified image (without DT change) from eMMC, albeit in DDR52 mode, but this isn't working as the eMMC is mounted read-only during boot.
This situation can be investigated further.
</p>
<p>The <code>device-pine64-pinephone-vccq-mod</code> package loads a Device Tree Overlay that switches Vccq from DCDC1 reg (3.3V) to ELDO1 reg (1.8V) and enables HS200 mode. 
</p>
<p>The A64 SoC has a limitation on the maximum eMMC clock speed, from the datasheet it supports max 150MHz at HS200 and max 100MHz at HS400.
</p>
<p>HS400 mode is supported by hardware but it's not currently supported by the `sunxi-mmc` drivers in the Linux kernel.
</p>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues/1285">pmaports#1285</a> pine64-pinephone: Support for eMMC Vccq hardware mod</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/2665">pmaports!2665</a> pine64-pinephone: Add support for eMMC Vccq hardware mod</li>
</ul>
<h3><span class="mw-headline" id="Magnetometer">Magnetometer</span></h3>
<p>The magnetometer cannot be used on the 1.2b revision PinePhone which switched from the LIS3MDL used in older revisions to the AF8133J. The driver is present in the kernel but the device tree does not define it. See <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues/1945">pmaports#1945</a> for more details.
</p>
<h2><span class="mw-headline" id="Troubleshooting">Troubleshooting</span></h2>
<h3>
<span id="Modem's_SMS_cache_is_full_and_cannot_receive_SMS"></span><span class="mw-headline" id="Modem.27s_SMS_cache_is_full_and_cannot_receive_SMS">Modem's SMS cache is full and cannot receive SMS</span>
</h3>
<p>ModemManager may not process all SMS, which can lead to the SMS cache getting full and not receiving future SMS. See <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues/731">pmaports#731</a> for instructions to clear the cache, and for details on how this is getting fixed.
</p>
<h3><span class="mw-headline" id="Qt_Based_Browsers_Not_Loading_Web_Pages">Qt Based Browsers Not Loading Web Pages</span></h3>
<p>Webkit sandbox is broken in the current build. In order to be able to use Qt based browsers it is necessary to create the file "/etc/profile.d/sandboxhack.sh" with the following contents:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span>!/bin/sh
<span class="go">export QTWEBENGINE_DISABLE_SANDBOX=1</span>
</pre></div>
<p>This sets an environment variable that kills the webkit sandbox because that's broken in the current build. This should be fixed already for the chromium musl build but not yet for all qtwebkit based browsers. This is being worked on <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/issues/435">here</a> and <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/issues/32">here</a>.
</p>
<h3><span class="mw-headline" id="Boot_related">Boot related</span></h3>
<p>If your PinePhone does not boot anymore with postmarketOS, first make sure that your battery is not (nearly) empty. Plug the charging cable, make sure it's completely turned off (i.e. no LED is glowing, screen is completely dark). If it is not completely off, then hold the power button until it is. Leave it in that state until the battery is charged for sure, then try again.
</p>
<p>If that does not help it, plug a serial cable if you have one and look at the output. If you don't but have a suspicion of what it could be, you can try to replace the initramfs files and/or u-boot bootloader with the instructions below.
</p>
<p>In any case, we try hard to make the phone not enter a state where it can't boot anymore after installing updates. If you see that happen and it's not related to battery being empty, please report in detail in <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues/1618">pmaports#1618</a>. Mention which postmarketOS version you run (edge, or which stable release), and in detail what happens. Some users already reported that the osk-sdl keyboard for unlocking encrypted installations didn't work for them anymore (though that might be battery related? we couldn't reproduce it so far). Attaching the files from your /boot partition and is also very useful to help narrowing this down.
</p>
<h4><span class="mw-headline" id="Fix_broken_boot_partition">Fix broken boot partition</span></h4>
<p>If postmarketOS gets stuck early in the booting process, it might fail to load u-boot / the kernel / initramfs / initramfs-extra. The exact cause can be determined over serial (remember to toggle the headphone killswitch for that), if initramfs-extra is corrupt, it will look like this for example:
</p>
<pre>Extract /boot/initramfs-postmarketos-allwinner-extra
gzip: unexpected end of file
cpio: short read
/init: line 233: parted: not found
</pre>
<p>Depending on the serial output, the solution is either to replace contents of the boot partition (as with the output above), or to replace u-boot (see further below).
</p>
<p>You don't need a serial cable for either fix, the serial cable is only needed to figure out the exact cause.
</p>
<h5><span class="mw-headline" id="Boot_partition_on_eMMC">Boot partition on eMMC</span></h5>
<ol>
<li>Download the latest image from the same channel you are running (edge, v21.03, ...) (see <a href="#From_pre-built_image_.28easy_method.29">above</a>)</li>
<li>Put it on your SD card</li>
<li>Login via serial or <a href="../en/SSH.html" title="SSH">SSH</a> (user / 147147) (SSH works over USB too!)</li>
<li>Replace contents of your boot partition:</li>
</ol>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> sudo mount /dev/mmcblk2p1 /mnt
<span class="gp">$</span> <span class="nb">cd</span> /boot
<span class="gp">$</span> sudo cp -v -r * /mnt
<span class="go">'allwinner' -&gt; '/mnt/allwinner'</span>
<span class="go">'boot.scr' -&gt; '/mnt/boot.scr'</span>
<span class="go">'initramfs-postmarketos-allwinner' -&gt; '/mnt/initramfs-postmarketos-allwinner'</span>
<span class="go">'initramfs-postmarketos-allwinner-extra' -&gt; '/mnt/initramfs-postmarketos-allwinner-extra'</span>
<span class="go">'lost+found' -&gt; '/mnt/lost+found'</span>
<span class="go">'sun50i-a64-pinephone-1.1.dtb' -&gt; '/mnt/sun50i-a64-pinephone-1.1.dtb'</span>
<span class="go">'sun50i-a64-pinephone-1.2.dtb' -&gt; '/mnt/sun50i-a64-pinephone-1.2.dtb'</span>
<span class="go">'uImage-postmarketos-allwinner' -&gt; '/mnt/uImage-postmarketos-allwinner'</span>
<span class="go">'uInitrd-postmarketos-allwinner' -&gt; '/mnt/uInitrd-postmarketos-allwinner'</span>
<span class="go">'vmlinuz-postmarketos-allwinner' -&gt; '/mnt/vmlinuz-postmarketos-allwinner'</span>
<span class="gp">$</span> sudo umount /mnt
<span class="gp">$</span> sudo poweroff
</pre></div>
<p>Wait until it is powered off. Then remove the SD card and start your phone, your boot partition should be working again. Remember to switch the killswitch again if you want to use your audio jack for audio.
</p>
<h5><span class="mw-headline" id="Boot_partition_on_SD_card">Boot partition on SD card</span></h5>
<ol>
<li>Download the latest image from the same channel you are running (edge, v21.03, ...) (see <a href="#From_pre-built_image_.28easy_method.29">above</a>)</li>
<li>Plug the SD card into your computer</li>
</ol>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> unxz <span class="m">20210317</span>-0042-postmarketOS-edge-phosh-6-pine64-pinephone.img.xz
<span class="gp">$</span> sudo modprobe loop
<span class="gp">$</span> sudo losetup -f --show -P <span class="m">20210317</span>-0042-postmarketOS-edge-phosh-6-pine64-pinephone.img
<span class="go">/dev/loop0</span>
<span class="gp">$</span> sudo dd <span class="k">if</span><span class="o">=</span>/dev/loop0p1 <span class="nv">of</span><span class="o">=</span>/dev/mmcblkNp1
<span class="gp">$</span> sudo losetup -d /dev/loop0
</pre></div>
<p>Replace <code>/dev/mmcblkNp1</code> with the first partition of your SD card (see <code>lsblk</code>).
</p>
<h4><span class="mw-headline" id="Fix_U-Boot">Fix U-Boot</span></h4>
<h5><span class="mw-headline" id="postmarketOS_installed_to_eMMC">postmarketOS installed to eMMC</span></h5>
<p>If postmarketOS is installed to the eMMC, put another postmarketOS image on an SD card and run from there:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> sudo update-u-boot -d /dev/mmcblk2
</pre></div>
<h5><span class="mw-headline" id="postmarketOS_installed_to_SD">postmarketOS installed to SD</span></h5>
<p>If postmarketOS is installed to an SD card:
</p>
<ul>
<li>Put it into the PinePhone or PC</li>
<li>Download <code>u-boot-pinephone-*.apk</code> from <a rel="nofollow" class="external text" href="https://mirror.postmarketos.org/postmarketos/master/aarch64/">here</a> (replace master with e.g. v21.03 depending on the release you are running)</li>
<li>Extract the apk and <code>dd</code> the u-boot file to the SD card (double-check you have the right device with <code>lsblk</code>)</li>
</ul>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> mkdir /tmp/x
<span class="gp">$</span> <span class="nb">cd</span> /tmp/x
<span class="gp">$</span> wget https://mirror.postmarketos.org/postmarketos/master/aarch64/u-boot-pinephone-2021.01_git20201228-r2.apk
<span class="gp">$</span> tar -xf u-boot-*.apk
<span class="gp">$</span> sudo dd <span class="k">if</span><span class="o">=</span>usr/share/u-boot/pine64-pinephone/u-boot-sunxi-with-spl-528.bin <span class="nv">of</span><span class="o">=</span>/dev/path-to-sd-card <span class="nv">bs</span><span class="o">=</span><span class="m">1024</span> <span class="nv">seek</span><span class="o">=</span><span class="m">8</span>
</pre></div>
<h4>
<span id="Failed_to_create_boot/xxx:_No_space_left_on_device"></span><span class="mw-headline" id="Failed_to_create_boot.2Fxxx:_No_space_left_on_device">Failed to create boot/xxx: No space left on device</span>
</h4>
<p>A bug has been observed where too many initramfs's are created. To fix, run the following commands to delete and regenerate all initramfs's.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">postmarketos:~#</span> sudo rm /boot/initramfs*
<span class="gp">postmarketos:~#</span> sudo apk fix linux-postmarketos-allwinner
</pre></div>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/308">pmaports!308</a> Initial merge request (Don't be evil devkit)</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/583">pmaports!583</a> Initial merge request (PinePhone)</li>
<li>
<a rel="nofollow" class="external text" href="https://wiki.pine64.org/index.php/PinePhone_v1.1_-_Braveheart">PinePhone v1.1 - Braveheart</a> - schematics, changes and known issues on the PINE64 wiki</li>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues/1554">pmaports#1554</a> Discussion of microphone hardware issues and possible workarounds</li>
<li><a href="../en/PinePhone_U-Boot_Upgrade.html" title="PinePhone U-Boot Upgrade">PinePhone U-Boot Upgrade</a></li>
<li><a rel="nofollow" class="external text" href="https://wiki.pine64.org/index.php/PinePhone">PINE64 wiki: PinePhone</a></li>
</ul>
</div></div>
		
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Devices.html" title="Category:Devices">Devices</a></li>
<li><a href="/index.php?title=Category:Phone&amp;action=edit&amp;redlink=1" class="new" title="Category:Phone (page does not exist)">Phone</a></li>
<li><a href="/index.php?title=Category:PostmarketOS&amp;action=edit&amp;redlink=1" class="new" title="Category:PostmarketOS (page does not exist)">PostmarketOS</a></li>
<li><a href="/index.php?title=Category:PINE64&amp;action=edit&amp;redlink=1" class="new" title="Category:PINE64 (page does not exist)">PINE64</a></li>
</ul>
</div></div>
		<div class="visualClear"></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=PINE64_PinePhone_(pine64-pinephone)&amp;oldid=45080">https://wiki.postmarketos.org/index.php?title=PINE64_PinePhone_(pine64-pinephone)&amp;oldid=45080</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 16 June 2023, at 15:51.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../en/About_postmarketOS.html" class="mw-redirect" title="PostmarketOS:About">About postmarketOS</a></li>
								<li id="footer-places-disclaimer"><a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-mobileview"><a href="https://wiki.postmarketos.org/index.php?title=PINE64_PinePhone_(pine64-pinephone)&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="../poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="" width="88" height="31"></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

</body>
</html>
