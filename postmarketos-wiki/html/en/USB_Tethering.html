<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>USB Tethering - postmarketOS</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.34.2">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="postmarketOS (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-USB_Tethering rootpage-USB_Tethering skin-vector action-view">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">USB Tethering</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From postmarketOS</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<table role="text container" style="color: inherit; background-color: #f6efe5; border: 1px solid #ac6600; margin: 4px 0; border-collapse: collapse;"><tbody><tr>
<td style="padding: 2px 0 2px 0.9em; text-align: center;"><span style="white-space: nowrap;"><img alt="Note" src="../Reference_icon.svg" decoding="async" title="Note" width="20" height="20" srcset="../Reference_icon.svg 1.5x ../Reference_icon.svg 2x"></span></td>
<td style="padding: 0.35em 0.9em; width: 100%;">postmarketOS is one of a few mobile phone software that allow you to use USB Tethering from USB to Modem; and from USB to WiFi; and possibly from USB to USB (using an OTG adapter). This feature is also useful to turn an unused device into a WiFi adapter.</td>
</tr></tbody></table>
<p>This is a guide for using the mobile data or wifi of a postmarketOS device through USB on your host device. For the inverse see the <a href="../en/USB_Internet.html" title="USB Internet">USB Internet</a> page if you need to use the USB connection to get internet from your host into the postmarketOS device.
</p>
<div id="toc" class="toc">
<input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none"><div class="toctitle" lang="en" dir="ltr">
<h2>Contents</h2>
<span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span>
</div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#Automatically_.28SXMO.29"><span class="tocnumber">1</span> <span class="toctext">Automatically (SXMO)</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#Automatically_.28GNOME.29"><span class="tocnumber">2</span> <span class="toctext">Automatically (GNOME)</span></a></li>
<li class="toclevel-1 tocsection-3">
<a href="#Manually"><span class="tocnumber">3</span> <span class="toctext">Manually</span></a>
<ul>
<li class="toclevel-2 tocsection-4"><a href="#Recommended"><span class="tocnumber">3.1</span> <span class="toctext">Recommended</span></a></li>
<li class="toclevel-2 tocsection-5">
<a href="#Using_Root"><span class="tocnumber">3.2</span> <span class="toctext">Using Root</span></a>
<ul>
<li class="toclevel-3 tocsection-6"><a href="#On_the_postmarketOS_device"><span class="tocnumber">3.2.1</span> <span class="toctext">On the postmarketOS device</span></a></li>
<li class="toclevel-3 tocsection-7"><a href="#On_the_host_side"><span class="tocnumber">3.2.2</span> <span class="toctext">On the host side</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-8"><a href="#See_also"><span class="tocnumber">3.3</span> <span class="toctext">See also</span></a></li>
</ul>
</li>
</ul>
</div>

<h1>
<span id="Automatically_(SXMO)"></span><span class="mw-headline" id="Automatically_.28SXMO.29">Automatically (SXMO)</span>
</h1>
<p>Open menu "Networks", select menu "Add a USB Hotspot", you'll be prompt to set a profile name (e.g. USB Tethering).
</p>
<p>Activate the newly created interface (i.e. )USB Tethering by selecting it.
</p>
<p>Your computer should receive internet traffic from your postmarketOS device automatically.
</p>
<h1>
<span id="Automatically_(GNOME)"></span><span class="mw-headline" id="Automatically_.28GNOME.29">Automatically (GNOME)</span>
</h1>
<p>1. Connect your phone over USB to your desktop.
</p>
<p>2. On the phone, open Settings
</p>
<p>3. Go to the Network panel tab.
</p>
<p>4. You should see 1 wired connection at the top, tab the edit settings button (gear).
</p>
<p>5. An old panel opens which doesn't fit your screen (use Phosh Mobile Settings to enable scale-to-fit for this panel only, it will be shown in the list of active apps).
</p>
<p>6. Go to the IPv4 tab.
</p>
<p>7. Select 'Shared to other computers' and tab the Apply button in the right corner.
</p>
<h1><span class="mw-headline" id="Manually">Manually</span></h1>
<p>If you don't use SXMO or GNOME, you should follow the following instructions.
To make USB Tethering to work, you'll have to repeat these instructions every time your system reboots.
</p>
<h2><span class="mw-headline" id="Recommended">Recommended</span></h2>
<p>Since version 23.06, a network profile "USB Networking" has been added in order to facilitate tethering on all variants of postmarketOS.
</p>
<p>This is the simple and non-intrusive manner to enable USB Tethering.
</p>
<p>Once USB cable is connected, execute the following commands.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> nmcli c modify <span class="s1">'83bd1823-feca-4c2b-9205-4b83dc792e1f'</span> ipv4.method shared
<span class="gp">$</span> nmcli d reapply usb0
</pre></div>
<p>If you want to restore the original behavior, use the <code>manual</code> method:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">$</span> nmcli c modify <span class="s1">'83bd1823-feca-4c2b-9205-4b83dc792e1f'</span> ipv4.method manual
<span class="gp">$</span> nmcli d reapply usb0
</pre></div>
<p>In case the above solution doesn't work, please send us a report on the <a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/issues">issue tracker</a>.
</p>
<h2><span class="mw-headline" id="Using_Root">Using Root</span></h2>
<h3><span class="mw-headline" id="On_the_postmarketOS_device">On the postmarketOS device</span></h3>
<p>On the postmarketOS device side, the firewall needs to be configured to perform NAT between the USB interface and it's default gateway. The default gateway can be either the WiFi or the modem in the device.
</p>
<p>First enable ip forwarding between the interfaces:
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> sysctl net.ipv4.ip_forward<span class="o">=</span><span class="m">1</span>
</pre></div>
<p>Then adjust the firewall configuration to NAT between the USB interface and the other interfaces
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">#</span> nft add table inet nat
<span class="gp">#</span> nft <span class="s1">'add chain inet nat postrouting { type nat hook postrouting priority 100 ; }'</span>
<span class="gp">#</span> nft add rule inet nat postrouting iifname <span class="s2">"usb*"</span> masquerade
</pre></div>
<p>The default nftables configuration in postmarketOS already has the other rules setup to make USB tethering work.
</p>
<h3><span class="mw-headline" id="On_the_host_side">On the host side</span></h3>
<p>Plug the postmarketOS device into your PC or laptop and run a DHCP client against the USB interface that shows up. It's also possible to use a static IP configuration.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span>address 172.16.42.2
netmask 255.255.255.0
gateway 172.16.42.1
</pre></div>
<p>If your host has automatically done DHCP on the USB interfaces, as is common on most Linux distributions. The only thing required is setting the default gateway to the USB interface since the
DHCP server on the postmarketOS device does not set the default gateway.
</p>
<div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span></span><span class="go">remove the existing default route if you have one</span>
<span class="gp">#</span> ip route del default

<span class="go">Add a default route through the postmarketOS device</span>
<span class="gp">#</span> ip route add default via <span class="m">172</span>.16.42.1
</pre></div>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul><li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/3819">pmaports!3819</a> USB tethering support</li></ul>
</div></div>
		
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
		<div class="visualClear"></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=USB_Tethering&amp;oldid=47620">https://wiki.postmarketos.org/index.php?title=USB_Tethering&amp;oldid=47620</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 15 August 2023, at 05:38.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../en/About_postmarketOS.html" class="mw-redirect" title="PostmarketOS:About">About postmarketOS</a></li>
								<li id="footer-places-disclaimer"><a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-mobileview"><a href="https://wiki.postmarketos.org/index.php?title=USB_Tethering&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="../poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="" width="88" height="31"></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

</body>
</html>
