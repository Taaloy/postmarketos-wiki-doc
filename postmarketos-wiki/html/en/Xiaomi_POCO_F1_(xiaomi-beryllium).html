<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Xiaomi POCO F1 (xiaomi-beryllium) - postmarketOS</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.34.2">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="postmarketOS (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Xiaomi_POCO_F1_xiaomi-beryllium rootpage-Xiaomi_POCO_F1_xiaomi-beryllium skin-vector action-view">
<div id="content" class="mw-body" role="main" style="margin: 0">
	<a id="top"></a>
	
	<div class="mw-indicators mw-body-content">
</div>

	<h1 id="firstHeading" class="firstHeading" lang="en">Xiaomi POCO F1 (xiaomi-beryllium)</h1>
	
	<div id="bodyContent" class="mw-body-content">
		<div id="siteSub" class="noprint">From postmarketOS</div>
		<div id="contentSub"></div>
		
		
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#p-search">Jump to search</a>
		<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><div class="mw-parser-output">
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Xiaomi Pocophone F1 / POCO F1</caption>
<tbody>
<tr class=""><td colspan="2" class="" style="text-align:center;">
<a href="../Plasmamobile-beryllium-mainline.jpg" class="image"><img alt="" src="../Plasmamobile-beryllium-mainline.jpg" decoding="async" width="200" height="356" srcset="../300px-Plasmamobile-beryllium-mainline.jpg 1.5x ../400px-Plasmamobile-beryllium-mainline.jpg 2x"></a>
</td></tr>
<tr class="">
<th scope="row" style="text-align:left;">Manufacturer</th>
    <td class="" style="">
Xiaomi</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Name</th>
    <td class="" style="">
Pocophone F1 / POCO F1</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Codename</th>
    <td class="" style="">
xiaomi-beryllium</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Released</th>
    <td class="" style="">
2018</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Category</th>
    <td class="" style="">
community</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Original software</th>
    <td class="" style="">
Android</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="The version the device was shipped with.">Original version</abbr></th>
    <td class="" style="">
8.1 (MIUI 9.6)</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="The most recent supported version from the manufacturer.">Extended version</abbr></th>
    <td class="" style="">
10 (MIUI 12)</td>
</tr>
<tr><th colspan="2" class="" style="text-align:center;">Hardware</th></tr>
<tr class="">
<th scope="row" style="text-align:left;">Chipset</th>
    <td class="" style="">
<a href="../en/Qualcomm_Snapdragon_845_(SDM845).html" title="Qualcomm Snapdragon 845 (SDM845)">Qualcomm Snapdragon 845 (SDM845)</a>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">CPU</th>
    <td class="" style="">
Octa-core (4x 2.8 GHz Kryo 385 Gold &amp; 4x 1.8 GHz Kryo 385 Silver)</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPU</th>
    <td class="" style="">
Adreno 630</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Display</th>
    <td class="" style="">
1080x2246 LCD</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Storage</th>
    <td class="" style="">
64/128/256 GB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Memory</th>
    <td class="" style="">
6/8 GB</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Architecture</th>
    <td class="" style="">
aarch64</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Type</th>
    <td class="" style="">
handset</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<p><br>
</p>
<p><br>
</p>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Features</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="After connecting the device with USB to your PC, you can connect to it via telnet (initramfs) or SSH (booted system).">USB Networking</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="It is possible to flash the device with `pmbootstrap flasher`.">Flashing</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Touchscreen</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Display works. Ideally with sleep mode and brightness control.">Display</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">WiFi</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Full disk encryption and unlocking with osk-sdl.">FDE</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Instead of a Linux kernel fork, it is possible to run mainline.">Mainline</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Charging and battery level reporting works">Battery</abbr></th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">3D Acceleration</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Audio playback, microphone, headset and buttons.">Audio</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Bluetooth</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Camera</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPS</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Mobile data</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">SMS</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Calls</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">USB OTG</th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">NFC</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Sensors</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Auto screen rotation works in desktops e.g. Phosh or Plasma Mobile">Accelerometer</abbr></th>
    <td class="" style="">
<div class="feature feature-no">Broken</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Magnetometer</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ambient Light</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Proximity</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Also known as flip cover sensor">Hall Effect</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Barometer</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Power Sensor</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Misc</caption>
<tbody>
<tr class="">
<th scope="row" style="text-align:left;">Camera Flash</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Keyboard</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Touchpad</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Full-sized USB-A port works (Usually applicable to SBCs and laptops).">USB-A</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Video and audio output with HDMI or Display Port works.">HDMI/DP</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ir TX</th>
    <td class="" style="">
<div class="feature feature-unavailable">Unavailable</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ir RX</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Stylus</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Haptics</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ethernet</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">FOSS bootloader</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<p><br>
</p>
<p><br>
</p>
<p><br>
Another great phone based on <a href="../en/Qualcomm_Snapdragon_845_(SDM845).html" title="Qualcomm Snapdragon 845 (SDM845)">Qualcomm Snapdragon 845 (SDM845)</a>.
</p>
<h2><span class="mw-headline" id="How_to_enter_flash_mode">How to enter flash mode</span></h2>
<p>You have to press <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Power</span> + <span class="nowrap" title="This is not a clickable button; it illustrates the button one should find." style="padding:.2em .6em; border:1px solid; border-color:#AAA #555 #555 #AAA; border-radius: 3px; background-color: #F2F2F2;">Volume Down</span> to enter the bootloader.
</p>
<h2><span class="mw-headline" id="Know_your_panel_variant">Know your panel variant</span></h2>
<p>There are two variants of the Xiaomi Poco F1 with different display panels and touchscreens.
</p>
<p>1. EBBG Panel (and Focaltech touchscreen) - <code>dsi_ebbg_fhd_ft8719_video_display</code>
</p>
<p>2. Tianma Panel (and Novatek touchscreen) - <code>dsi_tianma_fhd_nt36672a_video_display</code>
</p>
<p><br>
To know your panel variant, get into a terminal with root access (you can use TWRP recovery's terminal as it has root access or rooted android ROM)
</p>
<p>1. Run <code>su</code> to make sure you have root access
</p>
<p>2. Run <code>cat /proc/cmdline</code>. Output would be similar to:
</p>
<pre>rcupdate.rcu_expedited=1 console=tty0 earlycon=msm_geni_serial,0xA84000 androidboot.hardware=qcom androidboot.console=ttyMSM0 video=vfb:640x400,bpp=32,memsize=3072000 msm_rtb.filter=0x237 ehci-hcd.park=3 lpm_levels.sleep_disabled=1 service_locator.enable=1 swiotlb=2048 androidboot.configfs=true loop.max_part=7 androidboot.usbcontroller=a600000.dwc3 root=/dev/dm-0 dm="system none ro,0 1 android-verity /dev/sde48" androidboot.verifiedbootstate=orange androidboot.keymaster=1  androidboot.veritymode=enforcing androidboot.bootdevice=1d84000.ufshc androidboot.serialno=b79782d2 androidboot.baseband=sdm msm_drm.dsi_display0=dsi_tianma_fhd_nt36672a_video_display: androidboot.ramdump=disable androidboot.secureboot=1 androidboot.dp=0x0 androidboot.cpuid=0x205772eb androidboot.hwversion=4.19.0 androidboot.hwc=INDIA androidboot.cert=M1805E10A androidboot.hwlevel=MP
</pre>
<p>4. Note the value of <code>msm_drm.dsi_display0</code>. In the example above, it's  <code>dsi_tianma_fhd_nt36672a_video_display</code>, i.e Tianma panel variant. For EBBG panel variant, it would be <code>dsi_ebbg_fhd_ft8719_video_display</code>
</p>
<p><br>
</p>
<p>During <code>pmbootstrap init</code>, select the kernel variant by choosing either tianma or ebbg based on the output from above.
</p>
<h2><span class="mw-headline" id="Installation">Installation</span></h2>
<p>It is possible to either use a pre-built image as explained in the <a href="../en/Installation.html" title="Installation">installation</a> article, or to use <a href="../en/Pmbootstrap.html" title="Pmbootstrap">pmbootstrap</a> to build your own image.
</p>
<p>1. Run <code>pmbootstrap init</code> and select xiaomi as vendor and beryllium as device.
</p>
<p>2. Select the Kernel variant based on the panel noted from the "Know your panel variant" section above.
</p>
<p>3. Follow the onscreen instruction and configure as your needs.
</p>
<p>Sample output:
</p>
<pre>[20:23:35] Location of the 'work' path. Multiple chroots (native, device arch, device rootfs) will be created in there.
[20:23:35] Work path [/home/joel/.local/var/pmbootstrap]: 
[20:23:36] NOTE: pmaports path: /home/joel/.local/var/pmbootstrap/cache_git/pmaports
[20:23:36] Choose the postmarketOS release channel.
[20:23:36] Available (3):
[20:23:36] * edge: Rolling release / Most devices / Occasional breakage: https://postmarketos.org/edge
[20:23:36] * stable-next: Latest release / Recommended for best stability
[20:23:36] * stable: Old release (unsupported)
[20:23:36] Channel [edge]: 
[20:23:36] Choose your target device vendor (either an existing one, or a new one for porting).
[20:23:36] Available vendors (59): acer, alcatel, amazon, arrow, asus, bq, chuwi, cubietech, essential, fairphone, finepower, fly, goclever, google, gp, hisense, htc, huawei, infocus, jolla, klipad, lark, leeco, lenovo, lg, medion, meizu, motorola, nextbit, nobby, nokia, nvidia, oneplus, oppo, ouya, pegatron, pine64, planet, purism, qemu, raspberry, samsung, semc, sharp, sony, surftab, t2m, tablet, teclast, tokio, trekstor, vernee, wexler, wiko, wileyfox, xiaomi, yu, zte, zuk
[20:23:36] Vendor [xiaomi]: xiaomi
[20:23:38] Available codenames (23): aries, armani, begonia, beryllium, cactus, cancro, clover, daisy, dior, ferrari, ido, kenzo, lavender, libra, mido, santoni, scorpio, tissot, vince, whyred, willow, wt88047, wt88047-downstream
[20:23:38] Device codename [beryllium]: beryllium
[20:23:42] Which kernel do you want to use with your device?
[20:23:42] Available kernels (2):
[20:23:42] * ebbg: EBBG Panel. To know the status of the port and which panel your device use, Visit the Poco F1 wiki page: https://wiki.postmarketos.org/wiki/Xiaomi_Poco_F1_(xiaomi-beryllium)
[20:23:42] * tianma: Tianma Panel. To know the status of the port and which panel your device use, Visit the Poco F1 wiki page: https://wiki.postmarketos.org/wiki/Xiaomi_Poco_F1_(xiaomi-beryllium)
[20:23:42] Kernel [tianma]: tianma
[20:23:45] This device has proprietary components, which trade some of your freedom with making more peripherals work.
[20:23:45] We would like to offer full functionality without hurting your freedom, but this is currently not possible for your device.
[20:23:45] device-xiaomi-beryllium-nonfree-firmware: GPU, venus, modem firmware
[20:23:45] Enable this package? (y/n) [y]: 
[20:23:45] Extra packages [none]: iw,wireless-regdb
</pre>
<p>Next, we will build the system:
</p>
<pre>pmbootstrap install # add --fde if you need full disk encryption (FDE)
</pre>
<p>Flash the kernel and rootfs:
</p>
<pre>$ pmbootstrap flasher flash_kernel
$ pmbootstrap flasher flash_rootfs --partition userdata
</pre>
<h3><span class="mw-headline" id="Installation_to_SD_card">Installation to SD card</span></h3>
<p>You can take advantage of Poco F1's SD card slot to install postmarketOS for testing.
</p>
<p>Install to the SD card:
</p>
<pre>$ pmbootstrap install --sdcard=/dev/mmcblk0
</pre>
<p>To boot from SD, with the device in fastboot mode (with device off, press Power + Volume Down until it enters fastboot mode), type:
</p>
<pre>$ pmbootstrap flasher boot
</pre>
<p>Note: This uses pmbootstrap from your computer to boot postmarketOS from the SD card without disturbing your bootloader or your system.
</p>
<h3>
<span id="Installation_using_prebuilt_image_(fastboot)"></span><span class="mw-headline" id="Installation_using_prebuilt_image_.28fastboot.29">Installation using prebuilt image (fastboot)</span>
</h3>
<p>Turn off your device, press volume down + power until the device enters bootloader/fastboot mode. Make sure you've installed android-tools or a similar package providing the "fastboot" program on your computer, with the appropriate drivers on Windows.
</p>
<p>Download the both the -boot.img.xz and the main system's .img.xz (see above about picking the appropriate variant), then do the following (using the image filename at the time of writing as an example):
</p>
<pre>$ unxz -v 20230212-1217-postmarketOS-v22.12-plasma-mobile-3.9-xiaomi-beryllium-ebbg-boot.img.xz
$ fastboot flash boot 20230212-1217-postmarketOS-v22.12-plasma-mobile-3.9-xiaomi-beryllium-ebbg-boot.img
$ unxz -v 20230212-1217-postmarketOS-v22.12-plasma-mobile-3.9-xiaomi-beryllium-ebbg.img.xz
$ fastboot flash userdata 20230212-1217-postmarketOS-v22.12-plasma-mobile-3.9-xiaomi-beryllium-ebbg.img
</pre>
<h1><span class="mw-headline" id="Mainline_status">Mainline status</span></h1>
<h2><span class="mw-headline" id="Display">Display</span></h2>
<p>Works fine. MSM DRM based panel. 
</p>
<p>The Tianma variant is already in mainline Linux. 
</p>
<p>The EBBG panel variant is available in our kernel fork and works fine, but it is not upstreamed yet.
</p>
<p>Brightness can be adjusted. The PMI8998 QCOM WLED driver from mainline is used for brightness adjustment.
</p>
<h2><span class="mw-headline" id="Touchscreen">Touchscreen</span></h2>
<p>For the Tianma variant, there are patches available for the NT36XXX touchscreen over here: <a rel="nofollow" class="external free" href="https://lwn.net/ml/linux-kernel/20201028221302.66583-1-kholk11@gmail.com/">https://lwn.net/ml/linux-kernel/20201028221302.66583-1-kholk11@gmail.com/</a>
Its still not accepted. But works fine with some <a rel="nofollow" class="external text" href="https://gitlab.com/sdm845-mainline/linux/-/commit/c2ca8a58d40c7a5687d576ce07f6f62446246422">fixes</a> and included in our fork. 
</p>
<p>For the EBBG variant, Venji10 has written downstream based driver for focaltech touchscreen. Its not upstreamed yet. Included in our fork and works fine.
</p>
<h2><span class="mw-headline" id="3D_GPU_Acceleration">3D GPU Acceleration</span></h2>
<p>Since our panels are MSM DRM based, 3D acceleration works perfectly fine using the freedreno driver from mainline.
</p>
<h2><span class="mw-headline" id="WiFi">WiFi</span></h2>
<p>2.4Ghz WiFi connection works perfectly fine. However, 5Ghz WiFi network has poor signal reception. Requires fix.
</p>
<p>If you have issues connecting to the wifi, double check <code>dmesg</code>. If the following lines are in dmesg:
</p>
<pre>[  302.291007] wlan0: authenticate with c0:06:c3:b6:d0:f6
[  302.291066] wlan0: bad VHT capabilities, disabling VHT
[  302.291070] wlan0: 80 MHz not supported, disabling VHT
</pre>
<p>Then you must change the wifi width from 80 MHz to 20 MHz in your router's settings. The regulatory region gets selected as CN (China) which causes this issue.You can change the regulatory region by following the instructions here: <a href="../en/Change_regulatory_region.html" title="Change regulatory region">Change regulatory region</a>
</p>
<p>Do not forget to add packages during <code>pmbootstrap init</code>, or you won't be able to change regulatory region after installation:
</p>
<p>Sometimes, even if those lines are in dmesg it can still connect to the Wi-Fi (after a few more tries, disabling and enabling Wi-Fi until eventually it succeeds)
</p>
<pre>[20:23:45] Extra packages [none]: iw,wireless-regdb
</pre>
<h2><span class="mw-headline" id="Bluetooth">Bluetooth</span></h2>
<p>The Bluetooth service crashes on boot and requires a restart in Phosh.
</p>
<pre>sudo service bluetooth restart
</pre>
<p>Now you should be able to see the devices show up in Settings-&gt;Bluetooth and to pair from the UI.
</p>
<p>In case if you want to switch off and on the bluetooth in Phosh, use Settings-&gt;<b>Power</b>-&gt;Bluetooth toggle and <b>not</b> the Settings-&gt;Bluetooth toggle as it doesn't seem to work properly. Requires fix eventually.
</p>
<h2><span class="mw-headline" id="Audio">Audio</span></h2>
<p>Almost all audio devices work perfectly fine (Speakers, Earpiece, Headphones+Mic, Phone Bottom Mic, Bluetooth headphones+Mic).
Except for the Top mic. It doesn't work for some weird reason. 
</p>
<p>You can change the Audio devices from Settings-&gt;Sound.
</p>
<p>The userspace ALSA UCM confs are available in our repo: <a rel="nofollow" class="external free" href="https://gitlab.com/sdm845-mainline/alsa-ucm-conf">https://gitlab.com/sdm845-mainline/alsa-ucm-conf</a>. Need to be up-streamed eventually.
</p>
<p>Headphones+Mic &amp; Phone Internal Mic are already in mainline dts. 
The TAS2559 driver requires a rewrite and needs to be upstreamed. Included in our fork.
</p>
<p>However PipeWire has some issues with Sound. If using PipeWire you'll encounter the following issues:
</p>
<p>- Very low volume
</p>
<p>- Distortion
</p>
<p>- Softlocks (rare but still possible)
</p>
<p>Some of these issues have been solved, as explained in the SXMO mailing list (see below) (low volume (partially) and distortion) but other issues remain.
</p>
<h2><span class="mw-headline" id="Battery">Battery</span></h2>
<p>Caleb and Joel started writing a basic fuel gauge driver with basic functionalities such as charge percentage, temperature, USB plug in and out detection, etc. Included in work. Still requires quite some rework to make it generic enough and extensible. Although charging works, there isn't a proper charging driver yet. It would also be needed to enable USB OTG feature.
</p>
<h2><span class="mw-headline" id="GPS">GPS</span></h2>
<p>In Phosh, using Gnome Maps app, it is able to fetch the location data from ModemManager using Geoclue service. But I have not extensively tested whether the GPS data is coming from WiFi connection data or Mobile Tower CellID or the GPS itself. As far as I have tested, on a fresh rootfs, with a completely new WiFi AP, it's still able to fetch the location correctly.
</p>
<p>GPS (with location data from satellites) works, at least at the lowest levels. This can be tested as follows:
</p>
<pre>$ qmicli --device-open-mbim --device-open-proxy --device=qrtr://0 --client-no-release-cid --loc-start; sleep 120
[qrtr://0] Successfully started location tracking (session id 0)
[qrtr://0] Client ID not released:
        Service: 'loc'
            CID: '1'
$ qmicli --device-open-mbim --device-open-proxy --device=qrtr://0 --client-no-release-cid --client-cid=1 --loc-get-position-report
$ qmicli --device-open-mbim --device-open-proxy --device=qrtr://0 --client-no-release-cid --client-cid=1 --loc-get-gnss-sv-info
$ qmicli --device-open-mbim --device-open-proxy --device=qrtr://0 --client-cid=1 --loc-stop
</pre>
<p>This currently works on GNOME Maps with GeoClue but takes a long time to get a GPS fix because A-GPS support is not implemented yet.
</p>
<h2><span class="mw-headline" id="Camera">Camera</span></h2>
<p>Able to configure the CAMSS and camera regulators properly and the IMX363 shows up on the I2C bus. A WIP IMX363 driver written initially by Mis012 is being developed over here: <a rel="nofollow" class="external free" href="https://gitlab.com/sdm845-mainline/linux/-/commits/wip/sdm845-5.13.rc4-camss/">https://gitlab.com/sdm845-mainline/linux/-/commits/wip/sdm845-5.13.rc4-camss/</a>. But currently it returns Broken Pipe error when trying to fetch image from the camera using v4l2-ctl. 
</p>
<p>
The Camera register configurations can be observed by enabling CAMSS debug in downstream android kernel and noting the logs for lines similar to </p>
<pre>CAM-CCI: cam_cci_data_queue: 741: cmd_size 24 addr 0x136 data 0x18</pre>
<p> Will probably add more info on this in the SDM845 Mainlining wiki later. 
</p>
<p>The Poco F1 Camera Configuration I have noted so far:
</p>
<hr>
<p><b>COMMON CONFIG</b>
</p>
<hr>
<p>CAM_IOVDD_EN 		| gpio50 	| tlmm		| vreg_s4a_1p8		| 1.8V
</p>
<p>CAM_LDO_EN		| gpio99	| tlmm		| No idea		| 1.35V
</p>
<hr>
<p><b>Front Cam 1 - Samsung S5K3T1 (20MP)</b>
</p>
<hr>
<p>CAM_F1_RSTN 		| gpio104 	| tlmm		| -
</p>
<p>FRONT_CAM1_AVDD_EN 	| gpio29 	| tlmm		| vreg_bob
</p>
<p>FRONT_CAM1_DVDD_EN	| gpio9		| pmi8998	| vreg_s3a_1p35
</p>
<hr>
<p><b>Rear Cam 1  -  Sony IMX363 (12MP), I2C Address (0x10)</b>
</p>
<hr>
<p>CAM_R1_RSTN		| gpio80	| tlmm		| -
</p>
<p>REAR_CAM1_AVDD_EN 	| gpio40 	| tlmm		| vreg_bob		| 2.8V
</p>
<p>REAR_CAM1_DVDD_EN	| gpio11	| pmi8998	| vreg_s3a_1p35		| 1.35V
</p>
<hr>
<p><b>Front Cam 2 - OV7251 ??</b>
</p>
<hr>
<p>CAM_F2_RSTN 		| gpio25 	| tlmm		-
</p>
<p>FRONT_CAM2_AVDD_EN 	| gpio91 	| tlmm
</p>
<p>FRONT_CAM2_DVDD_EN 	| gpio7 	| tlmm
</p>
<hr>
<p><b>Rear Cam 2  -  Samsung S5K5E8 (5MP)</b>
</p>
<hr>
<p>CAM_R2_RSTN		| gpio28	| tlmm		-
</p>
<p>REAR_CAM2_AVDD_EN	| gpio79	| tlmm
</p>
<p>REAR_CAM2_DVDD_EN	| gpio92	| tlmm
</p>
<hr>
<h2>
<span id="Mobile_Data,_Calls_and_SMS"></span><span class="mw-headline" id="Mobile_Data.2C_Calls_and_SMS">Mobile Data, Calls and SMS</span>
</h2>
<p>Calls and SMS work fine, but as there is no convenient way to enter a SIM PIN, you should remove the PIN from your SIM card when inserted in some Android phone.
</p>
<p>Mobile data can be more tricky. If mobile data does not work (an orange exclamation mark over the cellular icon might indicate this), make sure that you obey the following order:
</p>
<ul>
<li>Disable "Mobile Network" and enable Wi-Fi (unclear: Is Internet access needed?).</li>
<li>Turn on "Mobile Network" and "Mobile Data", enter your APN when asked and not appearing automatically.</li>
</ul>
<h2><span class="mw-headline" id="Dual_SIM">Dual SIM</span></h2>
<p>Although there is <b>no dual SIM support yet</b>, Second SIM slot can be activated as primary sim slot; Which is necessary if we want to use the SD Card.
</p>
<p>Get the <b>Application ID</b> (AID) of the SIM:
</p>
<pre>$ sudo qmicli -d /dev/modem --uim-get-card-status
</pre>
<p>Switch the SIM slot:
</p>
<pre>$ sudo qmicli -d /dev/modem --uim-switch-slot=2
</pre>
<p>Provision the SIM slot:
</p>
<pre>$ sudo qmicli -d /dev/modem --uim-change-provisioning-session="slot=1,activate=yes,session-type=primary-gw-provisioning,aid=[AID from previous step]"
</pre>
<p>In case you receive errors in the last step, reboot the phone and try the last step again.
</p>
<h2><span class="mw-headline" id="Mobile_Data_Problems">Mobile Data Problems</span></h2>
<p>libqmi has support for QRTR+IPA based modems for quite some time, as seen in the repo: <a rel="nofollow" class="external free" href="https://gitlab.freedesktop.org/mobile-broadband/libqmi/-/merge_requests?scope=all&amp;search=qrtr&amp;state=merged">https://gitlab.freedesktop.org/mobile-broadband/libqmi/-/merge_requests?scope=all&amp;search=qrtr&amp;state=merged</a>
</p>
<p>ModemManager which uses libqmi to control the modem has added support for QRTR recently: <a rel="nofollow" class="external free" href="https://gitlab.freedesktop.org/mobile-broadband/ModemManager/-/merge_requests/470">https://gitlab.freedesktop.org/mobile-broadband/ModemManager/-/merge_requests/470</a>
</p>
<p>Inspite of all this, some Poco F1 users have mobile data connection issues on <b>some</b> mobile networks. During mobile data connection, it fails with the following errors
</p>
<pre>[2441]: &lt;info&gt;  [024233428.438170] [modem0/bearer1] couldn't start network: QMI protocol error (14): 'CallFailed'
[2441]: &lt;info&gt;  [024233428.438253] [modem0/bearer1] call end reason (3): generic-no-service
</pre>
<p>Once reported about it over here: <a rel="nofollow" class="external free" href="https://gitlab.freedesktop.org/mobile-broadband/libqmi/-/merge_requests/235#note_893224">https://gitlab.freedesktop.org/mobile-broadband/libqmi/-/merge_requests/235#note_893224</a>. Still have to properly submit a bug report on this.
</p>
<p>You can show an overview what the modem  manager sees as follows:
</p>
<pre>sudo mmcli -m 0 # Warning: output includes personal data
sudo mmcli -m 0 | grep -v -e imei -e Numbers -e equipment # excludes some personal data
</pre>
<h2><span class="mw-headline" id="Change_Kernel_parameters">Change Kernel parameters</span></h2>
<p>1, sudo <b>vim /etc/deviceinfo</b>
</p>
<p>2, Change cmdline parameters to desired state
</p>
<p>3, <b>sudo apk fix linux-postmarketos-qcom-sdm845</b>
</p>
<h1><span class="mw-headline" id="Community_Info">Community Info</span></h1>
<h2><span class="mw-headline" id="Maintainers">Maintainers</span></h2>
<ul>
<li>Venji10</li>
<li>Joel</li>
</ul>
<h2><span class="mw-headline" id="Users_owning_this_device">Users owning this device</span></h2>
<div style="-webkit-column-count: 2; -moz-column-count: 2; column-count: 2;"><ul style="margin-top: 0;">
<li>
<a href="../User:Abishek.html" title="User:Abishek">Abishek</a> (<span class="cargoFieldName">Notes:</span> daily driver running phosh)</li>
<li>
<a href="../User:Anjanmomi.html" title="User:Anjanmomi">Anjanmomi</a> (<span class="cargoFieldName">Notes:</span> daily driver running Sxmo)</li>
<li><a href="../User:Ash.html" title="User:Ash">Ash</a></li>
<li>
<a href="../User:Baonks81.html" title="User:Baonks81">Baonks81</a> (<span class="cargoFieldName">Notes:</span> 6GB/128GB)</li>
<li><a href="../User:Brittle.html" title="User:Brittle">Brittle</a></li>
<li>
<a href="../User:Clamor.html" title="User:Clamor">Clamor</a> (<span class="cargoFieldName">Notes:</span> Tianma panel model)</li>
<li><a href="../User:Dferrg.html" title="User:Dferrg">Dferrg</a></li>
<li>
<a href="../User:Entrider.html" title="User:Entrider">Entrider</a> (<span class="cargoFieldName">Notes:</span> Running LineageOS. Daily driver.)</li>
<li>
<a href="../User:F.html" title="User:F">F</a> (<span class="cargoFieldName">Notes:</span> ~3 years old. Daily driver running SXMO.)</li>
<li>
<a href="../User:Hilledkinged.html" title="User:Hilledkinged">Hilledkinged</a> (<span class="cargoFieldName">Notes:</span> EBBG display type)</li>
<li>
<a href="../User:Illen.html" title="User:Illen">Illen</a> (<span class="cargoFieldName">Notes:</span> Daily driver, runs LineageOS)</li>
<li>
<a href="../User:Iourine.html" title="User:Iourine">Iourine</a> (<span class="cargoFieldName">Notes:</span> with LineageOS)</li>
<li>
<a href="../User:Joel.html" title="User:Joel">Joel</a> (<span class="cargoFieldName">Notes:</span> Tianma-Panel)</li>
<li>
<a href="../User:Linmob.html" title="User:Linmob">Linmob</a> (<span class="cargoFieldName">Notes:</span> Tianma panel)</li>
<li>
<a href="../User:Medusa.html" title="User:Medusa">Medusa</a> (<span class="cargoFieldName">Notes:</span> Running pmOS;ebbg)</li>
<li>
<a href="../User:PiotrZPL.html" title="User:PiotrZPL">PiotrZPL</a> (<span class="cargoFieldName">Notes:</span> Running AwakenOS and Ubuntu Touch as a secondary device.)</li>
<li>
<a href="../User:Retourmy.html" title="User:Retourmy">Retourmy</a> (<span class="cargoFieldName">Notes:</span> Tianma panel version)</li>
<li>
<a href="../User:Retr0.html" title="User:Retr0">Retr0</a> (<span class="cargoFieldName">Notes:</span> Daily driver, running LineageOS 18.1 A11 with Magisk, Kali NetHunter installed)</li>
<li>
<a href="../User:Roboe.html" title="User:Roboe">Roboe</a> (<span class="cargoFieldName">Notes:</span> (second hand) daily driver; 128GB, Tianma panel; running Lineage OS)</li>
<li><a href="../User:Schrmh.html" title="User:Schrmh">Schrmh</a></li>
<li><a href="../User:SergDS.html" title="User:SergDS">SergDS</a></li>
<li>
<a href="../User:Sven.html" title="User:Sven">Sven</a> (<span class="cargoFieldName">Notes:</span> Running edge with Phosh, EBBG panel and TIANMA panel)</li>
<li>
<a href="../User:The_Arjdroid.html" title="User:The Arjdroid">The Arjdroid</a> (<span class="cargoFieldName">Notes:</span> (Daily Driver) not running postmarketOS on it but in general it has very good custom ROM and custom Kernel and custom Recovery support so wouldn't be surprised if things run very well.)</li>
<li>
<a href="../User:The_DarkFire.html" title="User:The DarkFire">The DarkFire</a> (<span class="cargoFieldName">Notes:</span> secondary driver / personal phone, mainline)</li>
<li><a href="../User:TheBads.html" title="User:TheBads">TheBads</a></li>
<li>
<a href="../User:UnDevDeCatOS.html" title="User:UnDevDeCatOS">UnDevDeCatOS</a> (<span class="cargoFieldName">Notes:</span> tianma variant, daily driver)</li>
<li><a href="../User:Venji10.html" title="User:Venji10">Venji10</a></li>
<li>
<a href="../User:Wizzdom.html" title="User:Wizzdom">Wizzdom</a> (<span class="cargoFieldName">Notes:</span> Tianma-Panel, Tinkering with Sxmo)</li>
</ul></div>
<p><br>
</p>
<h2><span class="mw-headline" id="See_also">See also</span></h2>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://gitlab.com/postmarketOS/pmaports/-/merge_requests/1156">pmaports!1156</a> Initial merge request</li>
<li>SDM845 Mainline kernel: <a rel="nofollow" class="external free" href="https://gitlab.com/sdm845-mainline/linux">https://gitlab.com/sdm845-mainline/linux</a>
</li>
<li>Another old WIP mainline kernel by Venji10: <a rel="nofollow" class="external free" href="https://github.com/Venji10/linux-beryllium">https://github.com/Venji10/linux-beryllium</a>
</li>
<li>Attempt at fixing PipeWire issues with this device: <a rel="nofollow" class="external free" href="https://lists.sr.ht/~mil/sxmo-devel/%3C20220611054214.15958-1-anjan%40momi.ca%3E#%3CPHzD3ucMo4uz1A65MQEBarEy_1IacMaoHBMmow9WeddxN7BSQWXCezGykeH0KCxJJlq4QR24vlFzvDeVF4xKwawhTqp7iFkhdQEu_jIjeyk=@protonmail.com%3E">https://lists.sr.ht/~mil/sxmo-devel/%3C20220611054214.15958-1-anjan%40momi.ca%3E#%3CPHzD3ucMo4uz1A65MQEBarEy_1IacMaoHBMmow9WeddxN7BSQWXCezGykeH0KCxJJlq4QR24vlFzvDeVF4xKwawhTqp7iFkhdQEu_jIjeyk=@protonmail.com%3E</a>
</li>
<li><a href="../en/Sxmo:_Xiaomi_Poco_F1_(xiaomi-beryllium).html" title="Sxmo: Xiaomi Poco F1 (xiaomi-beryllium)">Sxmo: Xiaomi Poco F1 (xiaomi-beryllium)</a></li>
</ul>
</div></div>
		
		<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Devices.html" title="Category:Devices">Devices</a></li>
<li><a href="/index.php?title=Category:Handset&amp;action=edit&amp;redlink=1" class="new" title="Category:Handset (page does not exist)">Handset</a></li>
<li><a href="../en/Category:Android.html" title="Category:Android">Android</a></li>
<li><a href="../en/Category:Xiaomi.html" title="Category:Xiaomi">Xiaomi</a></li>
</ul>
</div></div>
		<div class="visualClear"></div>
		
	</div>
</div>


		<div id="footer" role="contentinfo" style="margin: 0">
						<ul id="footer-info">
								<li>Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=Xiaomi_POCO_F1_(xiaomi-beryllium)&amp;oldid=44350">https://wiki.postmarketos.org/index.php?title=Xiaomi_POCO_F1_(xiaomi-beryllium)&amp;oldid=44350</a>"</li>
		
		<li id="footer-info-lastmod"> This page was last edited on 22 May 2023, at 14:29.</li>
								<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
							<br>
</ul>
						<ul id="footer-places">
								<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html" title="PostmarketOS:Privacy policy">Privacy policy</a></li>
								<li id="footer-places-about"><a href="../en/About_postmarketOS.html" class="mw-redirect" title="PostmarketOS:About">About postmarketOS</a></li>
								<li id="footer-places-disclaimer"><a href="../en/PostmarketOS:General_disclaimer.html" title="PostmarketOS:General disclaimer">Disclaimers</a></li>
								<li id="footer-places-mobileview"><a href="https://wiki.postmarketos.org/index.php?title=Xiaomi_POCO_F1_(xiaomi-beryllium)&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
							</ul>
										<ul id="footer-icons" class="noprint">
										<li id="footer-copyrightico">
						<a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31"></a>					</li>
										<li id="footer-poweredbyico">
						<a href="https://www.mediawiki.org/"><img src="../poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="" width="88" height="31"></a>					</li>
									</ul>
						<div style="clear: both;"></div>
		</div>
		

</body>
</html>
