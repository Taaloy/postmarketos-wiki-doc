<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<title>Rockchip RK3066 - postmarketOS</title>
<link rel="stylesheet" href="../PostmarketOSWikiOffline.css">
<meta name="ResourceLoaderDynamicStyles" content="">
<meta name="generator" content="MediaWiki 1.39.7">
<meta name="format-detection" content="telephone=no">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes, minimum-scale=0.25, maximum-scale=5.0">
<link rel="icon" href="/favicon.ico">
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="postmarketOS (en)">
<link rel="EditURI" type="application/rsd+xml" href="https://wiki.postmarketos.org/api.php?action=rsd">
<link rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">
<link rel="alternate" type="application/atom+xml" title="postmarketOS Atom feed" href="/index.php?title=Special:RecentChanges&amp;feed=atom">
</head>
<body class="skin-vector skin-vector-search-vue mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Rockchip_RK3066 rootpage-Rockchip_RK3066 skin-vector-2022 action-view skin--responsive vector-feature-language-in-header-enabled vector-feature-language-in-main-page-header-disabled vector-feature-language-alert-in-sidebar-disabled vector-feature-sticky-header-disabled vector-feature-sticky-header-edit-disabled vector-feature-table-of-contents-disabled vector-feature-visual-enhancement-next-disabled">
<div class="mw-page-container">
	<span id="top-page"></span>
	<a class="mw-jump-link" href="#content">Jump to content</a>
	<div class="mw-page-container-inner">
		<input type="checkbox" id="mw-sidebar-checkbox" class="mw-checkbox-hack-checkbox">
		<header class="mw-header">
			<div class="mw-header-aside">
			<label id="mw-sidebar-button" class="mw-checkbox-hack-button mw-ui-icon mw-ui-button mw-ui-quiet mw-ui-icon-element" for="mw-sidebar-checkbox" role="button" aria-controls="mw-panel" data-event-name="ui.sidebar" tabindex="0" title="Main menu">
				<span>Toggle sidebar</span>
			</label>
			
<a href="../en/Main_Page.html" class="mw-logo">
	<img class="mw-logo-icon" src="/logo_50x50.svg" alt="" aria-hidden="true" height="50" width="50">
	<span class="mw-logo-container">
		<strong class="mw-logo-wordmark">postmarketOS</strong>
	</span>
</a>

			</div>
			<div class="mw-header-content">
			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-collapses  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<a href="../Special:Search.html" title="Search postmarketOS [f]" accesskey="f" class="mw-ui-button mw-ui-quiet mw-ui-icon mw-ui-icon-element mw-ui-icon-wikimedia-search search-toggle">
		<span>Search</span>
	</a>
	
	<div>
		<form action="/index.php" id="searchform" class="vector-search-box-form">
			<div id="simpleSearch" class="vector-search-box-inner" data-search-loc="header-moved">
				<input class="vector-search-box-input" type="search" name="search" placeholder="Search postmarketOS" aria-label="Search postmarketOS" autocapitalize="sentences" title="Search postmarketOS [f]" accesskey="f" id="searchInput">
				<input type="hidden" name="title" value="Special:Search">
				<input id="mw-searchButton" class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search">
				<input id="searchButton" class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go">
			</div>
		</form>
	</div>
</div>

			<nav class="vector-user-links" aria-label="Personal tools" role="navigation">
	

<div id="p-vector-user-menu-overflow" class="vector-menu mw-portlet mw-portlet-vector-user-menu-overflow vector-user-menu-overflow">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-createaccount-2" class="user-links-collapsible-item mw-list-item"><a href="../Special:RequestAccount.html"><span>Request account</span></a></li></ul>
		
	</div>
</div>

	

<div id="p-personal" class="vector-menu mw-portlet mw-portlet-personal vector-user-menu vector-user-menu-logged-out vector-menu-dropdown" title="More options">
	<input type="checkbox" id="p-personal-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-personal" class="vector-menu-checkbox">
	<label id="p-personal-label" for="p-personal-checkbox" class="vector-menu-heading mw-ui-button mw-ui-quiet mw-ui-icon mw-ui-icon-element mw-ui-icon-ellipsis mw-ui-icon-wikimedia-ellipsis">
		<span class="vector-menu-heading-label">Personal tools</span>
	</label>
	<div class="vector-menu-content">
		<div class="vector-user-menu-create-account"><a href="/index.php?title=Special:CreateAccount&amp;returnto=Rockchip+RK3066" class="vector-menu-content-item user-links-collapsible-item" title="You are encouraged to create an account and log in; however, it is not mandatory"><span class="mw-ui-icon mw-ui-icon-userAdd mw-ui-icon-wikimedia-userAdd"></span> <span>Create account</span></a></div>
<div class="vector-user-menu-login"><a href="/index.php?title=Special:UserLogin&amp;returnto=Rockchip+RK3066" class="vector-menu-content-item vector-menu-content-item-login" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span class="mw-ui-icon mw-ui-icon-logIn mw-ui-icon-wikimedia-logIn"></span> <span>Log in</span></a></div>

		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

</nav>

			</div>
		</header>
		<div class="vector-sidebar-container ">
			</div>
		<div class="vector-sitenotice-container">
			<div id="siteNotice"></div>
		</div>
		<input type="checkbox" id="vector-toc-collapsed-checkbox" class="mw-checkbox-hack-checkbox">
		<div class="mw-table-of-contents-container">
			<div class="vector-sticky-toc-container mw-sticky-header-element">
				<nav id="mw-panel-toc" class="sidebar-toc" role="navigation" aria-labelledby="sidebar-toc-label" data-event-name="ui.sidebar-toc">
	<div id="sidebar-toc-label" class="sidebar-toc-header">
		<p class="sidebar-toc-title">
		Contents
		<button class="vector-toc-uncollapse-button">move to sidebar</button>
		<button class="vector-toc-collapse-button">hide</button>
		</p>
	</div>
	<ul class="sidebar-toc-contents" id="mw-panel-toc-list">
		<li id="toc-mw-content-text" class="sidebar-toc-list-item sidebar-toc-level-1">
			<a href="#top-page" class="sidebar-toc-link">
				<div class="sidebar-toc-text">Beginning</div>
			</a>
		</li>
		<li id="toc-General_description" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#General_description">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">1</span>General description</div>
			</a>
			
			<ul id="toc-General_description-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Devices" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Devices">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">2</span>Devices</div>
			</a>
			
			<ul id="toc-Devices-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Flashing_and_Booting" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Flashing_and_Booting">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">3</span>Flashing and Booting</div>
			</a>
			
			<ul id="toc-Flashing_and_Booting-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Serial" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Serial">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">4</span>Serial</div>
			</a>
			
			<ul id="toc-Serial-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Power_and_Clock_Management" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Power_and_Clock_Management">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">5</span>Power and Clock Management</div>
			</a>
			
			<ul id="toc-Power_and_Clock_Management-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Memory" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Memory">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">6</span>Memory</div>
			</a>
			
			<ul id="toc-Memory-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-Display" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#Display">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">7</span>Display</div>
			</a>
			
			<ul id="toc-Display-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-GPU" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#GPU">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">8</span>GPU</div>
			</a>
			
			<ul id="toc-GPU-sublist" class="sidebar-toc-list">
			</ul>
		</li>
		<li id="toc-WiFi" class="sidebar-toc-list-item sidebar-toc-level-1 sidebar-toc-list-item-expanded">
			<a class="sidebar-toc-link" href="#WiFi">
				<div class="sidebar-toc-text">
				<span class="sidebar-toc-numb">9</span>WiFi</div>
			</a>
			
			<ul id="toc-WiFi-sublist" class="sidebar-toc-list">
			</ul>
		</li>
	</ul>
</nav>

			</div>
		</div>
		<div class="mw-content-container">
			<main id="content" class="mw-body" role="main" style="margin: 0">
				<a id="top"></a>
				<header class="mw-body-header">
				
				
					<label id="vector-toc-collapsed-button" class="mw-ui-button mw-ui-quiet mw-ui-icon mw-ui-icon-element mw-ui-icon-wikimedia-listBullet mw-checkbox-hack-button" for="vector-toc-collapsed-checkbox" role="button" aria-controls="toc-toggle-list" data-event-name="vector.toc-toggle-list" tabindex="0" title="Table of Contents">
						Toggle the table of contents
					</label>
				    <h1 id="firstHeading" class="firstHeading mw-first-heading"><span class="mw-page-title-main">Rockchip RK3066</span></h1>
				</header>
				<nav class="vector-article-toolbar" aria-label="Tools" role="navigation">
					<div class="mw-article-toolbar-container">
						<div id="left-navigation">
							

<div id="p-associated-pages" class="vector-menu mw-portlet mw-portlet-associated-pages vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-nstab-main" class="selected mw-list-item"><a href="../en/Rockchip_RK3066.html" title="View the content page [c]" accesskey="c"><span>Page</span></a></li>
<li id="ca-talk" class="new mw-list-item"><a href="/index.php?title=Talk:Rockchip_RK3066&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-variants" class="vector-menu mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown">
	<input type="checkbox" id="p-variants-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-variants" class="vector-menu-checkbox" aria-label="Change language variant">
	<label id="p-variants-label" for="p-variants-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</div>

						</div>
						<div id="right-navigation" class="vector-collapsible ">
							

<div id="p-views" class="vector-menu mw-portlet mw-portlet-views vector-menu-tabs">
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-view" class="selected mw-list-item"><a href="../en/Rockchip_RK3066.html"><span>Read</span></a></li>
<li id="ca-viewsource" class="mw-list-item"><a href="/index.php?title=Rockchip_RK3066&amp;action=edit" title="This page is protected.
You can view its source [e]" accesskey="e"><span>View source</span></a></li>
<li id="ca-history" class="mw-list-item"><a href="/index.php?title=Rockchip_RK3066&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

							

<div id="p-cactions" class="vector-menu mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown vector-has-collapsible-items" title="More options">
	<input type="checkbox" id="p-cactions-checkbox" role="button" aria-haspopup="true" data-event-name="ui.dropdown-p-cactions" class="vector-menu-checkbox">
	<label id="p-cactions-label" for="p-cactions-checkbox" class="vector-menu-heading ">
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list">
<li id="ca-more-view" class="selected vector-more-collapsible-item mw-list-item"><a href="../en/Rockchip_RK3066.html"><span>Read</span></a></li>
<li id="ca-more-viewsource" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Rockchip_RK3066&amp;action=edit"><span>View source</span></a></li>
<li id="ca-more-history" class="vector-more-collapsible-item mw-list-item"><a href="/index.php?title=Rockchip_RK3066&amp;action=history"><span>View history</span></a></li>
</ul>
		
	</div>
</div>

						</div>
					</div>
				</nav>
				<div id="bodyContent" class="vector-body" data-mw-ve-target-container>
					<div class="mw-body-subheader">
					        <div class="mw-indicators">
        </div>

					    <div id="siteSub" class="noprint">From postmarketOS</div>
					</div>
					
					
					
					<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr">
<div class="mw-parser-output">
<table class="infobox" cellspacing="3" style="border-spacing: 3px; width:22em;">
<caption class="" style="">Rockchip RK3066</caption>
<tbody>
<tr class=""><td colspan="2" class="" style="text-align:center;">
<a href="../RK3066.jpg" class="image"><img alt="RK3066 in plastic package" src="../RK3066.jpg" decoding="async" width="200" height="200" srcset="../RK3066.jpg 1.5x ../RK3066.jpg 2x"></a><br><span style="">RK3066 in plastic package</span>
</td></tr>
<tr class="">
<th scope="row" style="text-align:left;">Manufacturer</th>
    <td class="" style="">
<a href="../en/Category:Rockchip.html" title="Category:Rockchip">Rockchip</a>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Name</th>
    <td class="" style="">
RK3066</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Architecture</th>
    <td class="" style="">
<a href="../en/Category:ARMv7.html" class="mw-redirect" title="Category:Armv7">armv7</a>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">CPU</th>
    <td class="" style="">
2x 1.6 GHz ARM Cortex-A9</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPU</th>
    <td class="" style="">
ARM Mali-400</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Year</th>
    <td class="" style="">
2012</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Process</th>
    <td class="" style="">
40nm</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Mainline</th>
    <td class="" style="">
yes</td>
</tr>
<tr><th colspan="2" class="" style="text-align:center;">Components</th></tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="SMP (bring up secondary CPU cores), CPU frequency scaling, CPUidle">CPU</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">UART</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="eMMC, SD cards, UFS, ...">Storage</abbr></th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">USB</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Display</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPU</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Pinctrl</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">I²C</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Serial Peripheral Interface">SPI</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Audio</th>
    <td class="" style="">
<div class="feature feature-partial">Partial</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Hardware-accelerated video de/encoding">Video</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Thermal</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">WiFi</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Bluetooth</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;"><abbr title="Calls, SMS, Internet">Modem</abbr></th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">GPS</th>
    <td class="" style="">
<div class="feature feature-yes">Works</div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Camera</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">NPU</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Suspend</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr class="">
<th scope="row" style="text-align:left;">Ethernet</th>
    <td class="" style="">
<div></div>
</td>
</tr>
<tr><td colspan="2" style="text-align:right"></td></tr>
</tbody>
</table>
<p><br>
</p>
<tocplace></tocplace>
<h2><span class="mw-headline" id="General_description">General description</span></h2>
<p><a rel="nofollow" class="external text" href="https://www.rock-chips.com/upload/DatasheetRK3066.pdf">RK3066</a> is a Rockchip SoC released in 2012, supported by mainline.
</p>
<p><a rel="nofollow" class="external text" href="https://hwswbits.blogspot.com/2013/04/rk3066-sdk-board-schematic.html">Typical schematics</a> for RK3066 devices are available online.
</p>
<h2><span class="mw-headline" id="Devices">Devices</span></h2>
<table class="cargoTable noMerge sortable">
<thead><tr>
<th class="field_Device">Device</th>
<th class="field_Codename">Codename</th>
<th class="field_Chipset">Chipset</th>
<th class="field_Mainline">Mainline</th>
<th class="field_Booting">Booting</th>
</tr></thead>
<tbody>
<tr>
<td class="field_Device"><a href="../en/DNS_AirTab_M83w_(dns-airtab-m83w).html" title="DNS AirTab M83w (dns-airtab-m83w)">DNS AirTab M83W</a></td>
<td class="field_Codename">dns-airtab-m83w</td>
<td class="field_Chipset">Rockchip RK3066</td>
<td class="field_Mainline"></td>
<td class="field_Booting">No</td>
</tr>
<tr>
<td class="field_Device"><a href="../en/Upvel_UM-514TV.html" title="Upvel UM-514TV">Upvel UM-514TV</a></td>
<td class="field_Codename">upvel-um514tv</td>
<td class="field_Chipset">Rockchip RK3066</td>
<td class="field_Mainline">N</td>
<td class="field_Booting">No</td>
</tr>
</tbody>
</table>
<h2><span class="mw-headline" id="Flashing_and_Booting">Flashing and Booting</span></h2>
<p>Like other Rockchip SoCs, the default recovery mode on the RK3066 uses RockUsb. You can use <a rel="nofollow" class="external text" href="https://github.com/linux-rockchip/rkflashtool">rkflashtool</a> to interact with the recovery mode. Hold the recovery key (usually the volume up button) while booting to enter recovery mode.
</p>
<p>The stock stage 2 boot loader 'flashboot' is pretty simple and uses parameters for configuration.
You can run <code>rkflashtool p</code> to read the parameters as text to stdout and <code>rkflashtool P</code> to apply the parameters in the same format from stdin. The text format looks like this:
</p>
<pre>FIRMWARE_VER:4.0.4
MACHINE_MODEL:rk30sdk
MACHINE_ID:007
MANUFACTURER:RK30SDK
MAGIC: 0x5041524B
ATAG: 0x60000800
MACHINE: 3066
CHECK_MASK: 0x80
KERNEL_IMG: 0x60408000
#RECOVER_KEY: 1,1,0,20,0
CMDLINE: console=ttyS2,115200n8 earlyprintk init=/init PMOS_NO_OUTPUT_REDIRECT initrd=0x62000000,0x00800000 mtdparts=rk29xxnand:0x00002000@0x00002000(misc),0x00006000@0x00004000(kernel),0x00008000@0x0000A000(boot),0x00008000@0x00012000(recovery),0x000C0000@0x0001A000(backup),0x00040000@0x000DA000(cache),0x00200000@0x0011A000(userdata),0x00002000@0x0031A000(kpanic),0x00200000@0x0031C000(system),-@0x0051C000(user)
</pre>
<p>The only really relevant part is the cmdline, and you can add arbitrary arguments to it (like in the example) to be passed to Linux, and it is the right place to add them (as it overrides various embedded cmdlines), but note that the boot loader has some "special magic" handling of the arguments <code>mtdparts</code> and <code>initrd</code>. In fact, this <code>mtdparts</code> <b>is the source of truth</b> for NAND flash partitioning <b>for flashboot itself</b>, so when you run <code>rkflashtool w boot</code>, the definition of <code>boot</code> comes from that line.
</p>
<p>The "Android" boot.img format supported by this loader is <b>NOT</b> compatible with the normal Android format!! It is similar, but slightly mangled (e.g. the SHA1 hash seems to occupy 1 byte less and such). Regular Android boot.img tools can unpack the format, but trying to boot images packed with those tools will fail the hash check. You MUST use an appropriately modified tool such as:
</p>
<ul>
<li>
<a rel="nofollow" class="external text" href="https://github.com/apeelme/cm_rk3066_mkbootimg">cm_rk3066_mkbootimg</a> (written in C) <i>confirmed to work great, also has the kernel/initrd addresses predefined</i>
</li>
<li>
<a rel="nofollow" class="external text" href="https://github.com/neo-technologies/rockchip-mkbootimg">rockchip-mkbootimg</a> (written in C)</li>
<li>
<a rel="nofollow" class="external text" href="https://github.com/rockchip-linux/kernel/blob/develop-4.4/scripts/mkbootimg">rockchip-linux scripts/mkbootimg</a> (written in Python)</li>
</ul>
<p>The loader seemingly has an ability to load a bare kernel instead of a boot.img, if checksummed with <code>rkcrc</code> from the <code>rkflashtool</code> repo, but <a href="../User:ValPackett.html" title="User:ValPackett">ValPackett</a> could not get that to work. boot.img images do not seem to require that CRC at all.
</p>
<p>The stock boot loader can be replaced with <a href="../en/U-Boot.html" title="U-Boot">U-Boot</a> SPL/TPL, the <a rel="nofollow" class="external text" href="https://github.com/u-boot/u-boot/blob/a7f0154c412859323396111dd0c09dbafbc153cb/doc/board/rockchip/rockchip.rst#3-package-the-rk3066-image-with-u-boot-tplspl-on-nand">doc/board/rockchip/rockchip.rst</a> manual has a special section about RK3066 NAND installation. (Where do the <a rel="nofollow" class="external text" href="https://github.com/u-boot/u-boot/commit/41ed3912c0fd5b2c5a0e20e524aae28dc062769e#diff-e0a36c38265a4d194391c993db7a4ea6c83457251a17e9b442be0a2d69c72e6bR17-R24">timing values</a> come from?) This will give you DRAM training with fully open source code.
</p>
<p>The Rockchip boot process is pretty rock-solid (ha), if you mess up the new boot loader in NAND you can always recover with the Mask ROM ("DFU") mode, if it doesn't appear automatically you need to short the clock of the boot media (as the U-Boot docs say, pin 8 and 9 of the NAND flash).
</p>
<p>You can also use U-Boot proper as the boot.img payload for flashboot, just to be able to put the kernel onto the SD card (XXX: SD card seems to drop off quickly).
</p>
<p>See also:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="https://gist.github.com/sarg/5028505">Obtaining RK3066 boot ROM</a></li>
<li><a rel="nofollow" class="external text" href="https://lore.kernel.org/all/606dfdf7-027e-c53a-ab25-19eba1675186@gmail.com/">u-boot@lists.denx.de: how bootrom on rk3066 executes stuff</a></li>
<li><a rel="nofollow" class="external text" href="https://opensource.rock-chips.com/wiki_Boot_option">Rockchip wiki: Boot option</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/neo-technologies/rockchip-bootloader">Rockchip bootloader collection</a></li>
</ul>
<h2><span class="mw-headline" id="Serial">Serial</span></h2>
<p>The 2nd (counting up from 0) UART is commonly used for the debug console and defaults to 115200 baud unlike more recent Rockchip SoCs.
</p>
<h2><span class="mw-headline" id="Power_and_Clock_Management">Power and Clock Management</span></h2>
<p>The RK3066 is commonly paired with the following PMICs:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/master/arch/arm/mach-rk30/board-rk30-sdk-tps65910.c">TPS65910</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/master/arch/arm/mach-rk30/board-rk30-sdk-wm8326.c">WM8326</a></li>
<li><a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/c93447601546838855533adaa88dc5ac7a7507c7/arch/arm/mach-rk30/board-rk30-sdk.c#L2154-L2162">AXP202</a></li>
<li>
<a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/master/arch/arm/mach-rk30/board-rk30-sdk-twl80032.c">TWL80032</a> (?)</li>
</ul>
<p>That PMIC is responsible for most voltages, except there's also a very important auxiliary voltage called <code>vdd_core</code> or <code>vdd_log</code> (for "logic") that's usually handled via <a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/c93447601546838855533adaa88dc5ac7a7507c7/arch/arm/mach-rk30/board-rk30-sdk.c#L1839-L1959">PWM from the SoC</a>. That voltage <b>scales together with the CPU one</b>, i.e. <a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/c93447601546838855533adaa88dc5ac7a7507c7/arch/arm/mach-rk30/board-rk30-sdk.c#L2620-L2632">the DVFS table in the vendor kernel</a> has three columns: <code>frequency</code>, <code>cpu_volt</code>, <code>logic_volt</code>. Various device trees in mainline just have <a rel="nofollow" class="external text" href="https://github.com/torvalds/linux/blob/0450d2083be6bdcd18c9535ac50c55266499b2df/arch/arm/boot/dts/rockchip/rk3066a-bqcurie2.dts#L25-L35">a high voltage hardcoded</a> for this regulator.
</p>
<p>Another interesting quirk is that some I2C bus clocks are internally derived from the CPU clock, so the vendor I2C driver uses <a rel="nofollow" class="external text" href="https://github.com/linuxium/rockchips-kk/blob/65dedb187255cb1ded1dde16ccdaec28c3bd6d22/drivers/i2c/busses/i2c-rk29.c#L650-L690">a cpufreq listener</a> to reapply the I2C clock if it has drifted upon CPU frequency change. That prevents a very "fun" failure mode where the I2C bus the PMIC is on stops working, so DVFS has applied a higher CPU frequency but the necessary voltage change failed to apply, and the CPU crashes.
</p>
<p><a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/commit/c93447601546838855533adaa88dc5ac7a7507c7">Overclocks up to 1.8 GHz</a> have been reached on vendor Android years ago.
</p>
<h2><span class="mw-headline" id="Memory">Memory</span></h2>
<p>The stock boot loader trains DRAM to 300 MHz (U-Boot TPL would use the parameters you give it in the device tree).
</p>
<p>The Android kernel has <a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/c93447601546838855533adaa88dc5ac7a7507c7/arch/arm/mach-rk30/ddr.uu">blobs</a> (<a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/c93447601546838855533adaa88dc5ac7a7507c7/arch/arm/mach-rk30/include/mach/ddr.h#L150">header</a>) that get copied to <a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/master/arch/arm/plat-rk/sram.c#L72">SRAM</a> and executed from there (!). On boot all that is used to retrain to a bit of a higher speed as specified in the kernel config (e.g. on DDR3 devices 360 MHz seems common).
</p>
<p>It SHOULD NOT be mandatory to retrain memory; if you are seeing instability (freezes, memtester failures) it's far more likely to be that logic voltage, go raise it a bit more.
</p>
<h2><span class="mw-headline" id="Display">Display</span></h2>
<p>The mainline Rockchip VOP driver supports this SoC, little patches are required for internal display to work though:
</p>
<ul>
<li><a rel="nofollow" class="external text" href="https://patchwork.kernel.org/project/linux-rockchip/patch/20240519074019.10424-1-val@packett.cool/">drm/rockchip: vop: clear DMA stop bit on flush on RK3066</a></li>
<li><a rel="nofollow" class="external text" href="https://patchwork.kernel.org/project/linux-rockchip/patch/20240519074019.10424-2-val@packett.cool/">drm/rockchip: vop: enable VOP_FEATURE_INTERNAL_RGB on RK3066</a></li>
</ul>
<p>The SoC can output HDMI and parallel RGB; some devices use a basic LVDS encoder for onboard displays, but others (particularly tablets with a mini HDMI port) use the RK610 chip, which allows for basic LVDS encoding (bypass mode) when HDMI is not connected, as well as scaling (encode HDMI and downscale to mirror to LVDS as well). As of May 2024, <a href="../User:ValPackett.html" title="User:ValPackett">ValPackett</a> is starting work on a real RK610 driver (at least LVDS, hopefully also HDMI, probably not audio), however the most basic userspace "driver" for enabling bypass mode is just:
</p>
<pre>sudo i2cset -y 1 0x40 0x09 0x54
sudo i2cset -y 1 0x40 0x0a 0x00
sudo i2cset -y 1 0x40 0x0c 0x10
sudo i2cset -y 1 0x40 0x08 0x05
</pre>
<p>Along with pretending to just have a simple <code>"lvds-encoder"</code>. The reset pin is <code>&amp;gpio0 RK_PC6</code>; the voltage regulator you might see listed as "hdmi" and the I2S peripherals must be turned on.
</p>
<p>Panel pins are likely to be, as defined in the <a rel="nofollow" class="external text" href="https://github.com/crewrktablets/rk30_kernel/blob/c93447601546838855533adaa88dc5ac7a7507c7/arch/arm/mach-rk30/board-rk30-sdk.c#L1296-L1316">vendor kernel</a>:
</p>
<ul>
<li>for RK610 devices: <code>&amp;gpio1 RK_PC3</code> chip select, <code>&amp;gpio6 RK_PB0</code> enable, <code>&amp;gpio2 RK_PC6</code> stabilize
<ul><li>without the stabilize pin, the display takes a long time to come up and comes up with glitches that take a few seconds to clear</li></ul>
</li>
<li>for non-RK610 devices: <code>&amp;gpio4 RK_PC7</code> chip select, <code>&amp;gpio6 RK_PB4</code> enable</li>
</ul>
<h2><span class="mw-headline" id="GPU">GPU</span></h2>
<p>Lima "just works", but riiiight now you do need to apply (nothing to do with Rockchip in particular, but this fixes compositor lockup upon launching any GL app):
</p>
<ul><li>
<a rel="nofollow" class="external text" href="https://patchwork.kernel.org/project/linux-media/patch/20240523113236.432585-3-adrian.larumbe@collabora.com/">[v4,2/3</a> drm/lima: Fix dma_resv deadlock at drm object pin time]</li></ul>
<h2><span class="mw-headline" id="WiFi">WiFi</span></h2>
<p>The RK3066 is commonly paired with Broadcom SDIO Wi-Fi chips, often Rockchip-rebranded, e.g.:
</p>
<ul><li>
<a rel="nofollow" class="external text" href="https://techinfodepot.shoutwiki.com/wiki/Rockchip_RK901">RK901</a>: commonly listed as BCM4329, but at runtime the driver recognizes it as a BCM43362 and wants firmware/nvram for <code>brcm/brcmfmac43362-sdio</code>
<ul>
<li>nvram used by Rockchip can be found e.g. <a rel="nofollow" class="external text" href="https://github.com/linuxium/rockchips-kk/blob/65dedb187255cb1ded1dde16ccdaec28c3bd6d22/drivers/net/wireless/rkwifi/firmware/nvram_RK901.txt">here</a> though <a rel="nofollow" class="external text" href="https://github.com/armbian/firmware/blob/master/brcm/brcmfmac43362-sdio.txt">other</a> ones seem to work fine too</li>
<li>it *does not* have the Bluetooth part</li>
</ul>
</li></ul>
</div>
</div>
					<div id="catlinks" class="catlinks" data-mw="interface"><div id="mw-normal-catlinks" class="mw-normal-catlinks">
<a href="../Special:Categories.html" title="Special:Categories">Categories</a>: <ul>
<li><a href="../en/Category:Socs.html" title="Category:Socs">Socs</a></li>
<li><a href="../en/Category:Rockchip.html" title="Category:Rockchip">Rockchip</a></li>
<li><a href="../en/Category:ARMv7.html" class="mw-redirect" title="Category:Armv7">Armv7</a></li>
</ul>
</div></div>
				</div>
			</main>
			
		</div>
		<div class="mw-footer-container">
			
<footer id="footer" class="mw-footer" role="contentinfo" style="margin: 0">
	<ul id="footer-info">
	<li data-nosnippet="">Retrieved from "<a dir="ltr" href="https://wiki.postmarketos.org/index.php?title=Rockchip_RK3066&amp;oldid=59478">https://wiki.postmarketos.org/index.php?title=Rockchip_RK3066&amp;oldid=59478</a>"</li>
<li id="footer-info-lastmod"> This page was last edited on 28 May 2024, at 04:43.</li>
	<li id="footer-info-copyright">Content is available under <a class="external" rel="nofollow" href="https://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike</a> unless otherwise noted.</li>
<br>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="../en/PostmarketOS:Privacy_policy.html">Privacy policy</a></li>
	<li id="footer-places-about"><a href="../en/About_postmarketOS.html">About postmarketOS</a></li>
	<li id="footer-places-disclaimer"><a href="../en/PostmarketOS:General_disclaimer.html">Disclaimers</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://creativecommons.org/licenses/by-sa/4.0/"><img src="../cc-by-sa.png" alt="Creative Commons Attribution-ShareAlike" width="88" height="31" loading="lazy"></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="../poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="" width="88" height="31" loading="lazy"></a></li>
</ul>

</footer>

		</div>
	</div> 
</div> 

</body>
</html>
